{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-14T13:15:04.579143Z", "invocation_id": "d9fee8f5-811f-475a-9e45-09d897fd4f10", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:15:02.988736Z", "completed_at": "2025-03-14T13:15:03.016072Z"}, {"name": "execute", "started_at": "2025-03-14T13:15:03.017266Z", "completed_at": "2025-03-14T13:15:03.932484Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9437482357025146, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00bb-0000-e6d0-0008-ed5a00024c26"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.hotel_booking.newcust_churn", "compiled": true, "compiled_code": "\nWITH churn_new_customers AS (\n    SELECT\n        payment_month,\n        customer_id,\n        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,\n        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date\n    FROM HOTEL_MGMT.stage.stg_transactions  \n    WHERE revenue_type=1\n),\naggregated_data AS (\n    SELECT\n        payment_month,\n        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,\n        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_month THEN customer_id END) AS churned_customers\n    FROM churn_new_customers\n    GROUP BY payment_month\n    ORDER BY payment_month\n),\ntime_periods AS (\n    SELECT\n        payment_month,\n        SUM(new_customers) OVER (ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,\n        SUM(churned_customers) OVER (ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm,\n        SUM(new_customers) OVER (ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,\n        SUM(churned_customers) OVER (ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m,\n        SUM(new_customers) OVER (ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,\n        SUM(churned_customers) OVER (ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm\n    FROM aggregated_data\n)\nSELECT * FROM time_periods", "relation_name": "HOTEL_MGMT.stage_mart.newcust_churn", "batch_results": null}], "elapsed_time": 2.9713432788848877, "args": {"skip_nodes_if_on_run_start_fails": false, "invocation_command": "dbt build -m newcust_churn", "indirect_selection": "eager", "project_dir": "C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking", "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "which": "build", "log_file_max_bytes": 10485760, "resource_types": [], "strict_mode": false, "profiles_dir": "C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking", "require_nested_cumulative_type_params": false, "partial_parse_file_diff": true, "log_format": "default", "static_parser": true, "exclude_resource_types": [], "state_modified_compare_more_unrendered_values": false, "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "print": true, "empty": false, "require_resource_names_without_spaces": false, "log_level_file": "debug", "state_modified_compare_vars": false, "cache_selected_only": false, "use_colors": true, "version_check": true, "write_json": true, "use_colors_file": true, "vars": {}, "select": ["newcust_churn"], "source_freshness_run_project_hooks": false, "quiet": false, "partial_parse": true, "printer_width": 80, "require_batched_execution_for_custom_microbatch_strategy": false, "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "log_path": "C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs", "macro_debugging": false, "export_saved_queries": false, "favor_state": false, "exclude": [], "log_format_file": "debug", "introspect": true, "show": false, "include_saved_query": false, "log_level": "info", "show_resource_report": false}}