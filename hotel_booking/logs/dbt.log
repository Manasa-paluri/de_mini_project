[0m10:22:25.932012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F2E11640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F2A63F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F2A61430>]}


============================== 10:22:25.947721 | 687d9b79-f005-4f2e-bd97-1306f4cbab1f ==============================
[0m10:22:25.947721 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:22:25.947721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:22:25.976526 [info ] [MainThread]: dbt version: 1.9.3
[0m10:22:25.976526 [info ] [MainThread]: python version: 3.12.5
[0m10:22:25.976526 [info ] [MainThread]: python path: c:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\.venv\Scripts\python.exe
[0m10:22:25.976526 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:22:26.403743 [info ] [MainThread]: Using profiles dir at C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking
[0m10:22:26.403743 [info ] [MainThread]: Using profiles.yml file at C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\profiles.yml
[0m10:22:26.403743 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\dbt_project.yml
[0m10:22:26.403743 [info ] [MainThread]: adapter type: snowflake
[0m10:22:26.403743 [info ] [MainThread]: adapter version: 1.9.2
[0m10:22:26.542990 [info ] [MainThread]: Configuration:
[0m10:22:26.543988 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:22:26.543988 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:22:26.544985 [info ] [MainThread]: Required dependencies:
[0m10:22:26.544985 [debug] [MainThread]: Executing "git --help"
[0m10:22:26.614089 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:22:26.614089 [debug] [MainThread]: STDERR: "b''"
[0m10:22:26.614089 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:22:26.614089 [info ] [MainThread]: Connection:
[0m10:22:26.614089 [info ] [MainThread]:   account: AMITJNS-CT72498.snowflakecomputing.com
[0m10:22:26.614089 [info ] [MainThread]:   user: MANASA26
[0m10:22:26.614089 [info ] [MainThread]:   database: HOTEL_MGMT
[0m10:22:26.614089 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:22:26.614089 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:22:26.614089 [info ] [MainThread]:   schema: stage
[0m10:22:26.614089 [info ] [MainThread]:   authenticator: None
[0m10:22:26.625412 [info ] [MainThread]:   oauth_client_id: None
[0m10:22:26.626421 [info ] [MainThread]:   query_tag: None
[0m10:22:26.627423 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:22:26.628303 [info ] [MainThread]:   host: None
[0m10:22:26.628303 [info ] [MainThread]:   port: None
[0m10:22:26.629377 [info ] [MainThread]:   proxy_host: None
[0m10:22:26.630002 [info ] [MainThread]:   proxy_port: None
[0m10:22:26.630002 [info ] [MainThread]:   protocol: None
[0m10:22:26.630002 [info ] [MainThread]:   connect_retries: 1
[0m10:22:26.630002 [info ] [MainThread]:   connect_timeout: None
[0m10:22:26.630002 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:22:26.630002 [info ] [MainThread]:   retry_all: False
[0m10:22:26.630002 [info ] [MainThread]:   insecure_mode: False
[0m10:22:26.630002 [info ] [MainThread]:   reuse_connections: True
[0m10:22:26.635932 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:22:27.222092 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:22:31.036556 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:22:31.036556 [debug] [MainThread]: On debug: select 1 as id
[0m10:22:31.036556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:36.551790 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m10:22:36.567726 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m10:22:36.567726 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:22:36.569185 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:22:36.570194 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
  Verify that the hostnames and port numbers in SYSTEM$ALLOWLIST are added to your firewall's allowed list.
  To further troubleshoot your connection you may reference the following article: https://docs.snowflake.com/en/user-guide/client-connectivity-troubleshooting/overview.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:22:36.572223 [debug] [MainThread]: Command `dbt debug` failed at 10:22:36.571783 after 10.85 seconds
[0m10:22:36.572223 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:22:36.572223 [debug] [MainThread]: On debug: No close available on handle
[0m10:22:36.573319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F2F2C530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F3E83680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F1FB3D10>]}
[0m10:22:36.573319 [debug] [MainThread]: Flushing usage events
[0m10:22:37.768120 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:49.951285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCF0B80E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCF0C4DAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCEF307620>]}


============================== 10:22:49.959897 | db0e6c79-02c5-4886-8c9b-46a9470b7f82 ==============================
[0m10:22:49.959897 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:22:49.959897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:49.982104 [info ] [MainThread]: dbt version: 1.9.3
[0m10:22:49.982104 [info ] [MainThread]: python version: 3.12.5
[0m10:22:49.982104 [info ] [MainThread]: python path: c:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\.venv\Scripts\python.exe
[0m10:22:49.982104 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:22:50.446098 [info ] [MainThread]: Using profiles dir at C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking
[0m10:22:50.446098 [info ] [MainThread]: Using profiles.yml file at C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\profiles.yml
[0m10:22:50.446098 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\dbt_project.yml
[0m10:22:50.446098 [info ] [MainThread]: adapter type: snowflake
[0m10:22:50.446098 [info ] [MainThread]: adapter version: 1.9.2
[0m10:22:50.582099 [info ] [MainThread]: Configuration:
[0m10:22:50.582099 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:22:50.582099 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:22:50.582099 [info ] [MainThread]: Required dependencies:
[0m10:22:50.582099 [debug] [MainThread]: Executing "git --help"
[0m10:22:50.650116 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:22:50.650116 [debug] [MainThread]: STDERR: "b''"
[0m10:22:50.650116 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:22:50.650116 [info ] [MainThread]: Connection:
[0m10:22:50.650116 [info ] [MainThread]:   account: AMITJNS-CT72498
[0m10:22:50.650116 [info ] [MainThread]:   user: MANASA26
[0m10:22:50.650116 [info ] [MainThread]:   database: HOTEL_MGMT
[0m10:22:50.650116 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:22:50.650116 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:22:50.650116 [info ] [MainThread]:   schema: stage
[0m10:22:50.650116 [info ] [MainThread]:   authenticator: None
[0m10:22:50.650116 [info ] [MainThread]:   oauth_client_id: None
[0m10:22:50.660809 [info ] [MainThread]:   query_tag: None
[0m10:22:50.661808 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:22:50.661808 [info ] [MainThread]:   host: None
[0m10:22:50.663162 [info ] [MainThread]:   port: None
[0m10:22:50.663162 [info ] [MainThread]:   proxy_host: None
[0m10:22:50.664199 [info ] [MainThread]:   proxy_port: None
[0m10:22:50.664881 [info ] [MainThread]:   protocol: None
[0m10:22:50.665540 [info ] [MainThread]:   connect_retries: 1
[0m10:22:50.666549 [info ] [MainThread]:   connect_timeout: None
[0m10:22:50.667548 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:22:50.670504 [info ] [MainThread]:   retry_all: False
[0m10:22:50.670504 [info ] [MainThread]:   insecure_mode: False
[0m10:22:50.672733 [info ] [MainThread]:   reuse_connections: True
[0m10:22:50.673751 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:22:51.131695 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:22:51.234798 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:22:51.234798 [debug] [MainThread]: On debug: select 1 as id
[0m10:22:51.234798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:52.299871 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.061 seconds
[0m10:22:52.299871 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:22:52.299871 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:22:52.299871 [debug] [MainThread]: Command `dbt debug` succeeded at 10:22:52.299871 after 2.56 seconds
[0m10:22:52.299871 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:22:52.299871 [debug] [MainThread]: On debug: Close
[0m10:22:52.405237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCF15267E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCF10622A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCF16E4740>]}
[0m10:22:52.405237 [debug] [MainThread]: Flushing usage events
[0m10:22:53.429622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:23:13.686938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BA558CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B8BDCAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B9D00D70>]}


============================== 10:23:13.686938 | c1f6a5db-3c7d-483d-b596-1e4b6701880f ==============================
[0m10:23:13.686938 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:23:13.686938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m stg_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:23:14.331793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1f6a5db-3c7d-483d-b596-1e4b6701880f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BD696690>]}
[0m10:23:14.420751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1f6a5db-3c7d-483d-b596-1e4b6701880f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BC9D8440>]}
[0m10:23:14.422761 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:23:14.929024 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:23:14.929024 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:23:14.929024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1f6a5db-3c7d-483d-b596-1e4b6701880f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BD77A9C0>]}
[0m10:23:18.194690 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hotel_booking.stg_transactions' (models\staging\stg_transactions.sql) depends on a source named '.' which was not found
[0m10:23:18.194690 [debug] [MainThread]: Command `dbt build` failed at 10:23:18.194690 after 4.72 seconds
[0m10:23:18.194690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B9B84380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BEA30C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BD77ADE0>]}
[0m10:23:18.194690 [debug] [MainThread]: Flushing usage events
[0m10:23:19.178335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:03.334113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255305A4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002552E6DA840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025530B695B0>]}


============================== 10:24:03.334113 | b84a24b3-3148-4cb9-8886-8b9a60b80665 ==============================
[0m10:24:03.334113 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:24:03.334113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m stg_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:24:03.900666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b84a24b3-3148-4cb9-8886-8b9a60b80665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025531475640>]}
[0m10:24:03.979941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b84a24b3-3148-4cb9-8886-8b9a60b80665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255321521E0>]}
[0m10:24:03.979941 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:24:04.435472 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:24:04.446195 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:24:04.446195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b84a24b3-3148-4cb9-8886-8b9a60b80665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255332F49E0>]}
[0m10:24:05.911034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b84a24b3-3148-4cb9-8886-8b9a60b80665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002553353F470>]}
[0m10:24:05.992783 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:24:06.020499 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:24:06.115253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b84a24b3-3148-4cb9-8886-8b9a60b80665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255337F5A90>]}
[0m10:24:06.115253 [info ] [MainThread]: Found 1 model, 1 source, 474 macros
[0m10:24:06.115253 [info ] [MainThread]: 
[0m10:24:06.115253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:06.115253 [info ] [MainThread]: 
[0m10:24:06.115253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:24:06.131956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m10:24:06.255550 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m10:24:06.255550 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m10:24:06.255550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:07.009347 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.753 seconds
[0m10:24:07.009347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m10:24:07.009347 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m10:24:07.009347 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m10:24:07.009347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:08.056782 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.042 seconds
[0m10:24:08.056782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b84a24b3-3148-4cb9-8886-8b9a60b80665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255321E27E0>]}
[0m10:24:08.072801 [debug] [Thread-1 (]: Began running node model.hotel_booking.stg_transactions
[0m10:24:08.072801 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:24:08.072801 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.stg_transactions'
[0m10:24:08.072801 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.stg_transactions
[0m10:24:08.090809 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.stg_transactions"
[0m10:24:08.094658 [debug] [Thread-1 (]: Began executing node model.hotel_booking.stg_transactions
[0m10:24:08.130435 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.stg_transactions"
[0m10:24:08.134436 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.stg_transactions"
[0m10:24:08.135436 [debug] [Thread-1 (]: On model.hotel_booking.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.stg_transactions"} */
create or replace transient table HOTEL_MGMT.stage.stg_transactions
         as
        (WITH cte AS(

SELECT *
 FROM hotel_mgmt.raw.transactions
WHERE CUSTOMER_ID IS NOT NULL,
	PRODUCT_ID IS NOT NULL,
	PAYMENT_MONTH IS NOT NULL,
	REVENUE_TYPE IS NOT NULL,
	REVENUE IS NOT NULL,
	QUANTITY IS NOT NULL,
	DIMENSION_1 IS NOT NULL,
	DIMENSION_2 IS NOT NULL,
	DIMENSION_3 IS NOT NULL,
	DIMENSION_4 IS NOT NULL,
	DIMENSION_5 IS NOT NULL,
	DIMENSION_6 IS NOT NULL,
	DIMENSION_7 IS NOT NULL,
	DIMENSION_8 IS NOT NULL,
	DIMENSION_9 IS NOT NULL,
	DIMENSION_10 IS NOT NULL ,
	COMPANIES  IS NOT NULL;
[0m10:24:08.135436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:24:08.667413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafec6-0000-e658-0008-ed5a00016402
[0m10:24:08.667413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 29 unexpected ','.
syntax error line 8 at position 12 unexpected 'IS'.
syntax error line 9 at position 15 unexpected 'IS'.
syntax error line 10 at position 14 unexpected 'IS'.
syntax error line 11 at position 9 unexpected 'IS'.
syntax error line 12 at position 10 unexpected 'IS'.
syntax error line 13 at position 13 unexpected 'IS'.
syntax error line 14 at position 13 unexpected 'IS'.
syntax error line 15 at position 13 unexpected 'IS'.
syntax error line 16 at position 13 unexpected 'IS'.
syntax error line 17 at position 13 unexpected 'IS'.
syntax error line 18 at position 13 unexpected 'IS'.
syntax error line 19 at position 13 unexpected 'IS'.
syntax error line 20 at position 13 unexpected 'IS'.
syntax error line 21 at position 13 unexpected 'IS'.
syntax error line 22 at position 14 unexpected 'IS'.
syntax error line 23 at position 12 unexpected 'IS'.
[0m10:24:08.689429 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 29 unexpected ','.
  syntax error line 8 at position 12 unexpected 'IS'.
  syntax error line 9 at position 15 unexpected 'IS'.
  syntax error line 10 at position 14 unexpected 'IS'.
  syntax error line 11 at position 9 unexpected 'IS'.
  syntax error line 12 at position 10 unexpected 'IS'.
  syntax error line 13 at position 13 unexpected 'IS'.
  syntax error line 14 at position 13 unexpected 'IS'.
  syntax error line 15 at position 13 unexpected 'IS'.
  syntax error line 16 at position 13 unexpected 'IS'.
  syntax error line 17 at position 13 unexpected 'IS'.
  syntax error line 18 at position 13 unexpected 'IS'.
  syntax error line 19 at position 13 unexpected 'IS'.
  syntax error line 20 at position 13 unexpected 'IS'.
  syntax error line 21 at position 13 unexpected 'IS'.
  syntax error line 22 at position 14 unexpected 'IS'.
  syntax error line 23 at position 12 unexpected 'IS'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql
[0m10:24:08.691793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84a24b3-3148-4cb9-8886-8b9a60b80665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025530934200>]}
[0m10:24:08.693632 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.stg_transactions ................... [[31mERROR[0m in 0.62s]
[0m10:24:08.694323 [debug] [Thread-1 (]: Finished running node model.hotel_booking.stg_transactions
[0m10:24:08.695474 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 29 unexpected ','.
  syntax error line 8 at position 12 unexpected 'IS'.
  syntax error line 9 at position 15 unexpected 'IS'.
  syntax error line 10 at position 14 unexpected 'IS'.
  syntax error line 11 at position 9 unexpected 'IS'.
  syntax error line 12 at position 10 unexpected 'IS'.
  syntax error line 13 at position 13 unexpected 'IS'.
  syntax error line 14 at position 13 unexpected 'IS'.
  syntax error line 15 at position 13 unexpected 'IS'.
  syntax error line 16 at position 13 unexpected 'IS'.
  syntax error line 17 at position 13 unexpected 'IS'.
  syntax error line 18 at position 13 unexpected 'IS'.
  syntax error line 19 at position 13 unexpected 'IS'.
  syntax error line 20 at position 13 unexpected 'IS'.
  syntax error line 21 at position 13 unexpected 'IS'.
  syntax error line 22 at position 14 unexpected 'IS'.
  syntax error line 23 at position 12 unexpected 'IS'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql.
[0m10:24:08.697486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:08.697486 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m10:24:08.698766 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m10:24:08.790444 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m10:24:08.790444 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m10:24:08.879957 [debug] [MainThread]: Connection 'model.hotel_booking.stg_transactions' was left open.
[0m10:24:08.879957 [debug] [MainThread]: On model.hotel_booking.stg_transactions: Close
[0m10:24:08.952324 [info ] [MainThread]: 
[0m10:24:08.952324 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m10:24:08.968275 [debug] [MainThread]: Command end result
[0m10:24:08.997806 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:24:09.000805 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:24:09.008974 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m10:24:09.008974 [info ] [MainThread]: 
[0m10:24:09.010596 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:24:09.011605 [info ] [MainThread]: 
[0m10:24:09.012605 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 29 unexpected ','.
  syntax error line 8 at position 12 unexpected 'IS'.
  syntax error line 9 at position 15 unexpected 'IS'.
  syntax error line 10 at position 14 unexpected 'IS'.
  syntax error line 11 at position 9 unexpected 'IS'.
  syntax error line 12 at position 10 unexpected 'IS'.
  syntax error line 13 at position 13 unexpected 'IS'.
  syntax error line 14 at position 13 unexpected 'IS'.
  syntax error line 15 at position 13 unexpected 'IS'.
  syntax error line 16 at position 13 unexpected 'IS'.
  syntax error line 17 at position 13 unexpected 'IS'.
  syntax error line 18 at position 13 unexpected 'IS'.
  syntax error line 19 at position 13 unexpected 'IS'.
  syntax error line 20 at position 13 unexpected 'IS'.
  syntax error line 21 at position 13 unexpected 'IS'.
  syntax error line 22 at position 14 unexpected 'IS'.
  syntax error line 23 at position 12 unexpected 'IS'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql
[0m10:24:09.013604 [info ] [MainThread]: 
[0m10:24:09.013604 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:24:09.015605 [debug] [MainThread]: Command `dbt build` failed at 10:24:09.015605 after 5.90 seconds
[0m10:24:09.016688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025530844E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255308AEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255308AD9A0>]}
[0m10:24:09.017696 [debug] [MainThread]: Flushing usage events
[0m10:24:09.987890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:29.977817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771AA66B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771B5B72F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771B5B7470>]}


============================== 10:27:29.983186 | c4b11cf4-c068-416e-b4bc-0d0b11bb3f79 ==============================
[0m10:27:29.983186 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:27:29.984186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m stg_transactions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:30.638698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b11cf4-c068-416e-b4bc-0d0b11bb3f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771E4272C0>]}
[0m10:27:30.707440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4b11cf4-c068-416e-b4bc-0d0b11bb3f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771E519DF0>]}
[0m10:27:30.709119 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:27:31.280843 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:27:32.864439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:27:32.865438 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\staging\stg_transactions.sql
[0m10:27:33.169354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b11cf4-c068-416e-b4bc-0d0b11bb3f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771F60D7F0>]}
[0m10:27:33.244778 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:27:33.262500 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:27:33.346820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b11cf4-c068-416e-b4bc-0d0b11bb3f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771FBDEF00>]}
[0m10:27:33.346820 [info ] [MainThread]: Found 1 model, 1 source, 474 macros
[0m10:27:33.348820 [info ] [MainThread]: 
[0m10:27:33.350367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:33.351375 [info ] [MainThread]: 
[0m10:27:33.351375 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:27:33.353410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m10:27:36.781104 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m10:27:36.782104 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m10:27:36.782104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:37.594194 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.811 seconds
[0m10:27:37.597197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m10:27:37.653225 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m10:27:37.654224 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m10:27:37.654224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:38.088739 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.434 seconds
[0m10:27:38.090701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b11cf4-c068-416e-b4bc-0d0b11bb3f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771FAB0680>]}
[0m10:27:38.095841 [debug] [Thread-1 (]: Began running node model.hotel_booking.stg_transactions
[0m10:27:38.097037 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:27:38.098004 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.stg_transactions'
[0m10:27:38.099007 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.stg_transactions
[0m10:27:38.108319 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.stg_transactions"
[0m10:27:38.110539 [debug] [Thread-1 (]: Began executing node model.hotel_booking.stg_transactions
[0m10:27:38.153536 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.stg_transactions"
[0m10:27:38.155502 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.stg_transactions"
[0m10:27:38.156537 [debug] [Thread-1 (]: On model.hotel_booking.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.stg_transactions"} */
create or replace transient table HOTEL_MGMT.stage.stg_transactions
         as
        (WITH cte AS(

SELECT *
 FROM hotel_mgmt.raw.transactions
WHERE CUSTOMER_ID IS NOT NULL,
	PRODUCT_ID IS NOT NULL,
	PAYMENT_MONTH IS NOT NULL,
	REVENUE_TYPE IS NOT NULL,
	REVENUE IS NOT NULL,
	QUANTITY IS NOT NULL,
	DIMENSION_1 IS NOT NULL,
	DIMENSION_2 IS NOT NULL,
	DIMENSION_3 IS NOT NULL,
	DIMENSION_4 IS NOT NULL,
	DIMENSION_5 IS NOT NULL,
	DIMENSION_6 IS NOT NULL,
	DIMENSION_7 IS NOT NULL,
	DIMENSION_8 IS NOT NULL,
	DIMENSION_9 IS NOT NULL,
	DIMENSION_10 IS NOT NULL ,
	COMPANIES  IS NOT NULL
)
SELECT * FROM cte
        );
[0m10:27:38.157544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:27:38.717381 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafec9-0000-e6d0-0008-ed5a00024386
[0m10:27:38.717381 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 29 unexpected ','.
syntax error line 8 at position 12 unexpected 'IS'.
syntax error line 9 at position 15 unexpected 'IS'.
syntax error line 10 at position 14 unexpected 'IS'.
syntax error line 11 at position 9 unexpected 'IS'.
syntax error line 12 at position 10 unexpected 'IS'.
syntax error line 13 at position 13 unexpected 'IS'.
syntax error line 14 at position 13 unexpected 'IS'.
syntax error line 15 at position 13 unexpected 'IS'.
syntax error line 16 at position 13 unexpected 'IS'.
syntax error line 17 at position 13 unexpected 'IS'.
syntax error line 18 at position 13 unexpected 'IS'.
syntax error line 19 at position 13 unexpected 'IS'.
syntax error line 20 at position 13 unexpected 'IS'.
syntax error line 21 at position 13 unexpected 'IS'.
syntax error line 22 at position 14 unexpected 'IS'.
syntax error line 23 at position 12 unexpected 'IS'.
syntax error line 25 at position 0 unexpected 'SELECT'.
[0m10:27:38.734577 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 29 unexpected ','.
  syntax error line 8 at position 12 unexpected 'IS'.
  syntax error line 9 at position 15 unexpected 'IS'.
  syntax error line 10 at position 14 unexpected 'IS'.
  syntax error line 11 at position 9 unexpected 'IS'.
  syntax error line 12 at position 10 unexpected 'IS'.
  syntax error line 13 at position 13 unexpected 'IS'.
  syntax error line 14 at position 13 unexpected 'IS'.
  syntax error line 15 at position 13 unexpected 'IS'.
  syntax error line 16 at position 13 unexpected 'IS'.
  syntax error line 17 at position 13 unexpected 'IS'.
  syntax error line 18 at position 13 unexpected 'IS'.
  syntax error line 19 at position 13 unexpected 'IS'.
  syntax error line 20 at position 13 unexpected 'IS'.
  syntax error line 21 at position 13 unexpected 'IS'.
  syntax error line 22 at position 14 unexpected 'IS'.
  syntax error line 23 at position 12 unexpected 'IS'.
  syntax error line 25 at position 0 unexpected 'SELECT'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql
[0m10:27:38.736608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b11cf4-c068-416e-b4bc-0d0b11bb3f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771CCD48C0>]}
[0m10:27:38.737576 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.stg_transactions ................... [[31mERROR[0m in 0.64s]
[0m10:27:38.738721 [debug] [Thread-1 (]: Finished running node model.hotel_booking.stg_transactions
[0m10:27:38.739745 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 29 unexpected ','.
  syntax error line 8 at position 12 unexpected 'IS'.
  syntax error line 9 at position 15 unexpected 'IS'.
  syntax error line 10 at position 14 unexpected 'IS'.
  syntax error line 11 at position 9 unexpected 'IS'.
  syntax error line 12 at position 10 unexpected 'IS'.
  syntax error line 13 at position 13 unexpected 'IS'.
  syntax error line 14 at position 13 unexpected 'IS'.
  syntax error line 15 at position 13 unexpected 'IS'.
  syntax error line 16 at position 13 unexpected 'IS'.
  syntax error line 17 at position 13 unexpected 'IS'.
  syntax error line 18 at position 13 unexpected 'IS'.
  syntax error line 19 at position 13 unexpected 'IS'.
  syntax error line 20 at position 13 unexpected 'IS'.
  syntax error line 21 at position 13 unexpected 'IS'.
  syntax error line 22 at position 14 unexpected 'IS'.
  syntax error line 23 at position 12 unexpected 'IS'.
  syntax error line 25 at position 0 unexpected 'SELECT'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql.
[0m10:27:38.741724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:38.741724 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m10:27:38.742923 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m10:27:38.869898 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m10:27:38.869898 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m10:27:38.960167 [debug] [MainThread]: Connection 'model.hotel_booking.stg_transactions' was left open.
[0m10:27:38.961434 [debug] [MainThread]: On model.hotel_booking.stg_transactions: Close
[0m10:27:39.055547 [info ] [MainThread]: 
[0m10:27:39.057773 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m10:27:39.059807 [debug] [MainThread]: Command end result
[0m10:27:39.086580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:27:39.090586 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:27:39.098075 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m10:27:39.099042 [info ] [MainThread]: 
[0m10:27:39.100219 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:27:39.101220 [info ] [MainThread]: 
[0m10:27:39.101220 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 29 unexpected ','.
  syntax error line 8 at position 12 unexpected 'IS'.
  syntax error line 9 at position 15 unexpected 'IS'.
  syntax error line 10 at position 14 unexpected 'IS'.
  syntax error line 11 at position 9 unexpected 'IS'.
  syntax error line 12 at position 10 unexpected 'IS'.
  syntax error line 13 at position 13 unexpected 'IS'.
  syntax error line 14 at position 13 unexpected 'IS'.
  syntax error line 15 at position 13 unexpected 'IS'.
  syntax error line 16 at position 13 unexpected 'IS'.
  syntax error line 17 at position 13 unexpected 'IS'.
  syntax error line 18 at position 13 unexpected 'IS'.
  syntax error line 19 at position 13 unexpected 'IS'.
  syntax error line 20 at position 13 unexpected 'IS'.
  syntax error line 21 at position 13 unexpected 'IS'.
  syntax error line 22 at position 14 unexpected 'IS'.
  syntax error line 23 at position 12 unexpected 'IS'.
  syntax error line 25 at position 0 unexpected 'SELECT'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql
[0m10:27:39.104240 [info ] [MainThread]: 
[0m10:27:39.106220 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:27:39.107238 [debug] [MainThread]: Command `dbt build` failed at 10:27:39.107238 after 9.36 seconds
[0m10:27:39.108253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771F9EA780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771E598E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001771E59B230>]}
[0m10:27:39.108253 [debug] [MainThread]: Flushing usage events
[0m10:27:40.076036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:46.287384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D0030D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D0030D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D0032DE0>]}


============================== 10:29:46.293487 | 9581f479-16e0-418f-9b05-83dac2b8f989 ==============================
[0m10:29:46.293487 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:29:46.294488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m stg_transactions', 'send_anonymous_usage_stats': 'True'}
[0m10:29:46.855976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9581f479-16e0-418f-9b05-83dac2b8f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D17A01A0>]}
[0m10:29:46.928501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9581f479-16e0-418f-9b05-83dac2b8f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D1637170>]}
[0m10:29:46.929690 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:29:47.358649 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:29:47.556347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:47.556347 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\staging\stg_transactions.sql
[0m10:29:47.856243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9581f479-16e0-418f-9b05-83dac2b8f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D1846210>]}
[0m10:29:47.932108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:29:47.936194 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:29:47.984726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9581f479-16e0-418f-9b05-83dac2b8f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D2F9EFC0>]}
[0m10:29:47.985728 [info ] [MainThread]: Found 1 model, 1 source, 474 macros
[0m10:29:47.987645 [info ] [MainThread]: 
[0m10:29:47.988645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:47.989611 [info ] [MainThread]: 
[0m10:29:47.990648 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:29:47.991561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m10:29:48.109493 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m10:29:48.110493 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m10:29:48.110493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:48.869587 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.760 seconds
[0m10:29:48.872606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m10:29:48.934038 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m10:29:48.934038 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m10:29:48.935237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:49.292015 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.357 seconds
[0m10:29:49.294122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9581f479-16e0-418f-9b05-83dac2b8f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D2F9F500>]}
[0m10:29:49.298990 [debug] [Thread-1 (]: Began running node model.hotel_booking.stg_transactions
[0m10:29:49.298990 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:29:49.301024 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.stg_transactions'
[0m10:29:49.301024 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.stg_transactions
[0m10:29:49.309369 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.stg_transactions"
[0m10:29:49.310370 [debug] [Thread-1 (]: Began executing node model.hotel_booking.stg_transactions
[0m10:29:49.347337 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.stg_transactions"
[0m10:29:49.349333 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.stg_transactions"
[0m10:29:49.350550 [debug] [Thread-1 (]: On model.hotel_booking.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.stg_transactions"} */
create or replace transient table HOTEL_MGMT.stage.stg_transactions
         as
        (WITH cte AS(

SELECT *
 FROM hotel_mgmt.raw.transactions
WHERE CUSTOMER_ID IS NOT NULL AND
	PRODUCT_ID IS NOT NULL AND
	PAYMENT_MONTH IS NOT NULL AND
	REVENUE_TYPE IS NOT NULL AND
	REVENUE IS NOT NULL AND
	QUANTITY IS NOT NULL AND
	DIMENSION_1 IS NOT NULL AND
	DIMENSION_2 IS NOT NULL AND
	DIMENSION_3 IS NOT NULL AND
	DIMENSION_4 IS NOT NULL AND
	DIMENSION_5 IS NOT NULL AND
	DIMENSION_6 IS NOT NULL AND
	DIMENSION_7 IS NOT NULL AND
	DIMENSION_8 IS NOT NULL AND
	DIMENSION_9 IS NOT NULL AND
	DIMENSION_10 IS NOT NULL  AND
	COMPANIES  IS NOT NULL ;
[0m10:29:49.350550 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:49.726962 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafecb-0000-e709-0008-ed5a0002818a
[0m10:29:49.728641 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 24 unexpected ';'.
[0m10:29:49.732809 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 24 unexpected ';'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql
[0m10:29:49.735789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9581f479-16e0-418f-9b05-83dac2b8f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D00043B0>]}
[0m10:29:49.735789 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.stg_transactions ................... [[31mERROR[0m in 0.43s]
[0m10:29:49.737997 [debug] [Thread-1 (]: Finished running node model.hotel_booking.stg_transactions
[0m10:29:49.737997 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 24 unexpected ';'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql.
[0m10:29:49.740032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:49.741228 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m10:29:49.741228 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m10:29:49.826729 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m10:29:49.827753 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m10:29:49.917034 [debug] [MainThread]: Connection 'model.hotel_booking.stg_transactions' was left open.
[0m10:29:49.918038 [debug] [MainThread]: On model.hotel_booking.stg_transactions: Close
[0m10:29:50.019052 [info ] [MainThread]: 
[0m10:29:50.019797 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m10:29:50.020803 [debug] [MainThread]: Command end result
[0m10:29:50.047419 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:29:50.049449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:29:50.056697 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m10:29:50.057701 [info ] [MainThread]: 
[0m10:29:50.058663 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:29:50.059667 [info ] [MainThread]: 
[0m10:29:50.060666 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 24 unexpected ';'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql
[0m10:29:50.061667 [info ] [MainThread]: 
[0m10:29:50.061667 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:29:50.063681 [debug] [MainThread]: Command `dbt build` failed at 10:29:50.063681 after 3.97 seconds
[0m10:29:50.064665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D08A5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D2A02BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278D2A036B0>]}
[0m10:29:50.065699 [debug] [MainThread]: Flushing usage events
[0m10:29:51.488847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:30:05.868031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD495BBDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4BEBD880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4BEBE2A0>]}


============================== 10:30:05.873474 | 4132a738-5fd5-40d8-9961-cfa16a4c3015 ==============================
[0m10:30:05.873474 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:30:05.874474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m stg_transactions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:30:06.441346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4132a738-5fd5-40d8-9961-cfa16a4c3015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4D145520>]}
[0m10:30:06.513420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4132a738-5fd5-40d8-9961-cfa16a4c3015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4C677170>]}
[0m10:30:06.515582 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:30:06.959452 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:30:07.158032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:07.159074 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\staging\stg_transactions.sql
[0m10:30:07.458200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4132a738-5fd5-40d8-9961-cfa16a4c3015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4E55F230>]}
[0m10:30:07.534014 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:30:07.538152 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:30:07.589280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4132a738-5fd5-40d8-9961-cfa16a4c3015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4E7DF0B0>]}
[0m10:30:07.589280 [info ] [MainThread]: Found 1 model, 1 source, 474 macros
[0m10:30:07.591413 [info ] [MainThread]: 
[0m10:30:07.592412 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:30:07.593449 [info ] [MainThread]: 
[0m10:30:07.593449 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:30:07.595693 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m10:30:07.717780 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m10:30:07.717780 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m10:30:07.717780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:08.658218 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.941 seconds
[0m10:30:08.661888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m10:30:08.721153 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m10:30:08.722149 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m10:30:08.722149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:09.108123 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.386 seconds
[0m10:30:09.111242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4132a738-5fd5-40d8-9961-cfa16a4c3015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4E40FEC0>]}
[0m10:30:09.115419 [debug] [Thread-1 (]: Began running node model.hotel_booking.stg_transactions
[0m10:30:09.116399 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:30:09.117593 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.stg_transactions'
[0m10:30:09.118585 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.stg_transactions
[0m10:30:09.126970 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.stg_transactions"
[0m10:30:09.127985 [debug] [Thread-1 (]: Began executing node model.hotel_booking.stg_transactions
[0m10:30:09.165500 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.stg_transactions"
[0m10:30:09.167470 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.stg_transactions"
[0m10:30:09.168500 [debug] [Thread-1 (]: On model.hotel_booking.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.stg_transactions"} */
create or replace transient table HOTEL_MGMT.stage.stg_transactions
         as
        (WITH cte AS(

SELECT *
 FROM hotel_mgmt.raw.transactions
WHERE CUSTOMER_ID IS NOT NULL AND
	PRODUCT_ID IS NOT NULL AND
	PAYMENT_MONTH IS NOT NULL AND
	REVENUE_TYPE IS NOT NULL AND
	REVENUE IS NOT NULL AND
	QUANTITY IS NOT NULL AND
	DIMENSION_1 IS NOT NULL AND
	DIMENSION_2 IS NOT NULL AND
	DIMENSION_3 IS NOT NULL AND
	DIMENSION_4 IS NOT NULL AND
	DIMENSION_5 IS NOT NULL AND
	DIMENSION_6 IS NOT NULL AND
	DIMENSION_7 IS NOT NULL AND
	DIMENSION_8 IS NOT NULL AND
	DIMENSION_9 IS NOT NULL AND
	DIMENSION_10 IS NOT NULL  AND
	COMPANIES  IS NOT NULL 
)
SELECT * FROM cte
        );
[0m10:30:09.168500 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:30:10.843131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.674 seconds
[0m10:30:10.871945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4132a738-5fd5-40d8-9961-cfa16a4c3015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD497066F0>]}
[0m10:30:10.872977 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_transactions ....................... [[32mSUCCESS 1[0m in 1.75s]
[0m10:30:10.874182 [debug] [Thread-1 (]: Finished running node model.hotel_booking.stg_transactions
[0m10:30:10.875154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:10.876181 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m10:30:10.876181 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m10:30:10.962147 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m10:30:10.963320 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m10:30:11.067370 [debug] [MainThread]: Connection 'model.hotel_booking.stg_transactions' was left open.
[0m10:30:11.067370 [debug] [MainThread]: On model.hotel_booking.stg_transactions: Close
[0m10:30:11.163113 [info ] [MainThread]: 
[0m10:30:11.164116 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m10:30:11.165290 [debug] [MainThread]: Command end result
[0m10:30:11.190412 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:30:11.193418 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:30:11.199728 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m10:30:11.199728 [info ] [MainThread]: 
[0m10:30:11.200933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:11.201898 [info ] [MainThread]: 
[0m10:30:11.202931 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:30:11.203897 [debug] [MainThread]: Command `dbt build` succeeded at 10:30:11.203897 after 5.53 seconds
[0m10:30:11.205073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4956D460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4C24CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD4D199A60>]}
[0m10:30:11.206072 [debug] [MainThread]: Flushing usage events
[0m10:30:12.228328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:04.880161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFF026510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB8134EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB8196DAC0>]}


============================== 10:40:04.889573 | cf140ee0-d19d-463f-ad96-cf4a3eded93e ==============================
[0m10:40:04.889573 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:40:04.890568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m stg_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:05.750789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf140ee0-d19d-463f-ad96-cf4a3eded93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFF137710>]}
[0m10:40:05.822866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf140ee0-d19d-463f-ad96-cf4a3eded93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFF419B80>]}
[0m10:40:05.825019 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:40:06.430998 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:40:08.124312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m10:40:08.125312 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\staging\stg_products.sql
[0m10:40:08.125312 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\staging\stg_customers.sql
[0m10:40:08.126310 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\source.yml
[0m10:40:08.126310 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\staging\stg_transactions.sql
[0m10:40:08.681096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf140ee0-d19d-463f-ad96-cf4a3eded93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB83F8BF20>]}
[0m10:40:08.757555 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:40:08.789316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:40:08.897007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf140ee0-d19d-463f-ad96-cf4a3eded93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB843E4200>]}
[0m10:40:08.897007 [info ] [MainThread]: Found 3 models, 3 sources, 474 macros
[0m10:40:08.900004 [info ] [MainThread]: 
[0m10:40:08.901004 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:08.902005 [info ] [MainThread]: 
[0m10:40:08.903003 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:40:08.904006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m10:40:12.504296 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m10:40:12.504296 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m10:40:12.505299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:13.409362 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.904 seconds
[0m10:40:13.416384 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m10:40:13.429025 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m10:40:13.429025 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m10:40:13.430023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:13.809098 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.379 seconds
[0m10:40:13.812098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf140ee0-d19d-463f-ad96-cf4a3eded93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB841DB7D0>]}
[0m10:40:13.831558 [debug] [Thread-1 (]: Began running node model.hotel_booking.stg_transactions
[0m10:40:13.832560 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:40:13.833693 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.stg_transactions'
[0m10:40:13.833693 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.stg_transactions
[0m10:40:13.846168 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.stg_transactions"
[0m10:40:13.847177 [debug] [Thread-1 (]: Began executing node model.hotel_booking.stg_transactions
[0m10:40:13.890927 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.stg_transactions"
[0m10:40:13.891927 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.stg_transactions"
[0m10:40:13.893466 [debug] [Thread-1 (]: On model.hotel_booking.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.stg_transactions"} */
create or replace transient table HOTEL_MGMT.stage.stg_transactions
         as
        (WITH cte AS(

SELECT *
 FROM hotel_mgmt.raw.transactions
WHERE CUSTOMER_ID IS NOT NULL AND
	PRODUCT_ID IS NOT NULL AND
	
)
SELECT * FROM cte
        );
[0m10:40:13.893466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:40:14.464577 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafed6-0000-e677-0008-ed5a000213ea
[0m10:40:14.465609 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 0 unexpected ')'.
[0m10:40:14.485759 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected ')'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql
[0m10:40:14.487757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf140ee0-d19d-463f-ad96-cf4a3eded93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB847FCFB0>]}
[0m10:40:14.488884 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.stg_transactions ................... [[31mERROR[0m in 0.65s]
[0m10:40:14.490889 [debug] [Thread-1 (]: Finished running node model.hotel_booking.stg_transactions
[0m10:40:14.490889 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected ')'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql.
[0m10:40:14.493079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:14.493079 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m10:40:14.494112 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m10:40:14.586497 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m10:40:14.586497 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m10:40:14.677517 [debug] [MainThread]: Connection 'model.hotel_booking.stg_transactions' was left open.
[0m10:40:14.678552 [debug] [MainThread]: On model.hotel_booking.stg_transactions: Close
[0m10:40:14.777058 [info ] [MainThread]: 
[0m10:40:14.778022 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m10:40:14.779021 [debug] [MainThread]: Command end result
[0m10:40:14.806636 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:40:14.810965 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:40:14.818329 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m10:40:14.818329 [info ] [MainThread]: 
[0m10:40:14.819364 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:40:14.820327 [info ] [MainThread]: 
[0m10:40:14.821327 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected ')'.
  compiled code at target\run\hotel_booking\models\staging\stg_transactions.sql
[0m10:40:14.823451 [info ] [MainThread]: 
[0m10:40:14.824150 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:40:14.826159 [debug] [MainThread]: Command `dbt build` failed at 10:40:14.826159 after 10.29 seconds
[0m10:40:14.826159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB81CFD640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB817EEDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB817EF890>]}
[0m10:40:14.827390 [debug] [MainThread]: Flushing usage events
[0m10:40:15.969185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:26.619927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002187A5BF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002187A4526F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218767A0D70>]}


============================== 10:40:26.625097 | 99845cee-2023-4185-acd5-b17c79232e2f ==============================
[0m10:40:26.625097 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:40:26.626096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m stg_transactions', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:27.192768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99845cee-2023-4185-acd5-b17c79232e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002187AAAB4A0>]}
[0m10:40:27.266257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99845cee-2023-4185-acd5-b17c79232e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002187B587170>]}
[0m10:40:27.268219 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:40:27.726757 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:40:27.930814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:40:27.930814 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\staging\stg_transactions.sql
[0m10:40:28.233637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99845cee-2023-4185-acd5-b17c79232e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002187CD50D10>]}
[0m10:40:28.317510 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:40:28.321666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:40:28.372682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99845cee-2023-4185-acd5-b17c79232e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002187CE33F80>]}
[0m10:40:28.373684 [info ] [MainThread]: Found 3 models, 3 sources, 474 macros
[0m10:40:28.375681 [info ] [MainThread]: 
[0m10:40:28.376811 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:28.376811 [info ] [MainThread]: 
[0m10:40:28.377809 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:40:28.378811 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m10:40:28.500329 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m10:40:28.503110 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m10:40:28.503110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:29.278740 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.776 seconds
[0m10:40:29.285728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m10:40:29.355691 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m10:40:29.355691 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m10:40:29.356865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:29.966954 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.610 seconds
[0m10:40:29.969940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99845cee-2023-4185-acd5-b17c79232e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002187CE33590>]}
[0m10:40:29.976227 [debug] [Thread-1 (]: Began running node model.hotel_booking.stg_transactions
[0m10:40:29.976227 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:40:29.978204 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.stg_transactions'
[0m10:40:29.978204 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.stg_transactions
[0m10:40:29.988494 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.stg_transactions"
[0m10:40:29.989494 [debug] [Thread-1 (]: Began executing node model.hotel_booking.stg_transactions
[0m10:40:30.032369 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.stg_transactions"
[0m10:40:30.034368 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.stg_transactions"
[0m10:40:30.034368 [debug] [Thread-1 (]: On model.hotel_booking.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.stg_transactions"} */
create or replace transient table HOTEL_MGMT.stage.stg_transactions
         as
        (WITH cte AS(

SELECT *
 FROM hotel_mgmt.raw.transactions
WHERE CUSTOMER_ID IS NOT NULL AND
	PRODUCT_ID IS NOT NULL 
	
)
SELECT * FROM cte
        );
[0m10:40:30.035369 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:40:31.177214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.141 seconds
[0m10:40:31.205137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99845cee-2023-4185-acd5-b17c79232e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021877E36C30>]}
[0m10:40:31.206133 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_transactions ....................... [[32mSUCCESS 1[0m in 1.23s]
[0m10:40:31.207104 [debug] [Thread-1 (]: Finished running node model.hotel_booking.stg_transactions
[0m10:40:31.208296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:31.209337 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m10:40:31.209337 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m10:40:31.306880 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m10:40:31.307894 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m10:40:31.419989 [debug] [MainThread]: Connection 'model.hotel_booking.stg_transactions' was left open.
[0m10:40:31.419989 [debug] [MainThread]: On model.hotel_booking.stg_transactions: Close
[0m10:40:31.511855 [info ] [MainThread]: 
[0m10:40:31.513093 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m10:40:31.515093 [debug] [MainThread]: Command end result
[0m10:40:31.544084 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:40:31.547255 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:40:31.554285 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m10:40:31.555258 [info ] [MainThread]: 
[0m10:40:31.556251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:40:31.557289 [info ] [MainThread]: 
[0m10:40:31.558473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:40:31.559462 [debug] [MainThread]: Command `dbt build` succeeded at 10:40:31.559462 after 5.15 seconds
[0m10:40:31.560496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021879FCEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021879FCC3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021879FCEED0>]}
[0m10:40:31.561497 [debug] [MainThread]: Flushing usage events
[0m10:40:32.568452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:42:46.523735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED8C1A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED8C19B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED8C1B890>]}


============================== 10:42:46.529225 | 9d2dd64d-d4d0-4e82-93f8-92626405c91b ==============================
[0m10:42:46.529225 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:42:46.530223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m stg_customers stg_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:42:47.085660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d2dd64d-d4d0-4e82-93f8-92626405c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED9E4A690>]}
[0m10:42:47.154144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d2dd64d-d4d0-4e82-93f8-92626405c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED9C8CC20>]}
[0m10:42:47.156259 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:42:47.589794 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:42:47.797022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:42:47.797022 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\staging\stg_customers.sql
[0m10:42:47.798022 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\staging\stg_products.sql
[0m10:42:48.100364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d2dd64d-d4d0-4e82-93f8-92626405c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEDB294B90>]}
[0m10:42:48.174328 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:42:48.179724 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:42:48.233370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d2dd64d-d4d0-4e82-93f8-92626405c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEDB493EF0>]}
[0m10:42:48.234369 [info ] [MainThread]: Found 3 models, 3 sources, 474 macros
[0m10:42:48.236556 [info ] [MainThread]: 
[0m10:42:48.237523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:42:48.238522 [info ] [MainThread]: 
[0m10:42:48.238522 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:42:48.244732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m10:42:48.363846 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m10:42:48.363846 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m10:42:48.364849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:49.181610 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.817 seconds
[0m10:42:49.186492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m10:42:49.252084 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m10:42:49.252084 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m10:42:49.253263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:49.667980 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.415 seconds
[0m10:42:49.676496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2dd64d-d4d0-4e82-93f8-92626405c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED653C890>]}
[0m10:42:49.684251 [debug] [Thread-1 (]: Began running node model.hotel_booking.stg_customers
[0m10:42:49.684251 [info ] [Thread-1 (]: 1 of 2 START sql table model stage.stg_customers ............................... [RUN]
[0m10:42:49.685272 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.stg_customers'
[0m10:42:49.686452 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.stg_customers
[0m10:42:49.694862 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.stg_customers"
[0m10:42:49.696827 [debug] [Thread-1 (]: Began executing node model.hotel_booking.stg_customers
[0m10:42:49.733820 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.stg_customers"
[0m10:42:49.734821 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.stg_customers"
[0m10:42:49.735820 [debug] [Thread-1 (]: On model.hotel_booking.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.stg_customers"} */
create or replace transient table HOTEL_MGMT.stage.stg_customers
         as
        (WITH cte AS(

SELECT *
 FROM hotel_mgmt.raw.customers
WHERE CUSTOMER_ID IS NOT NULL 
)
SELECT * FROM cte
        );
[0m10:42:49.735820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:42:50.604027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.867 seconds
[0m10:42:50.648007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d2dd64d-d4d0-4e82-93f8-92626405c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED6496960>]}
[0m10:42:50.649016 [info ] [Thread-1 (]: 1 of 2 OK created sql table model stage.stg_customers .......................... [[32mSUCCESS 1[0m in 0.96s]
[0m10:42:50.650049 [debug] [Thread-1 (]: Finished running node model.hotel_booking.stg_customers
[0m10:42:50.650049 [debug] [Thread-1 (]: Began running node model.hotel_booking.stg_products
[0m10:42:50.651255 [info ] [Thread-1 (]: 2 of 2 START sql table model stage.stg_products ................................ [RUN]
[0m10:42:50.651760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.hotel_booking.stg_customers, now model.hotel_booking.stg_products)
[0m10:42:50.651760 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.stg_products
[0m10:42:50.654800 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.stg_products"
[0m10:42:50.662156 [debug] [Thread-1 (]: Began executing node model.hotel_booking.stg_products
[0m10:42:50.666197 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.stg_products"
[0m10:42:50.668163 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.stg_products"
[0m10:42:50.668163 [debug] [Thread-1 (]: On model.hotel_booking.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.stg_products"} */
create or replace transient table HOTEL_MGMT.stage.stg_products
         as
        (WITH cte AS(

SELECT *
 FROM hotel_mgmt.raw.products
WHERE PRODUCT_ID IS NOT NULL 
)
SELECT * FROM cte
        );
[0m10:42:51.163904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m10:42:51.167436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d2dd64d-d4d0-4e82-93f8-92626405c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEDB071B50>]}
[0m10:42:51.167436 [info ] [Thread-1 (]: 2 of 2 OK created sql table model stage.stg_products ........................... [[32mSUCCESS 1[0m in 0.52s]
[0m10:42:51.168436 [debug] [Thread-1 (]: Finished running node model.hotel_booking.stg_products
[0m10:42:51.170598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:51.170598 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m10:42:51.171618 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m10:42:51.261321 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m10:42:51.261321 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m10:42:51.366601 [debug] [MainThread]: Connection 'model.hotel_booking.stg_products' was left open.
[0m10:42:51.367605 [debug] [MainThread]: On model.hotel_booking.stg_products: Close
[0m10:42:51.477992 [info ] [MainThread]: 
[0m10:42:51.478960 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m10:42:51.479960 [debug] [MainThread]: Command end result
[0m10:42:51.503539 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:42:51.507816 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:42:51.515272 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m10:42:51.516271 [info ] [MainThread]: 
[0m10:42:51.516995 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:51.518005 [info ] [MainThread]: 
[0m10:42:51.518005 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:42:51.520037 [debug] [MainThread]: Command `dbt build` succeeded at 10:42:51.520037 after 5.19 seconds
[0m10:42:51.520037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED8FDD730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED8D4D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DED8AB31D0>]}
[0m10:42:51.521037 [debug] [MainThread]: Flushing usage events
[0m10:42:52.525298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:37.094011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548A22D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5492A8CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54B22F9E0>]}


============================== 10:47:37.102298 | 7e988327-00a6-45ce-b2f1-5a8e4823fbef ==============================
[0m10:47:37.102298 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:47:37.103410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:47:37.949921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e988327-00a6-45ce-b2f1-5a8e4823fbef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54B758A40>]}
[0m10:47:38.026166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e988327-00a6-45ce-b2f1-5a8e4823fbef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54B7AB3E0>]}
[0m10:47:38.028286 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:47:38.563286 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:47:38.807222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:47:38.808219 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\transform\churn_new_cust.sql
[0m10:47:39.122533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e988327-00a6-45ce-b2f1-5a8e4823fbef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54DAF4EC0>]}
[0m10:47:39.200245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:47:39.205581 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:47:39.279941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e988327-00a6-45ce-b2f1-5a8e4823fbef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54DA9A030>]}
[0m10:47:39.281227 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m10:47:39.284226 [info ] [MainThread]: 
[0m10:47:39.285349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:47:39.285821 [info ] [MainThread]: 
[0m10:47:39.286364 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:47:39.287372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m10:47:39.421142 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m10:47:39.422143 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m10:47:39.422143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:40.258071 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.835 seconds
[0m10:47:40.266343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m10:47:40.325838 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m10:47:40.326838 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m10:47:40.326838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:40.689987 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.362 seconds
[0m10:47:40.693528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e988327-00a6-45ce-b2f1-5a8e4823fbef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54C50B4A0>]}
[0m10:47:40.704486 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m10:47:40.705523 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m10:47:40.706485 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m10:47:40.706485 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m10:47:40.714739 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m10:47:40.717882 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m10:47:40.753899 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m10:47:40.756866 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m10:47:40.757409 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (CREATE OR REPLACE TABLE churn_new_customers AS
SELECT
    payment_month,
    COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN last_purchase_date < payment_month THEN customer_id END) AS churned_customers
FROM enriched_booking
JOIN customer_status USING (customer_id)
GROUP BY payment_month
ORDER BY payment_month;
[0m10:47:40.757409 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:47:41.103278 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafedd-0000-e709-0008-ed5a0002825a
[0m10:47:41.104280 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 3 at position 9 unexpected 'CREATE'.
syntax error line 6 at position 87 unexpected 'AS'.
[0m10:47:41.109811 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'CREATE'.
  syntax error line 6 at position 87 unexpected 'AS'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m10:47:41.112984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e988327-00a6-45ce-b2f1-5a8e4823fbef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54AC44710>]}
[0m10:47:41.112984 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.40s]
[0m10:47:41.113986 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m10:47:41.114985 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'CREATE'.
  syntax error line 6 at position 87 unexpected 'AS'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m10:47:41.117161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:41.117161 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m10:47:41.118185 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m10:47:41.212237 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m10:47:41.213569 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m10:47:41.310208 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m10:47:41.311210 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m10:47:41.409267 [info ] [MainThread]: 
[0m10:47:41.411497 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m10:47:41.414910 [debug] [MainThread]: Command end result
[0m10:47:41.456560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:47:41.459858 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:47:41.467749 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m10:47:41.468733 [info ] [MainThread]: 
[0m10:47:41.469761 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:47:41.469761 [info ] [MainThread]: 
[0m10:47:41.470885 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'CREATE'.
  syntax error line 6 at position 87 unexpected 'AS'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m10:47:41.471535 [info ] [MainThread]: 
[0m10:47:41.472551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:47:41.473544 [debug] [MainThread]: Command `dbt build` failed at 10:47:41.473544 after 4.73 seconds
[0m10:47:41.474578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548A22D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54ABEA0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54B67CB90>]}
[0m10:47:41.474578 [debug] [MainThread]: Flushing usage events
[0m10:47:42.672148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:41.567964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA3247500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA3247560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA4C16DE0>]}


============================== 10:49:41.572842 | e3add0bd-7243-4a35-9f67-c1688edd312f ==============================
[0m10:49:41.572842 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:49:41.573886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:49:42.146154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3add0bd-7243-4a35-9f67-c1688edd312f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA2857890>]}
[0m10:49:42.215240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3add0bd-7243-4a35-9f67-c1688edd312f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA4FDF620>]}
[0m10:49:42.217447 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:49:42.637844 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:49:42.850013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:49:42.850013 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m10:49:43.150385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3add0bd-7243-4a35-9f67-c1688edd312f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA77E5130>]}
[0m10:49:43.228437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:49:43.232574 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:49:43.287173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3add0bd-7243-4a35-9f67-c1688edd312f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA778A2A0>]}
[0m10:49:43.288174 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m10:49:43.289187 [info ] [MainThread]: 
[0m10:49:43.290726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:43.291751 [info ] [MainThread]: 
[0m10:49:43.292734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:49:43.293734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m10:49:43.423465 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m10:49:43.423465 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m10:49:43.423465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:44.194524 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.770 seconds
[0m10:49:44.201503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m10:49:44.259569 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m10:49:44.259569 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m10:49:44.260752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:44.640981 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.381 seconds
[0m10:49:44.651798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3add0bd-7243-4a35-9f67-c1688edd312f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA77E6F90>]}
[0m10:49:44.668005 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m10:49:44.669046 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m10:49:44.670013 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m10:49:44.670013 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m10:49:44.679452 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m10:49:44.680610 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m10:49:44.717975 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m10:49:44.719965 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m10:49:44.719965 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH  churn_new_customers AS(
SELECT
    payment_month,
    COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN last_purchase_date < payment_month THEN customer_id END) AS churned_customers
FROM HOTEL_MGMT.stage.stg_transactions
JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
GROUP BY payment_month
ORDER BY payment_month
)
SELECT * FROM churn_new_customers
        );
[0m10:49:44.720966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:49:45.092306 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafedf-0000-e6c6-0008-ed5a00027302
[0m10:49:45.092306 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 29
invalid identifier 'FIRST_PURCHASE_DATE'
[0m10:49:45.096554 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 6 at position 29
  invalid identifier 'FIRST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m10:49:45.099526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3add0bd-7243-4a35-9f67-c1688edd312f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA764FCE0>]}
[0m10:49:45.100533 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.43s]
[0m10:49:45.101533 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m10:49:45.102566 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 6 at position 29
  invalid identifier 'FIRST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m10:49:45.104116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:45.104116 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m10:49:45.105148 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m10:49:45.192572 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m10:49:45.193571 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m10:49:45.298921 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m10:49:45.300857 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m10:49:45.396616 [info ] [MainThread]: 
[0m10:49:45.397611 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m10:49:45.398853 [debug] [MainThread]: Command end result
[0m10:49:45.425930 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m10:49:45.428930 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m10:49:45.435965 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m10:49:45.435965 [info ] [MainThread]: 
[0m10:49:45.437203 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:49:45.438169 [info ] [MainThread]: 
[0m10:49:45.439171 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 6 at position 29
  invalid identifier 'FIRST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m10:49:45.441200 [info ] [MainThread]: 
[0m10:49:45.442168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:49:45.443191 [debug] [MainThread]: Command `dbt build` failed at 10:49:45.443191 after 4.18 seconds
[0m10:49:45.444203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA2BD0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA2BD0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA4B1CA70>]}
[0m10:49:45.444203 [debug] [MainThread]: Flushing usage events
[0m10:49:46.764461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:46.988151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808F4FEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808F4FED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808F4FDDF0>]}


============================== 11:01:46.993313 | a71e51f8-5fbd-4e7c-9218-3cf01a890228 ==============================
[0m11:01:46.993313 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:01:46.995274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:01:47.622135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71e51f8-5fbd-4e7c-9218-3cf01a890228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280917CEB70>]}
[0m11:01:47.690434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a71e51f8-5fbd-4e7c-9218-3cf01a890228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808CDA7710>]}
[0m11:01:47.692580 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:01:48.272836 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:01:49.863326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:49.864326 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:01:50.165289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a71e51f8-5fbd-4e7c-9218-3cf01a890228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028091B76210>]}
[0m11:01:50.239996 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:01:50.267332 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:01:50.346708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a71e51f8-5fbd-4e7c-9218-3cf01a890228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028091CEABD0>]}
[0m11:01:50.347831 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:01:50.349800 [info ] [MainThread]: 
[0m11:01:50.350836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:50.352026 [info ] [MainThread]: 
[0m11:01:50.352975 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:01:50.354016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:01:53.762773 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:01:53.763806 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:01:53.763806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:54.472649 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.708 seconds
[0m11:01:54.479953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:01:54.538463 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:01:54.538463 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:01:54.539651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:54.940072 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.401 seconds
[0m11:01:54.950834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71e51f8-5fbd-4e7c-9218-3cf01a890228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028091CE81A0>]}
[0m11:01:54.958278 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:01:54.959263 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:01:54.960238 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:01:54.960238 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:01:54.969715 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:01:54.970879 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:01:55.007737 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:01:55.009891 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:01:55.009891 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH  churn_new_customers AS(
SELECT
    payment_month,
    customer_id,
    customer_name,
    MIN(payment_month) AS first_purchase_date,
    MAX(payment_month) AS last_purchase_date,
    COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN last_purchase_date < payment_month THEN customer_id END) AS churned_customers
FROM HOTEL_MGMT.stage.stg_transactions  
JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
GROUP BY payment_month
ORDER BY payment_month
)
SELECT * FROM churn_new_customers
        );
[0m11:01:55.010928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:01:55.546912 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeeb-0000-e709-0008-ed5a0002828e
[0m11:01:55.547911 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'CUSTOMER_NAME'
[0m11:01:55.564756 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:01:55.567918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71e51f8-5fbd-4e7c-9218-3cf01a890228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808EEB4320>]}
[0m11:01:55.567918 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.61s]
[0m11:01:55.569312 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:01:55.570353 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m11:01:55.571352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:55.572569 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:01:55.572569 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:01:55.654819 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:01:55.655823 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:01:55.743664 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:01:55.744665 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:01:55.835087 [info ] [MainThread]: 
[0m11:01:55.836047 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m11:01:55.839250 [debug] [MainThread]: Command end result
[0m11:01:55.877827 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:01:55.880830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:01:55.888508 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:01:55.888508 [info ] [MainThread]: 
[0m11:01:55.890517 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:01:55.891269 [info ] [MainThread]: 
[0m11:01:55.892034 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:01:55.893049 [info ] [MainThread]: 
[0m11:01:55.894095 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:01:55.895056 [debug] [MainThread]: Command `dbt build` failed at 11:01:55.895056 after 9.20 seconds
[0m11:01:55.895056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808C39AA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808C39A480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808F6138F0>]}
[0m11:01:55.896370 [debug] [MainThread]: Flushing usage events
[0m11:01:57.186577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:08.092729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347AFC1DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347B340200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347AFC1E20>]}


============================== 11:02:08.098088 | 69f41923-fda5-4024-bc6b-d723165a380e ==============================
[0m11:02:08.098088 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:02:08.100052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:02:08.644379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69f41923-fda5-4024-bc6b-d723165a380e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347C22E780>]}
[0m11:02:08.713789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69f41923-fda5-4024-bc6b-d723165a380e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347C18EF60>]}
[0m11:02:08.715272 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:02:09.141451 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:02:09.344717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:02:09.344717 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:02:09.648600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69f41923-fda5-4024-bc6b-d723165a380e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347C18CBF0>]}
[0m11:02:09.725617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:02:09.730734 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:02:09.783161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69f41923-fda5-4024-bc6b-d723165a380e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347D805D30>]}
[0m11:02:09.784310 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:02:09.786156 [info ] [MainThread]: 
[0m11:02:09.787197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:09.788163 [info ] [MainThread]: 
[0m11:02:09.789164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:02:09.790390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:02:09.908327 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:02:09.908327 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:02:09.909329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:10.698610 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.789 seconds
[0m11:02:10.705958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:02:10.764746 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:02:10.765748 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:02:10.765748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:11.140157 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.374 seconds
[0m11:02:11.144350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69f41923-fda5-4024-bc6b-d723165a380e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347DA70080>]}
[0m11:02:11.149655 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:02:11.150692 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:02:11.151652 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:02:11.151652 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:02:11.160688 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:02:11.161687 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:02:11.197594 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:02:11.201093 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:02:11.202125 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH  churn_new_customers AS(
SELECT
    payment_month,
    customer_id,
    
    MIN(payment_month) AS first_purchase_date,
    MAX(payment_month) AS last_purchase_date,
    COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN last_purchase_date < payment_month THEN customer_id END) AS churned_customers
FROM HOTEL_MGMT.stage.stg_transactions  
JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
GROUP BY payment_month
ORDER BY payment_month
)
SELECT * FROM churn_new_customers
        );
[0m11:02:11.203102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:02:11.583564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeec-0000-e709-0008-ed5a00028292
[0m11:02:11.584596 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002082 (42601): SQL compilation error: 
Aggregate functions cannot be nested: [MIN(SYS_VW.PAYMENT_MONTH)] nested in [COUNT(DISTINCT IFF(FIRST_PURCHASE_DATE = SYS_VW.PAYMENT_MONTH, SYS_VW.CUSTOMER_ID, SYSTEM$NULL_TO_FIXED(null)))]
[0m11:02:11.587802 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  002082 (42601): SQL compilation error: 
  Aggregate functions cannot be nested: [MIN(SYS_VW.PAYMENT_MONTH)] nested in [COUNT(DISTINCT IFF(FIRST_PURCHASE_DATE = SYS_VW.PAYMENT_MONTH, SYS_VW.CUSTOMER_ID, SYSTEM$NULL_TO_FIXED(null)))]
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:02:11.590954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f41923-fda5-4024-bc6b-d723165a380e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347D4F4C20>]}
[0m11:02:11.590954 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.44s]
[0m11:02:11.592993 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:02:11.592993 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  002082 (42601): SQL compilation error: 
  Aggregate functions cannot be nested: [MIN(SYS_VW.PAYMENT_MONTH)] nested in [COUNT(DISTINCT IFF(FIRST_PURCHASE_DATE = SYS_VW.PAYMENT_MONTH, SYS_VW.CUSTOMER_ID, SYSTEM$NULL_TO_FIXED(null)))]
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m11:02:11.594767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:11.595759 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:02:11.595759 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:02:11.682750 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:02:11.683760 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:02:11.765660 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:02:11.766658 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:02:11.866434 [info ] [MainThread]: 
[0m11:02:11.868393 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m11:02:11.872896 [debug] [MainThread]: Command end result
[0m11:02:11.902020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:02:11.904989 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:02:11.912040 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:02:11.913300 [info ] [MainThread]: 
[0m11:02:11.914265 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:02:11.914716 [info ] [MainThread]: 
[0m11:02:11.915752 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  002082 (42601): SQL compilation error: 
  Aggregate functions cannot be nested: [MIN(SYS_VW.PAYMENT_MONTH)] nested in [COUNT(DISTINCT IFF(FIRST_PURCHASE_DATE = SYS_VW.PAYMENT_MONTH, SYS_VW.CUSTOMER_ID, SYSTEM$NULL_TO_FIXED(null)))]
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:02:11.916725 [info ] [MainThread]: 
[0m11:02:11.917727 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:02:11.919760 [debug] [MainThread]: Command `dbt build` failed at 11:02:11.918727 after 4.02 seconds
[0m11:02:11.919760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347B177EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347AC52780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347BFFB860>]}
[0m11:02:11.920758 [debug] [MainThread]: Flushing usage events
[0m11:02:13.720266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:14.911769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5721D2C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5721D2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5745C0DA0>]}


============================== 11:04:14.916939 | 8c80afaf-3803-4a47-870a-eeabd8f62da3 ==============================
[0m11:04:14.916939 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:04:14.917942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:04:15.492811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c80afaf-3803-4a47-870a-eeabd8f62da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B575B7A780>]}
[0m11:04:15.563736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c80afaf-3803-4a47-870a-eeabd8f62da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5747B5A00>]}
[0m11:04:15.565440 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:04:16.003178 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:04:16.210715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:04:16.211715 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:04:16.512577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c80afaf-3803-4a47-870a-eeabd8f62da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5771B3C50>]}
[0m11:04:16.591795 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:04:16.595975 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:04:16.649395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c80afaf-3803-4a47-870a-eeabd8f62da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5772DFB90>]}
[0m11:04:16.650396 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:04:16.651808 [info ] [MainThread]: 
[0m11:04:16.652807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:16.653992 [info ] [MainThread]: 
[0m11:04:16.654647 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:04:16.655691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:04:16.776743 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:04:16.776743 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:04:16.777742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:17.650445 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.873 seconds
[0m11:04:17.668547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:04:17.728281 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:04:17.728281 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:04:17.729279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:18.068574 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.339 seconds
[0m11:04:18.071559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c80afaf-3803-4a47-870a-eeabd8f62da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5772DFB60>]}
[0m11:04:18.077991 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:04:18.079002 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:04:18.079966 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:04:18.079966 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:04:18.089582 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:04:18.091548 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:04:18.128144 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:04:18.131150 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:04:18.131150 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
),
aggregated_data AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date < payment_month THEN customer_id END) AS churned_customers
    FROM churn_new_customers
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM aggregated_data;
[0m11:04:18.132145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:04:18.468374 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeee-0000-e709-0008-ed5a0002829a
[0m11:04:18.469374 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 29 unexpected ';'.
[0m11:04:18.473517 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 29 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:04:18.475656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c80afaf-3803-4a47-870a-eeabd8f62da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5743E4320>]}
[0m11:04:18.476653 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.39s]
[0m11:04:18.478623 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:04:18.478623 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 29 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m11:04:18.480729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:18.480729 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:04:18.481726 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:04:18.576789 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:04:18.576789 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:04:18.663221 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:04:18.664263 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:04:18.750912 [info ] [MainThread]: 
[0m11:04:18.753316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m11:04:18.756773 [debug] [MainThread]: Command end result
[0m11:04:18.801732 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:04:18.803961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:04:18.811515 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:04:18.812516 [info ] [MainThread]: 
[0m11:04:18.813237 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:04:18.814081 [info ] [MainThread]: 
[0m11:04:18.815125 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 29 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:04:18.815125 [info ] [MainThread]: 
[0m11:04:18.816356 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:04:18.817366 [debug] [MainThread]: Command `dbt build` failed at 11:04:18.817366 after 4.17 seconds
[0m11:04:18.818396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B572CC7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B572CC7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B572CC6240>]}
[0m11:04:18.818396 [debug] [MainThread]: Flushing usage events
[0m11:04:19.796667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:28.468027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137378A9A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001373A44EF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001373A44EE10>]}


============================== 11:04:28.473385 | 964756eb-238d-40f4-af59-32931b6e159a ==============================
[0m11:04:28.473385 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:04:28.474178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:04:29.027057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '964756eb-238d-40f4-af59-32931b6e159a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001373BAA1220>]}
[0m11:04:29.097772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '964756eb-238d-40f4-af59-32931b6e159a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001373BB07170>]}
[0m11:04:29.100039 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:04:29.531400 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:04:29.728897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:04:29.728897 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:04:30.023163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '964756eb-238d-40f4-af59-32931b6e159a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001373ADC31D0>]}
[0m11:04:30.098552 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:04:30.102666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:04:30.154404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '964756eb-238d-40f4-af59-32931b6e159a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001373D2BFEF0>]}
[0m11:04:30.154404 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:04:30.156880 [info ] [MainThread]: 
[0m11:04:30.157881 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:30.159074 [info ] [MainThread]: 
[0m11:04:30.159074 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:04:30.160828 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:04:30.279589 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:04:30.280590 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:04:30.280590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:30.778024 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.497 seconds
[0m11:04:30.796912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:04:30.852463 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:04:30.853507 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:04:30.853507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:31.221380 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.368 seconds
[0m11:04:31.232475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '964756eb-238d-40f4-af59-32931b6e159a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001373D1EB620>]}
[0m11:04:31.248901 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:04:31.250958 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:04:31.254673 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:04:31.256754 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:04:31.267204 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:04:31.268205 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:04:31.305245 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:04:31.307278 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:04:31.307278 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
),
aggregated_data AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date < payment_month THEN customer_id END) AS churned_customers
    FROM churn_new_customers
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM aggregated_data
        );
[0m11:04:31.308278 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:04:32.422262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m11:04:32.447107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '964756eb-238d-40f4-af59-32931b6e159a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137382B6A80>]}
[0m11:04:32.448207 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.19s]
[0m11:04:32.450191 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:04:32.451173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:32.451173 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:04:32.452394 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:04:32.544235 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:04:32.546317 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:04:32.640687 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:04:32.641907 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:04:32.722987 [info ] [MainThread]: 
[0m11:04:32.725636 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m11:04:32.729163 [debug] [MainThread]: Command end result
[0m11:04:32.767375 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:04:32.770573 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:04:32.777759 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:04:32.777759 [info ] [MainThread]: 
[0m11:04:32.779757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:32.779757 [info ] [MainThread]: 
[0m11:04:32.780790 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:04:32.781979 [debug] [MainThread]: Command `dbt build` succeeded at 11:04:32.781979 after 4.51 seconds
[0m11:04:32.783020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001373A532BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013738A76240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001373796A3C0>]}
[0m11:04:32.783020 [debug] [MainThread]: Flushing usage events
[0m11:04:33.816776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:47.638470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E7E768D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EA949460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EA949940>]}


============================== 11:32:47.649232 | 3c3a4496-61d9-4aaf-b9cb-a06af870e4df ==============================
[0m11:32:47.649232 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:32:47.651335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m11:32:48.675540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c3a4496-61d9-4aaf-b9cb-a06af870e4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EAF793D0>]}
[0m11:32:48.745121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c3a4496-61d9-4aaf-b9cb-a06af870e4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EA0C0C80>]}
[0m11:32:48.746729 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:32:49.359045 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:32:51.024102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:32:51.025101 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:32:51.320430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c3a4496-61d9-4aaf-b9cb-a06af870e4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EB9EB1D0>]}
[0m11:32:51.395933 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:32:51.422657 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:32:51.543593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c3a4496-61d9-4aaf-b9cb-a06af870e4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267ED04FA40>]}
[0m11:32:51.544591 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:32:51.547867 [info ] [MainThread]: 
[0m11:32:51.548863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:32:51.549864 [info ] [MainThread]: 
[0m11:32:51.550978 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:51.551978 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:32:55.001841 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:32:55.002844 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:32:55.002844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:56.132816 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.129 seconds
[0m11:32:56.148770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:32:56.205813 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:32:56.205813 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:32:56.206812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:56.548118 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.341 seconds
[0m11:32:56.559093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c3a4496-61d9-4aaf-b9cb-a06af870e4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267ECF7B590>]}
[0m11:32:56.589005 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:32:56.591330 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:32:56.594520 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:32:56.596573 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:32:56.617514 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:32:56.619511 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:32:56.656528 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:32:56.658527 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:32:56.659531 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    WHERE revenue_type=1
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
),
aggregated_data AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date < payment_month THEN customer_id END) AS churned_customers
    FROM churn_new_customers
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM aggregated_data
        );
[0m11:32:56.659531 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:32:57.238710 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff0a-0000-e6bd-0008-ed5a00026512
[0m11:32:57.239710 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 4 unexpected 'JOIN'.
syntax error line 11 at position 47 unexpected 'customer_id'.
syntax error line 12 at position 1 unexpected ','.
[0m11:32:57.257343 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 4 unexpected 'JOIN'.
  syntax error line 11 at position 47 unexpected 'customer_id'.
  syntax error line 12 at position 1 unexpected ','.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:32:57.260617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c3a4496-61d9-4aaf-b9cb-a06af870e4df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EA094290>]}
[0m11:32:57.261626 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.67s]
[0m11:32:57.262625 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:32:57.262625 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 4 unexpected 'JOIN'.
  syntax error line 11 at position 47 unexpected 'customer_id'.
  syntax error line 12 at position 1 unexpected ','.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m11:32:57.264769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:57.265804 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:32:57.265804 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:32:57.361932 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:32:57.362933 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:32:57.456412 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:32:57.457411 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:32:57.552474 [info ] [MainThread]: 
[0m11:32:57.553710 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m11:32:57.556094 [debug] [MainThread]: Command end result
[0m11:32:57.591400 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:32:57.594665 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:32:57.603174 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:32:57.603174 [info ] [MainThread]: 
[0m11:32:57.604227 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:32:57.605237 [info ] [MainThread]: 
[0m11:32:57.606267 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 4 unexpected 'JOIN'.
  syntax error line 11 at position 47 unexpected 'customer_id'.
  syntax error line 12 at position 1 unexpected ','.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:32:57.606775 [info ] [MainThread]: 
[0m11:32:57.607783 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:32:57.609784 [debug] [MainThread]: Command `dbt build` failed at 11:32:57.609784 after 10.22 seconds
[0m11:32:57.610788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E7DE7D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EA91ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E8265DF0>]}
[0m11:32:57.610788 [debug] [MainThread]: Flushing usage events
[0m11:32:59.029612 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:18.328521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2ACD9E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2ACC0E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AA9C0AA0>]}


============================== 11:33:18.334884 | 72e99ee3-5abd-458b-b38e-a95ee174cccb ==============================
[0m11:33:18.334884 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:33:18.335852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:33:18.881081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72e99ee3-5abd-458b-b38e-a95ee174cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2ADFE6690>]}
[0m11:33:18.949657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72e99ee3-5abd-458b-b38e-a95ee174cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2ADD121E0>]}
[0m11:33:18.951620 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:33:19.387778 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:33:19.602661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:19.603664 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:33:19.902558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72e99ee3-5abd-458b-b38e-a95ee174cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AF48B650>]}
[0m11:33:19.980599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:33:19.984850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:33:20.033527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72e99ee3-5abd-458b-b38e-a95ee174cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AF67BC80>]}
[0m11:33:20.033527 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:33:20.036534 [info ] [MainThread]: 
[0m11:33:20.036534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:33:20.037672 [info ] [MainThread]: 
[0m11:33:20.038673 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:33:20.039672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:33:20.160468 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:33:20.160468 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:33:20.161469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:20.879565 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.718 seconds
[0m11:33:20.888040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:33:20.950485 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:33:20.951485 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:33:20.951485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:21.320159 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.369 seconds
[0m11:33:21.324210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72e99ee3-5abd-458b-b38e-a95ee174cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AF561C40>]}
[0m11:33:21.328668 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:33:21.329709 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:33:21.330676 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:33:21.331675 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:33:21.340144 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:33:21.341146 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:33:21.378689 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:33:21.381839 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:33:21.381839 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
    WHERE revenue_type=1
),
aggregated_data AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date < payment_month THEN customer_id END) AS churned_customers
    FROM churn_new_customers
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM aggregated_data
        );
[0m11:33:21.382873 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:33:22.414023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.031 seconds
[0m11:33:22.444231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e99ee3-5abd-458b-b38e-a95ee174cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AA646810>]}
[0m11:33:22.445239 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.11s]
[0m11:33:22.446240 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:33:22.447239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:22.448424 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:33:22.448424 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:33:22.532670 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:33:22.533668 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:33:22.613952 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:33:22.613952 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:33:22.699844 [info ] [MainThread]: 
[0m11:33:22.700841 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m11:33:22.701843 [debug] [MainThread]: Command end result
[0m11:33:22.727405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:33:22.730409 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:33:22.737437 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:33:22.738413 [info ] [MainThread]: 
[0m11:33:22.739413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:22.740414 [info ] [MainThread]: 
[0m11:33:22.740414 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:33:22.742618 [debug] [MainThread]: Command `dbt build` succeeded at 11:33:22.742618 after 4.60 seconds
[0m11:33:22.742618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AA43BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AA43AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AD0226F0>]}
[0m11:33:22.743619 [debug] [MainThread]: Flushing usage events
[0m11:33:23.792821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:05.444317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023068B26AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023068AA4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306BBA1400>]}


============================== 11:48:05.449740 | 1247ee0a-3ff0-4880-b8f8-86dad27b30ea ==============================
[0m11:48:05.449740 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:48:05.450740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m11:48:06.059698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1247ee0a-3ff0-4880-b8f8-86dad27b30ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023069467B30>]}
[0m11:48:06.129450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1247ee0a-3ff0-4880-b8f8-86dad27b30ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306BB12270>]}
[0m11:48:06.131315 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:48:06.714225 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:48:08.295945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:08.296946 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:48:08.587150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1247ee0a-3ff0-4880-b8f8-86dad27b30ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306E06BFE0>]}
[0m11:48:08.663695 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:48:08.680679 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:48:08.762016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1247ee0a-3ff0-4880-b8f8-86dad27b30ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306E38ABA0>]}
[0m11:48:08.762016 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:48:08.765026 [info ] [MainThread]: 
[0m11:48:08.765806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:08.766814 [info ] [MainThread]: 
[0m11:48:08.766814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:08.768813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:48:12.205824 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:48:12.206825 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:48:12.206825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:13.240863 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.034 seconds
[0m11:48:13.248226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:48:13.311534 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:48:13.312534 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:48:13.312534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:13.705187 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.392 seconds
[0m11:48:13.717098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1247ee0a-3ff0-4880-b8f8-86dad27b30ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306E265340>]}
[0m11:48:13.732980 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:48:13.736028 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:48:13.739328 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:48:13.740329 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:48:13.750683 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:48:13.751687 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:48:13.787991 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:48:13.790573 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:48:13.790573 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT DISTINCT payment_month,
           COUNT(DISTINCT CASE WHEN payment_month = first_purchase_date THEN customer_id END) AS new_customers,
           COUNT(DISTINCT CASE WHEN payment_month > last_purchase_date THEN customer_id END) AS churned_customers
    FROM customer_purchase_dates
    GROUP BY payment_month
)
SELECT payment_month, new_customers, churned_customers
FROM monthly_status
ORDER BY payment_month;
[0m11:48:13.791575 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:48:14.317525 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff1a-0000-e6c6-0008-ed5a00027426
[0m11:48:14.318524 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 22 unexpected ';'.
[0m11:48:14.336828 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 22 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:48:14.338802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1247ee0a-3ff0-4880-b8f8-86dad27b30ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306E8D81A0>]}
[0m11:48:14.339835 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.60s]
[0m11:48:14.340802 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:48:14.341844 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 22 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m11:48:14.343802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:14.343802 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:48:14.343802 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:48:14.447963 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:48:14.449962 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:48:14.545903 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:48:14.547905 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:48:14.654250 [info ] [MainThread]: 
[0m11:48:14.657689 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.89 seconds (5.89s).
[0m11:48:14.662198 [debug] [MainThread]: Command end result
[0m11:48:14.689113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:48:14.692144 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:48:14.698923 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:48:14.699923 [info ] [MainThread]: 
[0m11:48:14.700891 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:48:14.700891 [info ] [MainThread]: 
[0m11:48:14.701892 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 22 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:48:14.703109 [info ] [MainThread]: 
[0m11:48:14.704163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:48:14.706108 [debug] [MainThread]: Command `dbt build` failed at 11:48:14.706108 after 9.52 seconds
[0m11:48:14.707145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306BDF8C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306BDF98E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306BEB87A0>]}
[0m11:48:14.707145 [debug] [MainThread]: Flushing usage events
[0m11:48:16.124437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:23.105467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C6CE6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C955E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C955F4D0>]}


============================== 11:48:23.111532 | b6e780f9-6ba2-4f87-b8ce-6716b68a19d1 ==============================
[0m11:48:23.111532 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:48:23.112674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:48:23.681381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6e780f9-6ba2-4f87-b8ce-6716b68a19d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CB7EE690>]}
[0m11:48:23.754746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6e780f9-6ba2-4f87-b8ce-6716b68a19d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C64A9CD0>]}
[0m11:48:23.756713 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:48:24.224555 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:48:24.445839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:24.445839 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:48:24.760913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6e780f9-6ba2-4f87-b8ce-6716b68a19d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CBC08500>]}
[0m11:48:24.837644 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:48:24.842682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:48:24.897313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6e780f9-6ba2-4f87-b8ce-6716b68a19d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CBDFF9B0>]}
[0m11:48:24.897313 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:48:24.899859 [info ] [MainThread]: 
[0m11:48:24.900862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:24.901824 [info ] [MainThread]: 
[0m11:48:24.901824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:24.903818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:48:25.020052 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:48:25.021054 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:48:25.021054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:25.658025 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.637 seconds
[0m11:48:25.665395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:48:25.721444 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:48:25.722450 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:48:25.722450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:26.332979 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.610 seconds
[0m11:48:26.343737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6e780f9-6ba2-4f87-b8ce-6716b68a19d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CBCFC590>]}
[0m11:48:26.349183 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:48:26.350392 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:48:26.351364 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:48:26.351364 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:48:26.360792 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:48:26.361793 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:48:26.400249 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:48:26.403249 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:48:26.403249 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT DISTINCT payment_month,
           COUNT(DISTINCT CASE WHEN payment_month = first_purchase_date THEN customer_id END) AS new_customers,
           COUNT(DISTINCT CASE WHEN payment_month > last_purchase_date THEN customer_id END) AS churned_customers
    FROM customer_purchase_dates
    GROUP BY payment_month
)
SELECT payment_month, new_customers, churned_customers
FROM monthly_status
ORDER BY payment_month
        );
[0m11:48:26.404250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:48:27.450266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.045 seconds
[0m11:48:27.478109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6e780f9-6ba2-4f87-b8ce-6716b68a19d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C8F144D0>]}
[0m11:48:27.479116 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.12s]
[0m11:48:27.479547 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:48:27.481554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:27.481554 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:48:27.482587 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:48:27.581728 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:48:27.583663 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:48:27.701520 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:48:27.702709 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:48:27.804466 [info ] [MainThread]: 
[0m11:48:27.805738 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m11:48:27.807740 [debug] [MainThread]: Command end result
[0m11:48:27.831336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:48:27.835455 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:48:27.842531 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:48:27.843507 [info ] [MainThread]: 
[0m11:48:27.844494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:27.845499 [info ] [MainThread]: 
[0m11:48:27.845499 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:48:27.847708 [debug] [MainThread]: Command `dbt build` succeeded at 11:48:27.847708 after 4.93 seconds
[0m11:48:27.847708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C77E7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CBC5F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CBDFFE30>]}
[0m11:48:27.848700 [debug] [MainThread]: Flushing usage events
[0m11:48:28.807281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:17.460933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E15EC7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E15EC77A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E15EC7560>]}


============================== 11:54:17.466187 | 630c6636-4ed4-4034-91a9-fcafb4b28a95 ==============================
[0m11:54:17.466187 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:54:17.467315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m11:54:18.046201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '630c6636-4ed4-4034-91a9-fcafb4b28a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E19E9E600>]}
[0m11:54:18.117530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '630c6636-4ed4-4034-91a9-fcafb4b28a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E189C4D40>]}
[0m11:54:18.119530 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:54:18.600474 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:54:18.811124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:54:18.812109 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:54:19.119269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '630c6636-4ed4-4034-91a9-fcafb4b28a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E1A4059D0>]}
[0m11:54:19.208516 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:54:19.213605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:54:19.266255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '630c6636-4ed4-4034-91a9-fcafb4b28a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E1A4DFAD0>]}
[0m11:54:19.267223 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:54:19.269255 [info ] [MainThread]: 
[0m11:54:19.270467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:19.270467 [info ] [MainThread]: 
[0m11:54:19.271473 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:19.272477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:54:19.392122 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:54:19.393123 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:54:19.393123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:20.420300 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.027 seconds
[0m11:54:20.427163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:54:20.483229 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:54:20.484236 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:54:20.484236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:20.885336 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.400 seconds
[0m11:54:20.890882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '630c6636-4ed4-4034-91a9-fcafb4b28a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E1A9E9910>]}
[0m11:54:20.895518 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:54:20.896554 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:54:20.897520 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:54:20.897520 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:54:20.905576 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:54:20.906542 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:54:20.942471 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:54:20.945471 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:54:20.945471 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           COUNT(DISTINCT CASE WHEN payment_month = first_purchase_date THEN customer_id END) AS new_customers,
           COUNT(DISTINCT CASE WHEN payment_month = last_purchase_date THEN customer_id END) AS churned_customers
    FROM customer_purchase_dates
    GROUP BY payment_month
)
SELECT payment_month, new_customers, churned_customers
FROM monthly_status
ORDER BY payment_month;
[0m11:54:20.945471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:54:21.279009 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff20-0000-e6c6-0008-ed5a0002746a
[0m11:54:21.279009 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 22 unexpected ';'.
[0m11:54:21.283119 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 22 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:54:21.285227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '630c6636-4ed4-4034-91a9-fcafb4b28a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E175E42F0>]}
[0m11:54:21.286225 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.39s]
[0m11:54:21.287231 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:54:21.288266 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 22 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m11:54:21.289519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:21.290559 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:54:21.290559 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:54:21.627785 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:54:21.628223 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:54:21.734266 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:54:21.736523 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:54:21.840806 [info ] [MainThread]: 
[0m11:54:21.842800 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m11:54:21.855606 [debug] [MainThread]: Command end result
[0m11:54:21.883598 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:54:21.886552 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:54:21.894099 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:54:21.895066 [info ] [MainThread]: 
[0m11:54:21.895820 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:54:21.896827 [info ] [MainThread]: 
[0m11:54:21.897866 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 22 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:54:21.898372 [info ] [MainThread]: 
[0m11:54:21.899380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:54:21.900412 [debug] [MainThread]: Command `dbt build` failed at 11:54:21.900412 after 4.64 seconds
[0m11:54:21.900412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E17971BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E17F4B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E1A10E4B0>]}
[0m11:54:21.901413 [debug] [MainThread]: Flushing usage events
[0m11:54:22.890609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:30.528056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C744FDAF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7432A1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C744FDA2A0>]}


============================== 11:54:30.533190 | d457b182-c9b6-41e3-bb3a-3fe651e5eb5e ==============================
[0m11:54:30.533190 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:54:30.534196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:31.085763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd457b182-c9b6-41e3-bb3a-3fe651e5eb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74693E690>]}
[0m11:54:31.154951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd457b182-c9b6-41e3-bb3a-3fe651e5eb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C744C13D40>]}
[0m11:54:31.156915 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:54:31.598730 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:54:31.795574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:54:31.796741 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:54:32.089972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd457b182-c9b6-41e3-bb3a-3fe651e5eb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C747E75370>]}
[0m11:54:32.163673 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:54:32.167820 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:54:32.221103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd457b182-c9b6-41e3-bb3a-3fe651e5eb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7468EB470>]}
[0m11:54:32.222070 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:54:32.224302 [info ] [MainThread]: 
[0m11:54:32.225293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:32.226256 [info ] [MainThread]: 
[0m11:54:32.227255 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:32.228344 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:54:32.345524 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:54:32.346534 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:54:32.346534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:32.903624 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.557 seconds
[0m11:54:32.909782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:54:32.967344 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:54:32.967344 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:54:32.968342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:33.361743 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.393 seconds
[0m11:54:33.366919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd457b182-c9b6-41e3-bb3a-3fe651e5eb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C747F53920>]}
[0m11:54:33.372000 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:54:33.372000 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:54:33.373024 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:54:33.374024 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:54:33.381405 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:54:33.383370 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:54:33.419981 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:54:33.421949 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:54:33.422982 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           COUNT(DISTINCT CASE WHEN payment_month = first_purchase_date THEN customer_id END) AS new_customers,
           COUNT(DISTINCT CASE WHEN payment_month = last_purchase_date THEN customer_id END) AS churned_customers
    FROM customer_purchase_dates
    GROUP BY payment_month
)
SELECT payment_month, new_customers, churned_customers
FROM monthly_status
ORDER BY payment_month
        );
[0m11:54:33.422982 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:54:33.799081 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff20-0000-e677-0008-ed5a0002159a
[0m11:54:33.799081 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'TRANSACTIONS' does not exist or not authorized.
[0m11:54:33.803317 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:54:33.806007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd457b182-c9b6-41e3-bb3a-3fe651e5eb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C745034920>]}
[0m11:54:33.807015 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.43s]
[0m11:54:33.808014 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:54:33.809243 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m11:54:33.810292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:33.811279 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:54:33.811279 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:54:33.907341 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:54:33.909342 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:54:33.997500 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:54:33.999511 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:54:34.091476 [info ] [MainThread]: 
[0m11:54:34.092727 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m11:54:34.094723 [debug] [MainThread]: Command end result
[0m11:54:34.122622 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:54:34.124667 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:54:34.132905 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:54:34.135934 [info ] [MainThread]: 
[0m11:54:34.136907 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:54:34.137906 [info ] [MainThread]: 
[0m11:54:34.138908 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:54:34.140139 [info ] [MainThread]: 
[0m11:54:34.140560 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:54:34.141568 [debug] [MainThread]: Command `dbt build` failed at 11:54:34.141568 after 3.80 seconds
[0m11:54:34.142600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C744F4D880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C745B9B230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C745B9A7B0>]}
[0m11:54:34.142600 [debug] [MainThread]: Flushing usage events
[0m11:54:35.539911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:03.697411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30DCC12B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30DCC29F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30DCC0E30>]}


============================== 11:55:03.703571 | 60b13b46-168c-45bc-8dfe-f4ddafcdb64b ==============================
[0m11:55:03.703571 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:55:03.704539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m11:55:04.275273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60b13b46-168c-45bc-8dfe-f4ddafcdb64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30EDE2CF0>]}
[0m11:55:04.346324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60b13b46-168c-45bc-8dfe-f4ddafcdb64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30E3D1700>]}
[0m11:55:04.348289 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:55:04.795404 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:55:05.000963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:05.001966 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:55:05.306141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60b13b46-168c-45bc-8dfe-f4ddafcdb64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3100778F0>]}
[0m11:55:05.385106 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:55:05.389270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:55:05.440335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60b13b46-168c-45bc-8dfe-f4ddafcdb64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3105FF8F0>]}
[0m11:55:05.440335 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:55:05.442371 [info ] [MainThread]: 
[0m11:55:05.443567 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:05.444531 [info ] [MainThread]: 
[0m11:55:05.445574 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:55:05.446539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:55:05.567361 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:55:05.567361 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:55:05.567361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:06.232930 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.665 seconds
[0m11:55:06.240012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:55:06.300204 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:55:06.301203 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:55:06.301203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:06.586007 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.284 seconds
[0m11:55:06.596016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b13b46-168c-45bc-8dfe-f4ddafcdb64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B310B5EC90>]}
[0m11:55:06.606336 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:55:06.606336 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:55:06.608586 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:55:06.608586 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:55:06.618624 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:55:06.620624 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:55:06.660105 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:55:06.662070 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:55:06.663068 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           COUNT(DISTINCT CASE WHEN payment_month = first_purchase_date THEN customer_id END) AS new_customers,
           COUNT(DISTINCT CASE WHEN payment_month = last_purchase_date THEN customer_id END) AS churned_customers
    FROM customer_purchase_dates
    GROUP BY payment_month
)
SELECT payment_month, new_customers, churned_customers
FROM monthly_status
ORDER BY payment_month
        );
[0m11:55:06.664070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:07.807665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.144 seconds
[0m11:55:07.839673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60b13b46-168c-45bc-8dfe-f4ddafcdb64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30B566570>]}
[0m11:55:07.839673 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.23s]
[0m11:55:07.841793 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:55:07.842791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:07.843792 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:55:07.843792 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:55:08.174245 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:55:08.174245 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:55:08.250532 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:55:08.250532 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:55:08.343672 [info ] [MainThread]: 
[0m11:55:08.344641 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m11:55:08.345753 [debug] [MainThread]: Command end result
[0m11:55:08.370739 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:55:08.373853 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:55:08.382446 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:55:08.383478 [info ] [MainThread]: 
[0m11:55:08.384784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:08.385787 [info ] [MainThread]: 
[0m11:55:08.386783 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:55:08.388798 [debug] [MainThread]: Command `dbt build` succeeded at 11:55:08.387784 after 4.88 seconds
[0m11:55:08.388798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30EF3B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30DE55070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3104D3BC0>]}
[0m11:55:08.388798 [debug] [MainThread]: Flushing usage events
[0m11:55:09.357822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:05.981352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B47472F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B68B0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B68B05C0>]}


============================== 11:57:05.986503 | 393d1193-961c-4460-89de-dfc0be0d5b87 ==============================
[0m11:57:05.986503 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:57:05.988590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:57:06.555285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '393d1193-961c-4460-89de-dfc0be0d5b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B6A07BF0>]}
[0m11:57:06.627406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '393d1193-961c-4460-89de-dfc0be0d5b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B6BC9370>]}
[0m11:57:06.629406 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:57:07.071536 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:57:07.267054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:57:07.267054 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:57:07.565004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '393d1193-961c-4460-89de-dfc0be0d5b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B8C89370>]}
[0m11:57:07.639118 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:57:07.644281 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:57:07.697935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '393d1193-961c-4460-89de-dfc0be0d5b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B8D5FF80>]}
[0m11:57:07.697935 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:57:07.701128 [info ] [MainThread]: 
[0m11:57:07.701128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:57:07.702164 [info ] [MainThread]: 
[0m11:57:07.703393 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:57:07.704421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:57:07.822688 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:57:07.822688 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:57:07.822688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:08.586815 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.763 seconds
[0m11:57:08.594421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:57:08.655277 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:57:08.656386 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:57:08.656386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:09.015915 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.359 seconds
[0m11:57:09.020172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '393d1193-961c-4460-89de-dfc0be0d5b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B8C35AC0>]}
[0m11:57:09.025127 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:57:09.026360 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:57:09.027323 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:57:09.027323 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:57:09.035714 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:57:09.037712 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:57:09.074080 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:57:09.076087 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:57:09.077080 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
            customer_id,
           COUNT(DISTINCT CASE WHEN payment_month = first_purchase_date THEN customer_id END) AS new_customers,
           COUNT(DISTINCT CASE WHEN payment_month = last_purchase_date THEN customer_id END) AS churned_customers
    FROM customer_purchase_dates
    GROUP BY payment_month,customer_id
)
SELECT payment_month, new_customers, churned_customers
FROM monthly_status
ORDER BY payment_month
        );
[0m11:57:09.077080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:57:09.898817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m11:57:09.942018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393d1193-961c-4460-89de-dfc0be0d5b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B5E746B0>]}
[0m11:57:09.942985 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 0.91s]
[0m11:57:09.943984 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:57:09.946202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:09.946202 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:57:09.947204 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:57:10.036110 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:57:10.037069 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:57:10.133794 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:57:10.133794 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:57:10.219480 [info ] [MainThread]: 
[0m11:57:10.220650 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m11:57:10.222649 [debug] [MainThread]: Command end result
[0m11:57:10.246894 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:57:10.249892 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:57:10.259011 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:57:10.259011 [info ] [MainThread]: 
[0m11:57:10.260077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:57:10.261011 [info ] [MainThread]: 
[0m11:57:10.262015 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:57:10.263014 [debug] [MainThread]: Command `dbt build` succeeded at 11:57:10.263014 after 4.48 seconds
[0m11:57:10.264043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B68716D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B47472F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5B8BBF3B0>]}
[0m11:57:10.264043 [debug] [MainThread]: Flushing usage events
[0m11:57:11.575398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:17.815145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022181E12D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218426BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221844E0470>]}


============================== 11:58:17.820470 | 3b3f134b-05d7-449d-ab9b-010c71952f51 ==============================
[0m11:58:17.820470 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:58:17.821460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:18.482300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b3f134b-05d7-449d-ab9b-010c71952f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221857AA330>]}
[0m11:58:18.551324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b3f134b-05d7-449d-ab9b-010c71952f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218441EB70>]}
[0m11:58:18.553424 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:58:19.131142 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:58:20.714024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:20.714024 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:58:21.005738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b3f134b-05d7-449d-ab9b-010c71952f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022186E355E0>]}
[0m11:58:21.080381 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:58:21.098087 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:58:21.180896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b3f134b-05d7-449d-ab9b-010c71952f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022186F0FF20>]}
[0m11:58:21.180896 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:58:21.183097 [info ] [MainThread]: 
[0m11:58:21.184090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:21.185063 [info ] [MainThread]: 
[0m11:58:21.185063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:58:21.186980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:58:24.585026 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:58:24.586025 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:58:24.586025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:25.404260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.818 seconds
[0m11:58:25.424055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:58:25.485683 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:58:25.485683 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:58:25.486685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:26.049107 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.562 seconds
[0m11:58:26.060054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b3f134b-05d7-449d-ab9b-010c71952f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022187493B60>]}
[0m11:58:26.070693 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:58:26.071749 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:58:26.073705 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:58:26.074745 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:58:26.085703 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:58:26.087700 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:58:26.127365 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:58:26.130578 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:58:26.131577 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
            customer_id,
           COUNT(DISTINCT CASE WHEN payment_month = first_purchase_date THEN customer_id END) AS new_customers,
           COUNT(DISTINCT CASE WHEN payment_month = last_purchase_date THEN customer_id END) AS churned_customers
    FROM customer_purchase_dates
    GROUP BY payment_month,customer_id
)
SELECT customer_id,payment_month, new_customers, churned_customers
FROM monthly_status
ORDER BY payment_month
group by customer_id
        );
[0m11:58:26.131577 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:26.610487 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff24-0000-e6bd-0008-ed5a000265d6
[0m11:58:26.611489 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 0 unexpected 'group'.
[0m11:58:26.628167 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 0 unexpected 'group'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:58:26.631084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b3f134b-05d7-449d-ab9b-010c71952f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022186B77260>]}
[0m11:58:26.632205 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.56s]
[0m11:58:26.633226 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:58:26.633226 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 0 unexpected 'group'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m11:58:26.635430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:26.635430 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:58:26.636466 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:58:26.734475 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:58:26.735475 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:58:26.837246 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:58:26.837246 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:58:26.917612 [info ] [MainThread]: 
[0m11:58:26.918611 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m11:58:26.920898 [debug] [MainThread]: Command end result
[0m11:58:26.949653 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:58:26.951912 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:58:26.958121 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:58:26.959291 [info ] [MainThread]: 
[0m11:58:26.960290 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:58:26.961114 [info ] [MainThread]: 
[0m11:58:26.962130 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 0 unexpected 'group'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m11:58:26.963138 [info ] [MainThread]: 
[0m11:58:26.964143 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:58:26.965138 [debug] [MainThread]: Command `dbt build` failed at 11:58:26.965138 after 9.38 seconds
[0m11:58:26.966179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221822708F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022186B8DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022186B8E360>]}
[0m11:58:26.966179 [debug] [MainThread]: Flushing usage events
[0m11:58:28.293548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:57.310609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B28FCE01D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B290140320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B291EF2990>]}


============================== 11:58:57.315747 | b261c5f9-bd77-4017-9620-2f6d3229f005 ==============================
[0m11:58:57.315747 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:58:57.316748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:58:57.884640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b261c5f9-bd77-4017-9620-2f6d3229f005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B29373DA30>]}
[0m11:58:57.954264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b261c5f9-bd77-4017-9620-2f6d3229f005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2936CA540>]}
[0m11:58:57.956407 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:58:58.387651 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:58:58.590275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:58.603357 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m11:58:58.895138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b261c5f9-bd77-4017-9620-2f6d3229f005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B294D59640>]}
[0m11:58:58.987689 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:58:58.992832 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:58:59.044867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b261c5f9-bd77-4017-9620-2f6d3229f005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B294D46990>]}
[0m11:58:59.044867 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m11:58:59.047247 [info ] [MainThread]: 
[0m11:58:59.048246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:59.049406 [info ] [MainThread]: 
[0m11:58:59.049944 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:58:59.050986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m11:58:59.170075 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m11:58:59.171074 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m11:58:59.171074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:59.871858 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.701 seconds
[0m11:58:59.878889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m11:58:59.941994 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m11:58:59.941994 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m11:58:59.941994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:00.330705 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.389 seconds
[0m11:59:00.342759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b261c5f9-bd77-4017-9620-2f6d3229f005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B28FE8CC50>]}
[0m11:59:00.359160 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m11:59:00.361160 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m11:59:00.364501 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m11:59:00.365503 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m11:59:00.376013 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m11:59:00.377993 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m11:59:00.415574 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m11:59:00.417541 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m11:59:00.418574 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
            customer_id,
           COUNT(DISTINCT CASE WHEN payment_month = first_purchase_date THEN customer_id END) AS new_customers,
           COUNT(DISTINCT CASE WHEN payment_month = last_purchase_date THEN customer_id END) AS churned_customers
    FROM customer_purchase_dates
    GROUP BY payment_month,customer_id
)
SELECT customer_id,payment_month, new_customers, churned_customers
FROM monthly_status
ORDER BY customer_id
        );
[0m11:59:00.418574 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:59:01.120856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m11:59:01.148509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b261c5f9-bd77-4017-9620-2f6d3229f005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B28FDE6BA0>]}
[0m11:59:01.149516 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 0.78s]
[0m11:59:01.150516 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m11:59:01.151681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:01.152698 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m11:59:01.152698 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m11:59:01.240342 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m11:59:01.241347 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m11:59:01.341253 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m11:59:01.341253 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m11:59:01.434342 [info ] [MainThread]: 
[0m11:59:01.436700 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m11:59:01.441073 [debug] [MainThread]: Command end result
[0m11:59:01.469307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m11:59:01.472276 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m11:59:01.479406 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m11:59:01.479406 [info ] [MainThread]: 
[0m11:59:01.480440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:01.482414 [info ] [MainThread]: 
[0m11:59:01.483425 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:59:01.484457 [debug] [MainThread]: Command `dbt build` succeeded at 11:59:01.484457 after 4.36 seconds
[0m11:59:01.485456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B292670F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2926726F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2921B9A60>]}
[0m11:59:01.485456 [debug] [MainThread]: Flushing usage events
[0m11:59:02.453365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:25.662186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFBB79C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFB272E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFB2714F0>]}


============================== 12:07:25.668302 | 9983694f-6013-4f4a-b184-ad54805d3514 ==============================
[0m12:07:25.668302 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:07:25.669304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:07:26.259362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9983694f-6013-4f4a-b184-ad54805d3514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFB387D40>]}
[0m12:07:26.332200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9983694f-6013-4f4a-b184-ad54805d3514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFD602600>]}
[0m12:07:26.334168 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:07:26.777530 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:07:27.001599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:27.001599 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:07:27.318910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9983694f-6013-4f4a-b184-ad54805d3514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB80399940>]}
[0m12:07:27.398899 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:07:27.404067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:07:27.460024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9983694f-6013-4f4a-b184-ad54805d3514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFFDBF2F0>]}
[0m12:07:27.460988 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:07:27.463177 [info ] [MainThread]: 
[0m12:07:27.464143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:27.464143 [info ] [MainThread]: 
[0m12:07:27.465144 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:27.466258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:07:27.588278 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:07:27.589279 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:07:27.589279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:28.339620 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.750 seconds
[0m12:07:28.346928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:07:28.410448 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:07:28.410448 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:07:28.411412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:28.833015 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.422 seconds
[0m12:07:28.843958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9983694f-6013-4f4a-b184-ad54805d3514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB8027A1E0>]}
[0m12:07:28.857230 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:07:28.858480 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:07:28.860480 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:07:28.861480 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:07:28.875321 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:07:28.877284 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:07:28.916889 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:07:28.922172 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:07:28.923180 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM customer_purchase_dates
),
lm_status AS (
    SELECT payment_month,
           customer_id,
           SUM(is_new_customer) OVER (PARTITION BY payment_month) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY payment_month) AS churned_customers_lm
    FROM monthly_status
),
l3m_status AS (
    SELECT payment_month,
           customer_id,
           SUM(is_new_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
),
ltm_status AS (
    SELECT payment_month,
           customer_id,
           SUM(is_new_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
)
SELECT 
    lm_status.payment_month,
    lm_status.customer_id,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (payment_month, customer_id)
JOIN ltm_status USING (payment_month, customer_id)
ORDER BY payment_month, customer_id
        );
[0m12:07:28.924171 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:07:31.237479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.313 seconds
[0m12:07:31.279184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9983694f-6013-4f4a-b184-ad54805d3514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFD494830>]}
[0m12:07:31.280193 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 2.42s]
[0m12:07:31.280595 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:07:31.282602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:31.282602 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:07:31.283603 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:07:31.373474 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:07:31.374507 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:07:31.469640 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:07:31.469640 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:07:31.936750 [info ] [MainThread]: 
[0m12:07:31.938754 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m12:07:31.940753 [debug] [MainThread]: Command end result
[0m12:07:31.967217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:07:31.970183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:07:31.978183 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:07:31.979185 [info ] [MainThread]: 
[0m12:07:31.980446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:31.980446 [info ] [MainThread]: 
[0m12:07:31.982448 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:07:31.983446 [debug] [MainThread]: Command `dbt build` succeeded at 12:07:31.983446 after 6.55 seconds
[0m12:07:31.984678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFBB79C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFB7001D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFD094980>]}
[0m12:07:31.984678 [debug] [MainThread]: Flushing usage events
[0m12:07:33.042821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:44.182495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276CEDA1A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D23952B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276CEBFA3C0>]}


============================== 12:09:44.188041 | 9e769e92-0c63-48fb-915b-e391d39f44cc ==============================
[0m12:09:44.188041 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:09:44.189048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:09:44.744828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e769e92-0c63-48fb-915b-e391d39f44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D2E92C00>]}
[0m12:09:44.815160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e769e92-0c63-48fb-915b-e391d39f44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D1A1DD60>]}
[0m12:09:44.816671 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:09:45.252340 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:09:45.453619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:09:45.453619 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:09:45.750665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e769e92-0c63-48fb-915b-e391d39f44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D47DD670>]}
[0m12:09:45.825858 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:09:45.829999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:09:45.884984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e769e92-0c63-48fb-915b-e391d39f44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D48AFD40>]}
[0m12:09:45.885974 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:09:45.888045 [info ] [MainThread]: 
[0m12:09:45.889012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:45.889012 [info ] [MainThread]: 
[0m12:09:45.890045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:45.891235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:09:46.011047 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:09:46.011047 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:09:46.012047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:46.762811 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.751 seconds
[0m12:09:46.770164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:09:46.830704 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:09:46.831705 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:09:46.831705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:47.144385 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.313 seconds
[0m12:09:47.156393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e769e92-0c63-48fb-915b-e391d39f44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D44DE8A0>]}
[0m12:09:47.170371 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:09:47.171405 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:09:47.172496 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:09:47.172496 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:09:47.180902 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:09:47.182893 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:09:47.222696 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:09:47.227702 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:09:47.228696 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM customer_purchase_dates
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM monthly_status
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:09:47.228696 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:09:49.600040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.371 seconds
[0m12:09:49.627468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e769e92-0c63-48fb-915b-e391d39f44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D19C4770>]}
[0m12:09:49.628471 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 2.45s]
[0m12:09:49.629556 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:09:49.630556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:49.631591 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:09:49.631591 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:09:49.720821 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:09:49.721808 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:09:49.808401 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:09:49.809400 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:09:49.905714 [info ] [MainThread]: 
[0m12:09:49.908658 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m12:09:49.913193 [debug] [MainThread]: Command end result
[0m12:09:49.953937 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:09:49.957133 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:09:49.964317 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:09:49.965365 [info ] [MainThread]: 
[0m12:09:49.966322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:49.967349 [info ] [MainThread]: 
[0m12:09:49.967349 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:09:49.968573 [debug] [MainThread]: Command `dbt build` succeeded at 12:09:49.968573 after 5.98 seconds
[0m12:09:49.969607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D1D95A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276CFC313D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D48AC890>]}
[0m12:09:49.969607 [debug] [MainThread]: Flushing usage events
[0m12:09:50.972972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:27.903782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028998FDCAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028999142450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899AAF3890>]}


============================== 12:11:27.909559 | 0af1c79f-82da-4aa0-8f91-47fd01e2dcfd ==============================
[0m12:11:27.909559 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:11:27.910564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:28.490177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0af1c79f-82da-4aa0-8f91-47fd01e2dcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899D9920C0>]}
[0m12:11:28.560997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0af1c79f-82da-4aa0-8f91-47fd01e2dcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899D704B00>]}
[0m12:11:28.563061 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:11:28.999463 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:11:29.196652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:29.196652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:29.235914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0af1c79f-82da-4aa0-8f91-47fd01e2dcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899ED85340>]}
[0m12:11:29.314373 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:11:29.318446 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:11:29.370268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0af1c79f-82da-4aa0-8f91-47fd01e2dcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899EEB8FE0>]}
[0m12:11:29.370268 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:11:29.373445 [info ] [MainThread]: 
[0m12:11:29.374444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:29.374444 [info ] [MainThread]: 
[0m12:11:29.375445 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:29.376471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:11:29.505914 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:11:29.506923 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:11:29.506923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:30.298804 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.791 seconds
[0m12:11:30.305183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:11:30.317010 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:11:30.317010 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:11:30.318217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:30.640390 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.323 seconds
[0m12:11:30.643561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af1c79f-82da-4aa0-8f91-47fd01e2dcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899ECF5A60>]}
[0m12:11:30.649888 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:11:30.649888 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:11:30.650922 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:11:30.651888 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:11:30.661275 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:11:30.662376 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:11:30.704401 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:11:30.708403 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:11:30.709419 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM customer_purchase_dates
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM monthly_status
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:11:30.709419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:11:32.637677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.928 seconds
[0m12:11:32.670439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af1c79f-82da-4aa0-8f91-47fd01e2dcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899C2240B0>]}
[0m12:11:32.671447 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 2.02s]
[0m12:11:32.672449 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:11:32.673447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:32.674708 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:11:32.674708 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:11:32.751265 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:11:32.752265 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:11:32.837940 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:11:32.838938 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:11:32.916579 [info ] [MainThread]: 
[0m12:11:32.917544 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m12:11:32.918573 [debug] [MainThread]: Command end result
[0m12:11:32.944022 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:11:32.947419 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:11:32.956419 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:11:32.956419 [info ] [MainThread]: 
[0m12:11:32.957420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:32.958419 [info ] [MainThread]: 
[0m12:11:32.959420 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:11:32.960677 [debug] [MainThread]: Command `dbt build` succeeded at 12:11:32.960677 after 5.26 seconds
[0m12:11:32.960677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899C8CC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899C8CC380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002899C8CF7A0>]}
[0m12:11:32.961700 [debug] [MainThread]: Flushing usage events
[0m12:11:34.311898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:50.359183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8332A5E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A832D05400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A832A8CD70>]}


============================== 12:19:50.364634 | e91b4baa-9dd2-4263-a04d-c7c4b3f11b4b ==============================
[0m12:19:50.364634 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:19:50.365633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:19:51.019420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e91b4baa-9dd2-4263-a04d-c7c4b3f11b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A834016690>]}
[0m12:19:51.090603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e91b4baa-9dd2-4263-a04d-c7c4b3f11b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A832FDA4B0>]}
[0m12:19:51.092887 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:19:51.705625 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:19:53.264760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:53.265759 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:19:53.559873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e91b4baa-9dd2-4263-a04d-c7c4b3f11b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8355D9820>]}
[0m12:19:53.636646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:19:53.654219 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:19:53.732773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e91b4baa-9dd2-4263-a04d-c7c4b3f11b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8356ABB90>]}
[0m12:19:53.733858 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:19:53.735891 [info ] [MainThread]: 
[0m12:19:53.736883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:53.736883 [info ] [MainThread]: 
[0m12:19:53.738012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:19:53.740036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:19:57.106226 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:19:57.107226 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:19:57.107226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:57.975491 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.867 seconds
[0m12:19:57.995256 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:19:58.055789 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:19:58.055789 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:19:58.055789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:58.383244 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.327 seconds
[0m12:19:58.387528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e91b4baa-9dd2-4263-a04d-c7c4b3f11b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A835495070>]}
[0m12:19:58.392141 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:19:58.392141 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:19:58.394229 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:19:58.394229 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:19:58.402546 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:19:58.404532 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:19:58.441632 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:19:58.445812 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:19:58.446812 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
),
churned_customers AS (
    SELECT customer_id,
           payment_month,
           CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM monthly_status
    WHERE payment_month > last_purchase_date
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:19:58.446812 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:19:59.061195 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff39-0000-e6bd-0008-ed5a0002666a
[0m12:19:59.062231 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 37
invalid identifier 'LAST_PURCHASE_DATE'
[0m12:19:59.079933 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 37
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:19:59.082913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e91b4baa-9dd2-4263-a04d-c7c4b3f11b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8354375C0>]}
[0m12:19:59.082913 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.69s]
[0m12:19:59.085037 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:19:59.085037 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 37
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m12:19:59.087035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:59.087035 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:19:59.088170 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:19:59.185636 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:19:59.186635 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:19:59.288158 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:19:59.290164 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:19:59.399576 [info ] [MainThread]: 
[0m12:19:59.401992 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m12:19:59.406371 [debug] [MainThread]: Command end result
[0m12:19:59.441374 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:19:59.444598 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:19:59.453080 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:19:59.453080 [info ] [MainThread]: 
[0m12:19:59.454081 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:19:59.455089 [info ] [MainThread]: 
[0m12:19:59.456124 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 37
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:19:59.456124 [info ] [MainThread]: 
[0m12:19:59.457319 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:19:59.458341 [debug] [MainThread]: Command `dbt build` failed at 12:19:59.458341 after 9.42 seconds
[0m12:19:59.459347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A832AF2B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8356ABB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8355AC080>]}
[0m12:19:59.459347 [debug] [MainThread]: Flushing usage events
[0m12:20:00.505150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:52.512766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003BE5F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003E4B9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003A90CAD0>]}


============================== 12:21:52.518121 | e954c237-b201-4cf8-b7ec-720bb309b377 ==============================
[0m12:21:52.518121 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:21:52.519088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m12:21:53.084733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e954c237-b201-4cf8-b7ec-720bb309b377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003DC70D40>]}
[0m12:21:53.154033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e954c237-b201-4cf8-b7ec-720bb309b377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003F47A600>]}
[0m12:21:53.155999 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:21:53.580136 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:21:53.784055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:53.784055 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:21:54.078548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e954c237-b201-4cf8-b7ec-720bb309b377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200405916A0>]}
[0m12:21:54.152730 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:21:54.156890 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:21:54.209472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e954c237-b201-4cf8-b7ec-720bb309b377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020040B3C860>]}
[0m12:21:54.210605 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:21:54.212792 [info ] [MainThread]: 
[0m12:21:54.213788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:54.215037 [info ] [MainThread]: 
[0m12:21:54.215734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:21:54.217080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:21:54.334303 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:21:54.334303 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:21:54.334303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:55.400323 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.065 seconds
[0m12:21:55.423675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:21:55.488266 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:21:55.488266 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:21:55.489365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:55.876756 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.387 seconds
[0m12:21:55.888033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e954c237-b201-4cf8-b7ec-720bb309b377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020040948650>]}
[0m12:21:55.900188 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:21:55.901202 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:21:55.903202 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:21:55.904463 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:21:55.918552 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:21:55.920520 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:21:55.957625 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:21:55.961624 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:21:55.962623 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
),
churned_customers AS (
    SELECT customer_id,
           payment_month,
           last_purchase_date,
           CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM monthly_status
    WHERE payment_month > last_purchase_date
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:21:55.962623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:21:56.339110 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff3b-0000-e6d0-0008-ed5a00024622
[0m12:21:56.340095 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 11
invalid identifier 'LAST_PURCHASE_DATE'
[0m12:21:56.344200 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 11
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:21:56.346200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e954c237-b201-4cf8-b7ec-720bb309b377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003DC443B0>]}
[0m12:21:56.347277 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.44s]
[0m12:21:56.349277 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:21:56.350277 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 11
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m12:21:56.351500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:56.351500 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:21:56.352533 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:21:56.440942 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:21:56.440942 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:21:56.528688 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:21:56.528688 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:21:56.620823 [info ] [MainThread]: 
[0m12:21:56.620823 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m12:21:56.621823 [debug] [MainThread]: Command end result
[0m12:21:56.648464 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:21:56.651536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:21:56.657835 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:21:56.658830 [info ] [MainThread]: 
[0m12:21:56.659797 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:21:56.660796 [info ] [MainThread]: 
[0m12:21:56.661798 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 11
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:21:56.669310 [info ] [MainThread]: 
[0m12:21:56.670316 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:21:56.671283 [debug] [MainThread]: Command `dbt build` failed at 12:21:56.671283 after 4.37 seconds
[0m12:21:56.672281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003DCCEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003DE75490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003DDFDEB0>]}
[0m12:21:56.672281 [debug] [MainThread]: Flushing usage events
[0m12:21:58.151586 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:22:36.998822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7BE0C65A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C09C99A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C09C87D0>]}


============================== 12:22:37.004631 | 1c20cc30-f23c-4947-ba42-1974b188cd7b ==============================
[0m12:22:37.004631 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:22:37.004631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:37.555916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c20cc30-f23c-4947-ba42-1974b188cd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C0313FE0>]}
[0m12:22:37.624736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c20cc30-f23c-4947-ba42-1974b188cd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C1B56D20>]}
[0m12:22:37.627132 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:22:38.063911 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:22:38.263983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:38.263983 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:22:38.559807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c20cc30-f23c-4947-ba42-1974b188cd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C31198E0>]}
[0m12:22:38.633216 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:22:38.638436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:22:38.691319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c20cc30-f23c-4947-ba42-1974b188cd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C31EE840>]}
[0m12:22:38.691319 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:22:38.693552 [info ] [MainThread]: 
[0m12:22:38.694533 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:38.695516 [info ] [MainThread]: 
[0m12:22:38.695516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:22:38.697703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:22:38.816233 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:22:38.816233 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:22:38.817273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:39.591185 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.774 seconds
[0m12:22:39.598346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:22:39.654966 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:22:39.655964 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:22:39.655964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:40.013606 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.358 seconds
[0m12:22:40.019457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c20cc30-f23c-4947-ba42-1974b188cd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C2FD0620>]}
[0m12:22:40.024741 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:22:40.025789 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:22:40.026742 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:22:40.026742 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:22:40.036255 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:22:40.037252 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:22:40.074086 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:22:40.079188 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:22:40.079188 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           last_purchase_date,
           first_purchase_date,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
),
churned_customers AS (
    SELECT customer_id,
           payment_month,
           last_purchase_date,
           CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM monthly_status
    WHERE payment_month > last_purchase_date
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:22:40.080185 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:22:42.285941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.205 seconds
[0m12:22:42.331911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c20cc30-f23c-4947-ba42-1974b188cd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C02E4080>]}
[0m12:22:42.332418 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 2.30s]
[0m12:22:42.333367 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:22:42.335375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:42.335375 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:22:42.336617 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:22:42.422743 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:22:42.422743 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:22:42.501448 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:22:42.502448 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:22:42.594178 [info ] [MainThread]: 
[0m12:22:42.597434 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m12:22:42.601992 [debug] [MainThread]: Command end result
[0m12:22:42.632054 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:22:42.635019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:22:42.642330 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:22:42.642330 [info ] [MainThread]: 
[0m12:22:42.643297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:42.644297 [info ] [MainThread]: 
[0m12:22:42.645295 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:22:42.646337 [debug] [MainThread]: Command `dbt build` succeeded at 12:22:42.646337 after 5.84 seconds
[0m12:22:42.646337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C0C4B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C0AEDBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C080EE70>]}
[0m12:22:42.647330 [debug] [MainThread]: Flushing usage events
[0m12:22:43.670906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:08.090951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D920B7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D90611F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D93A4C920>]}


============================== 12:24:08.096313 | 4ece9202-9598-4a1e-9b87-ac603daf2382 ==============================
[0m12:24:08.096313 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:24:08.097288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m12:24:08.644080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ece9202-9598-4a1e-9b87-ac603daf2382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9433A2A0>]}
[0m12:24:08.713481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ece9202-9598-4a1e-9b87-ac603daf2382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9510AC60>]}
[0m12:24:08.715553 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:24:09.162393 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:24:09.362616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:09.362616 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:24:09.661063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ece9202-9598-4a1e-9b87-ac603daf2382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D966797F0>]}
[0m12:24:09.736785 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:24:09.741921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:24:09.790118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ece9202-9598-4a1e-9b87-ac603daf2382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9667B080>]}
[0m12:24:09.791236 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:24:09.793234 [info ] [MainThread]: 
[0m12:24:09.794200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:09.795358 [info ] [MainThread]: 
[0m12:24:09.796358 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:09.797357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:24:09.915827 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:24:09.917081 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:24:09.917081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:10.694952 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.777 seconds
[0m12:24:10.701468 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:24:10.757895 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:24:10.758896 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:24:10.758896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:11.154646 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.395 seconds
[0m12:24:11.165581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ece9202-9598-4a1e-9b87-ac603daf2382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9667C0E0>]}
[0m12:24:11.181574 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:24:11.184025 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:24:11.187077 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:24:11.188482 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:24:11.199828 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:24:11.200830 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:24:11.237908 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:24:11.241057 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:24:11.242058 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM customer_purchase_dates
),
lm_status AS (
    SELECT payment_month,
           customer_id,
           SUM(is_new_customer) OVER (PARTITION BY payment_month) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY payment_month) AS churned_customers_lm
    FROM monthly_status
),
l3m_status AS (
    SELECT payment_month,
           customer_id,
           SUM(is_new_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
),
ltm_status AS (
    SELECT payment_month,
           customer_id,
           SUM(is_new_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
)
SELECT 
    lm_status.payment_month,
    lm_status.customer_id,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (payment_month, customer_id)
JOIN ltm_status USING (payment_month, customer_id)
ORDER BY payment_month, customer_id
        );
[0m12:24:11.242058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:24:13.425005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.182 seconds
[0m12:24:13.453782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ece9202-9598-4a1e-9b87-ac603daf2382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D916C6C60>]}
[0m12:24:13.454899 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 2.27s]
[0m12:24:13.455866 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:24:13.457865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:13.457865 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:24:13.457865 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:24:13.549207 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:24:13.550208 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:24:13.631680 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:24:13.631680 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:24:13.726220 [info ] [MainThread]: 
[0m12:24:13.727689 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m12:24:13.729733 [debug] [MainThread]: Command end result
[0m12:24:13.754709 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:24:13.758041 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:24:13.764617 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:24:13.765584 [info ] [MainThread]: 
[0m12:24:13.765584 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:13.766800 [info ] [MainThread]: 
[0m12:24:13.767769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:24:13.768806 [debug] [MainThread]: Command `dbt build` succeeded at 12:24:13.768806 after 5.89 seconds
[0m12:24:13.769795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9377B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D93942960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D93942C00>]}
[0m12:24:13.769795 [debug] [MainThread]: Flushing usage events
[0m12:24:15.090869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:17.790554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230031F61B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300506D5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230031F73E0>]}


============================== 12:40:17.800703 | dc8db8b4-1aee-4dd2-902f-a9ef833e90bb ==============================
[0m12:40:17.800703 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:40:17.801672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:18.738461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc8db8b4-1aee-4dd2-902f-a9ef833e90bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023004CE7FB0>]}
[0m12:40:18.808096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc8db8b4-1aee-4dd2-902f-a9ef833e90bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023004DCFBF0>]}
[0m12:40:18.810064 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:40:19.574155 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:40:21.197922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:21.197922 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:40:21.511276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc8db8b4-1aee-4dd2-902f-a9ef833e90bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023007769700>]}
[0m12:40:21.588383 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:40:21.608513 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:40:21.727476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc8db8b4-1aee-4dd2-902f-a9ef833e90bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300783BBF0>]}
[0m12:40:21.727476 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:40:21.731537 [info ] [MainThread]: 
[0m12:40:21.732330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:21.732330 [info ] [MainThread]: 
[0m12:40:21.733371 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:21.734371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:40:25.489487 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:40:25.490487 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:40:25.490487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:26.471400 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.981 seconds
[0m12:40:26.478399 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:40:26.536242 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:40:26.537244 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:40:26.537244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:26.997435 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.460 seconds
[0m12:40:27.001468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc8db8b4-1aee-4dd2-902f-a9ef833e90bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300760D0A0>]}
[0m12:40:27.019793 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:40:27.019793 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:40:27.021944 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:40:27.021944 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:40:27.030273 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:40:27.032254 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:40:27.072520 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:40:27.076514 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:40:27.077514 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM customer_purchase_dates
),
lm_status AS (
    SELECT payment_month,
           customer_id,
           SUM(is_new_customer) OVER (PARTITION BY payment_month) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY payment_month) AS churned_customers_lm
    FROM monthly_status
),
l3m_status AS (
    SELECT payment_month,
           customer_id,
           SUM(is_new_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
),
ltm_status AS (
    SELECT payment_month,
           customer_id,
           SUM(is_new_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY payment_month ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
)
SELECT 
    lm_status.payment_month,
    lm_status.customer_id,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (payment_month, customer_id)
JOIN ltm_status USING (payment_month, customer_id)
ORDER BY payment_month
        );
[0m12:40:27.077514 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:30.564701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.487 seconds
[0m12:40:30.593696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc8db8b4-1aee-4dd2-902f-a9ef833e90bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002816A80>]}
[0m12:40:30.594695 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 3.57s]
[0m12:40:30.594695 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:40:30.596891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:30.596891 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:40:30.597913 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:40:30.698087 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:40:30.699089 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:40:30.801914 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:40:30.803922 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:40:30.898308 [info ] [MainThread]: 
[0m12:40:30.898308 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.16 seconds (9.16s).
[0m12:40:30.899262 [debug] [MainThread]: Command end result
[0m12:40:30.927587 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:40:30.929616 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:40:30.936616 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:40:30.936616 [info ] [MainThread]: 
[0m12:40:30.937619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:30.938622 [info ] [MainThread]: 
[0m12:40:30.938622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:30.940584 [debug] [MainThread]: Command `dbt build` succeeded at 12:40:30.939584 after 13.51 seconds
[0m12:40:30.940584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230053487A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023005348800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300601EE70>]}
[0m12:40:30.940584 [debug] [MainThread]: Flushing usage events
[0m12:40:32.019043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:37.904681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADBA328D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD9852D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADBA058B0>]}


============================== 12:44:37.910950 | c483edbf-3bc8-4a16-8507-6c282114d0d3 ==============================
[0m12:44:37.910950 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:44:37.911917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:44:38.545576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c483edbf-3bc8-4a16-8507-6c282114d0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADCE50800>]}
[0m12:44:38.614451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c483edbf-3bc8-4a16-8507-6c282114d0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADCF54440>]}
[0m12:44:38.616511 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:44:39.180516 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:44:40.729263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:40.730264 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:44:41.022005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c483edbf-3bc8-4a16-8507-6c282114d0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADE89D4C0>]}
[0m12:44:41.098238 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:44:41.115644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:44:41.196560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c483edbf-3bc8-4a16-8507-6c282114d0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADE96FD40>]}
[0m12:44:41.197592 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:44:41.199154 [info ] [MainThread]: 
[0m12:44:41.200299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:41.201308 [info ] [MainThread]: 
[0m12:44:41.201308 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:41.203430 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:44:44.571091 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:44:44.571091 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:44:44.572091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:46.069690 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.498 seconds
[0m12:44:46.093242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:44:46.159278 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:44:46.160281 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:44:46.160281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:46.500460 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.340 seconds
[0m12:44:46.503454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c483edbf-3bc8-4a16-8507-6c282114d0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADE87ABA0>]}
[0m12:44:46.508423 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:44:46.508423 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:44:46.510423 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:44:46.510423 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:44:46.519667 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:44:46.520684 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:44:46.556689 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:44:46.561913 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:44:46.561913 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
),
churned_customers AS (
    SELECT customer_id,
           payment_month,
           CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM monthly_status
    WHERE payment_month > last_purchase_date
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:44:46.562875 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:47.123677 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff52-0000-e6d0-0008-ed5a0002467e
[0m12:44:47.123677 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 37
invalid identifier 'LAST_PURCHASE_DATE'
[0m12:44:47.141689 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 37
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:44:47.144655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c483edbf-3bc8-4a16-8507-6c282114d0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADBA642F0>]}
[0m12:44:47.145872 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.63s]
[0m12:44:47.146387 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:44:47.147428 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 37
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m12:44:47.149428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:47.149428 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:44:47.149428 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:44:47.216938 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:44:47.216938 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:44:47.300763 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:44:47.302829 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:44:47.371985 [info ] [MainThread]: 
[0m12:44:47.372952 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m12:44:47.374522 [debug] [MainThread]: Command end result
[0m12:44:47.399739 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:44:47.403007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:44:47.409222 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:44:47.410184 [info ] [MainThread]: 
[0m12:44:47.411338 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:44:47.412040 [info ] [MainThread]: 
[0m12:44:47.413048 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 37
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:44:47.414047 [info ] [MainThread]: 
[0m12:44:47.415048 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:44:47.416490 [debug] [MainThread]: Command `dbt build` failed at 12:44:47.416490 after 9.78 seconds
[0m12:44:47.417525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADC265730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADC431940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ADC4314F0>]}
[0m12:44:47.417525 [debug] [MainThread]: Flushing usage events
[0m12:44:48.690139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:46.431475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0CE1A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0CE189B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0CE1AF30>]}


============================== 12:45:46.436733 | d39257ba-0c0d-41b1-9e81-1fd86e2263f1 ==============================
[0m12:45:46.436733 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:45:46.437856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:45:46.980268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd39257ba-0c0d-41b1-9e81-1fd86e2263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0DB26F30>]}
[0m12:45:47.049385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd39257ba-0c0d-41b1-9e81-1fd86e2263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0C78E060>]}
[0m12:45:47.051375 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:45:47.483064 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:45:47.683302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:47.683302 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:45:47.981739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd39257ba-0c0d-41b1-9e81-1fd86e2263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0EFA64E0>]}
[0m12:45:48.057946 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:45:48.062141 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:45:48.115665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd39257ba-0c0d-41b1-9e81-1fd86e2263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0F1BBFE0>]}
[0m12:45:48.116695 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:45:48.118824 [info ] [MainThread]: 
[0m12:45:48.119597 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:48.120643 [info ] [MainThread]: 
[0m12:45:48.120643 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:48.122850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:45:48.241392 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:45:48.242393 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:45:48.242393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:49.005633 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.763 seconds
[0m12:45:49.012984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:45:49.071612 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:45:49.071612 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:45:49.071612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:49.368842 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.297 seconds
[0m12:45:49.380392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd39257ba-0c0d-41b1-9e81-1fd86e2263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0F09E570>]}
[0m12:45:49.395782 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:45:49.397834 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:45:49.401117 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:45:49.403403 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:45:49.414644 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:45:49.415792 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:45:49.451926 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:45:49.456028 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:45:49.457151 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           last_purchase_date,
           first_purchase_date,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
),
churned_customers AS (
    SELECT customer_id,
           payment_month,
           last_purchase_date,
           first_purchase_date,
           CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM monthly_status
    WHERE payment_month > last_purchase_date
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM monthly_status
    LEFT JOIN churned_customers USING (customer_id, payment_month)
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:45:49.458150 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:51.700587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.242 seconds
[0m12:45:51.731291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39257ba-0c0d-41b1-9e81-1fd86e2263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0A1C6930>]}
[0m12:45:51.732288 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 2.33s]
[0m12:45:51.733123 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:45:51.735128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:51.735128 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:45:51.736127 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:45:51.810440 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:45:51.810440 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:45:51.883019 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:45:51.884053 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:45:51.964186 [info ] [MainThread]: 
[0m12:45:51.965186 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m12:45:51.966369 [debug] [MainThread]: Command end result
[0m12:45:51.990006 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:45:51.993209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:45:52.001549 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:45:52.001549 [info ] [MainThread]: 
[0m12:45:52.002829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:52.003837 [info ] [MainThread]: 
[0m12:45:52.003837 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:52.004869 [debug] [MainThread]: Command `dbt build` succeeded at 12:45:52.004869 after 5.78 seconds
[0m12:45:52.006102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0C665130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0C667A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0C667FB0>]}
[0m12:45:52.006102 [debug] [MainThread]: Flushing usage events
[0m12:45:53.473847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:55.700806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F688F4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F66190770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F67F510A0>]}


============================== 12:47:55.705921 | 21d2c10d-535d-46d3-9d15-6a01b47aab9d ==============================
[0m12:47:55.705921 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:47:55.706924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:56.257636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21d2c10d-535d-46d3-9d15-6a01b47aab9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F69566F30>]}
[0m12:47:56.327035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21d2c10d-535d-46d3-9d15-6a01b47aab9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F6A7CCA70>]}
[0m12:47:56.328980 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:47:56.765610 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:47:56.975669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:56.976854 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:47:57.272363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21d2c10d-535d-46d3-9d15-6a01b47aab9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F6AD39940>]}
[0m12:47:57.348976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:47:57.353076 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:47:57.404573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21d2c10d-535d-46d3-9d15-6a01b47aab9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F6ACEDD60>]}
[0m12:47:57.405793 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:47:57.407481 [info ] [MainThread]: 
[0m12:47:57.408480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:57.409490 [info ] [MainThread]: 
[0m12:47:57.410674 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:57.411889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:47:57.532776 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:47:57.532776 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:47:57.532776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:58.279957 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.747 seconds
[0m12:47:58.287241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:47:58.345266 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:47:58.345266 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:47:58.345266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:58.705071 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.359 seconds
[0m12:47:58.710175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d2c10d-535d-46d3-9d15-6a01b47aab9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F6AD3B080>]}
[0m12:47:58.714883 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:47:58.715916 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:47:58.716882 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:47:58.716882 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:47:58.726602 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:47:58.728613 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:47:58.764239 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:47:58.766241 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:47:58.767238 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (-- Step 1: Check Filtered Transactions
WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
)
SELECT * FROM filtered_transactions

-- -- Step 2: Check Customer Purchase Dates
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- )
-- SELECT * FROM customer_purchase_dates

-- -- Step 3: Check Monthly Status
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- ),
-- monthly_status AS (
--     SELECT payment_month,
--            customer_id,
--            CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
--            CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
--     FROM customer_purchase_dates
-- )
-- SELECT * FROM monthly_status

-- -- Step 4: Check Churned Customers
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- ),
-- monthly_status AS (
--     SELECT payment_month,
--            customer_id,
--            CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
--            CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
--     FROM customer_purchase_dates
-- ),
-- churned_customers AS (
--     SELECT customer_id,
--            payment_month,
--            CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
--     FROM monthly_status
--     WHERE payment_month > last_purchase_date
-- )
-- SELECT * FROM churned_customers
        );
[0m12:47:58.767238 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:59.550720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m12:47:59.579692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21d2c10d-535d-46d3-9d15-6a01b47aab9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F65E16B70>]}
[0m12:47:59.580700 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 0.86s]
[0m12:47:59.581699 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:47:59.582802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:59.582802 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:47:59.584295 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:47:59.662327 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:47:59.664331 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:47:59.769545 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:47:59.770739 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:47:59.841396 [info ] [MainThread]: 
[0m12:47:59.843350 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m12:47:59.845548 [debug] [MainThread]: Command end result
[0m12:47:59.883284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:47:59.886467 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:47:59.893956 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:47:59.895113 [info ] [MainThread]: 
[0m12:47:59.895113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:59.896082 [info ] [MainThread]: 
[0m12:47:59.897117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:47:59.898078 [debug] [MainThread]: Command `dbt build` succeeded at 12:47:59.898078 after 4.47 seconds
[0m12:47:59.899246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F65C34320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F6872B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F6ACEDC10>]}
[0m12:47:59.899246 [debug] [MainThread]: Flushing usage events
[0m12:48:00.878936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:47.579553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2303A7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2303A7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E23217D550>]}


============================== 12:48:47.585302 | 1dd23837-2c74-4e0d-84a0-02dd444940da ==============================
[0m12:48:47.585302 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:47.586480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m12:48:48.135306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dd23837-2c74-4e0d-84a0-02dd444940da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E23217E480>]}
[0m12:48:48.205158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dd23837-2c74-4e0d-84a0-02dd444940da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2330AE1B0>]}
[0m12:48:48.207359 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:48:48.645265 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:48:48.843947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:48:48.844949 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:48:49.143117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dd23837-2c74-4e0d-84a0-02dd444940da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2330E30E0>]}
[0m12:48:49.219817 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:48:49.223621 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:48:49.271932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dd23837-2c74-4e0d-84a0-02dd444940da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E234A4FFB0>]}
[0m12:48:49.271932 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:48:49.274492 [info ] [MainThread]: 
[0m12:48:49.275493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:49.276462 [info ] [MainThread]: 
[0m12:48:49.276462 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:49.278425 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:48:49.397408 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:48:49.397408 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:48:49.397408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:50.149607 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.751 seconds
[0m12:48:50.155790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:48:50.213602 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:48:50.213602 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:48:50.214603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:50.531450 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.317 seconds
[0m12:48:50.535441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd23837-2c74-4e0d-84a0-02dd444940da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2346C1820>]}
[0m12:48:50.540440 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:48:50.541654 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:48:50.542556 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:48:50.543599 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:48:50.552564 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:48:50.554564 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:48:50.610313 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:48:50.614311 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:48:50.615312 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (-- Step 1: Check Filtered Transactions
WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
)
SELECT * FROM filtered_transactions

-- Step 2: Check Customer Purchase Dates
WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
)
SELECT * FROM customer_purchase_dates

-- -- Step 3: Check Monthly Status
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- ),
-- monthly_status AS (
--     SELECT payment_month,
--            customer_id,
--            CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
--            CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
--     FROM customer_purchase_dates
-- )
-- SELECT * FROM monthly_status

-- -- Step 4: Check Churned Customers
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- ),
-- monthly_status AS (
--     SELECT payment_month,
--            customer_id,
--            CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
--            CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
--     FROM customer_purchase_dates
-- ),
-- churned_customers AS (
--     SELECT customer_id,
--            payment_month,
--            CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
--     FROM monthly_status
--     WHERE payment_month > last_purchase_date
-- )
-- SELECT * FROM churned_customers
        );
[0m12:48:50.615312 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:50.913113 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff56-0000-e70c-0008-ed5a0002904a
[0m12:48:50.914113 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'WITH'.
syntax error line 18 at position 4 unexpected 'FROM'.
syntax error line 20 at position 1 unexpected ','.
[0m12:48:50.918399 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 18 at position 4 unexpected 'FROM'.
  syntax error line 20 at position 1 unexpected ','.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:48:50.921617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd23837-2c74-4e0d-84a0-02dd444940da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E231AD46E0>]}
[0m12:48:50.922607 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.38s]
[0m12:48:50.923180 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:48:50.924276 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 18 at position 4 unexpected 'FROM'.
  syntax error line 20 at position 1 unexpected ','.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m12:48:50.926288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:50.927296 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:48:50.927296 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:48:50.993856 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:48:50.993856 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:48:51.065141 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:48:51.067463 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:48:51.172495 [info ] [MainThread]: 
[0m12:48:51.175016 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m12:48:51.179494 [debug] [MainThread]: Command end result
[0m12:48:51.217724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:48:51.220992 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:48:51.227989 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:48:51.227989 [info ] [MainThread]: 
[0m12:48:51.229966 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:48:51.229966 [info ] [MainThread]: 
[0m12:48:51.231397 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 18 at position 4 unexpected 'FROM'.
  syntax error line 20 at position 1 unexpected ','.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:48:51.232408 [info ] [MainThread]: 
[0m12:48:51.233459 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:48:51.234449 [debug] [MainThread]: Command `dbt build` failed at 12:48:51.234449 after 3.84 seconds
[0m12:48:51.234449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E231A7AF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E232262CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E231B02120>]}
[0m12:48:51.235676 [debug] [MainThread]: Flushing usage events
[0m12:48:52.570530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:23.604112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BAB96780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BD728A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BD7287A0>]}


============================== 12:49:23.608561 | a7eb5bf1-4adb-4160-9374-dc3d18064255 ==============================
[0m12:49:23.608561 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:49:23.609700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:49:24.170864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7eb5bf1-4adb-4160-9374-dc3d18064255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BD8D9F10>]}
[0m12:49:24.241318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7eb5bf1-4adb-4160-9374-dc3d18064255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BE2994C0>]}
[0m12:49:24.242321 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:49:24.670102 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:49:24.870083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:24.870083 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:49:25.162349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7eb5bf1-4adb-4160-9374-dc3d18064255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BFC39670>]}
[0m12:49:25.237540 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:49:25.242755 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:49:25.294571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7eb5bf1-4adb-4160-9374-dc3d18064255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BFD0FD10>]}
[0m12:49:25.295715 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:49:25.297239 [info ] [MainThread]: 
[0m12:49:25.298239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:25.299515 [info ] [MainThread]: 
[0m12:49:25.299515 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:25.301514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:49:25.420976 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:49:25.420976 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:49:25.421976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:26.066504 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.645 seconds
[0m12:49:26.073815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:49:26.130393 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:49:26.131587 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:49:26.131587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:26.440301 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.309 seconds
[0m12:49:26.443631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7eb5bf1-4adb-4160-9374-dc3d18064255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BFD0FEC0>]}
[0m12:49:26.448828 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:49:26.449782 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:49:26.450964 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:49:26.451932 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:49:26.462437 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:49:26.464413 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:49:26.502459 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:49:26.504451 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:49:26.505420 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (-- Step 1: Check Filtered Transactions
WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),


-- Step 2: Check Customer Purchase Dates
WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
)
SELECT * FROM customer_purchase_dates

-- -- Step 3: Check Monthly Status
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- ),
-- monthly_status AS (
--     SELECT payment_month,
--            customer_id,
--            CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
--            CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
--     FROM customer_purchase_dates
-- )
-- SELECT * FROM monthly_status

-- -- Step 4: Check Churned Customers
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- ),
-- monthly_status AS (
--     SELECT payment_month,
--            customer_id,
--            CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
--            CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
--     FROM customer_purchase_dates
-- ),
-- churned_customers AS (
--     SELECT customer_id,
--            payment_month,
--            CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
--     FROM monthly_status
--     WHERE payment_month > last_purchase_date
-- )
-- SELECT * FROM churned_customers
        );
[0m12:49:26.505420 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:26.831168 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff57-0000-e658-0008-ed5a0001668a
[0m12:49:26.832202 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'WITH'.
[0m12:49:26.836168 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:49:26.839166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7eb5bf1-4adb-4160-9374-dc3d18064255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BD92A8A0>]}
[0m12:49:26.839166 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.39s]
[0m12:49:26.841182 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:49:26.842168 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m12:49:26.843192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:26.844193 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:49:26.844193 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:49:26.909713 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:49:26.910715 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:49:26.981984 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:49:26.981984 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:49:27.059567 [info ] [MainThread]: 
[0m12:49:27.060544 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m12:49:27.061534 [debug] [MainThread]: Command end result
[0m12:49:27.087234 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:49:27.090570 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:49:27.099062 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:49:27.099062 [info ] [MainThread]: 
[0m12:49:27.100102 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:49:27.101065 [info ] [MainThread]: 
[0m12:49:27.102097 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:49:27.103067 [info ] [MainThread]: 
[0m12:49:27.104073 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:49:27.105065 [debug] [MainThread]: Command `dbt build` failed at 12:49:27.105065 after 3.69 seconds
[0m12:49:27.106240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BAA9BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BAA9A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226B7AA0DD0>]}
[0m12:49:27.106240 [debug] [MainThread]: Flushing usage events
[0m12:49:28.020414 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:47.816245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0F753770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0F753470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0F753410>]}


============================== 12:49:47.821391 | 1e3a597b-4583-4b09-95f3-d65a4bdff3c5 ==============================
[0m12:49:47.821391 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:49:47.822388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:49:48.384702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e3a597b-4583-4b09-95f3-d65a4bdff3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A11984AA0>]}
[0m12:49:48.456679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e3a597b-4583-4b09-95f3-d65a4bdff3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A1110A270>]}
[0m12:49:48.458644 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:49:48.906304 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:49:49.112975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:49.113977 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:49:49.415652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e3a597b-4583-4b09-95f3-d65a4bdff3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A138176E0>]}
[0m12:49:49.492330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:49:49.496560 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:49:49.547377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e3a597b-4583-4b09-95f3-d65a4bdff3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A13CC6C00>]}
[0m12:49:49.547377 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:49:49.550590 [info ] [MainThread]: 
[0m12:49:49.551556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:49.551556 [info ] [MainThread]: 
[0m12:49:49.552715 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:49.553715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:49:49.675405 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:49:49.675405 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:49:49.675405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:50.414250 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.739 seconds
[0m12:49:50.422614 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:49:50.485519 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:49:50.486555 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:49:50.486555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:50.798019 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.311 seconds
[0m12:49:50.801183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e3a597b-4583-4b09-95f3-d65a4bdff3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A1417CB60>]}
[0m12:49:50.806327 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:49:50.807336 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:49:50.808421 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:49:50.808421 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:49:50.819830 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:49:50.822835 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:49:50.858448 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:49:50.860414 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:49:50.861414 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (-- -- Step 1: Check Filtered Transactions
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- )
-- SELECT * FROM filtered_transactions

-- Step 2: Check Customer Purchase Dates
WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
)
SELECT * FROM customer_purchase_dates

-- -- Step 3: Check Monthly Status
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- ),
-- monthly_status AS (
--     SELECT payment_month,
--            customer_id,
--            CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
--            CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
--     FROM customer_purchase_dates
-- )
-- SELECT * FROM monthly_status

-- -- Step 4: Check Churned Customers
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- ),
-- monthly_status AS (
--     SELECT payment_month,
--            customer_id,
--            CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
--            CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
--     FROM customer_purchase_dates
-- ),
-- churned_customers AS (
--     SELECT customer_id,
--            payment_month,
--            CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
--     FROM monthly_status
--     WHERE payment_month > last_purchase_date
-- )
-- SELECT * FROM churned_customers
        );
[0m12:49:50.862448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:51.721221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m12:49:51.749194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3a597b-4583-4b09-95f3-d65a4bdff3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A10E74650>]}
[0m12:49:51.750162 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 0.94s]
[0m12:49:51.751162 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:49:51.752341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:51.753339 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:49:51.753339 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:49:51.832197 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:49:51.833194 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:49:51.902899 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:49:51.902899 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:49:51.969884 [info ] [MainThread]: 
[0m12:49:51.970884 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m12:49:51.973058 [debug] [MainThread]: Command end result
[0m12:49:51.996871 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:49:52.000067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:49:52.009053 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:49:52.009053 [info ] [MainThread]: 
[0m12:49:52.011052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:52.011052 [info ] [MainThread]: 
[0m12:49:52.012087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:49:52.013290 [debug] [MainThread]: Command `dbt build` succeeded at 12:49:52.013290 after 4.39 seconds
[0m12:49:52.014312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A10D812B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A13CD0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A11870680>]}
[0m12:49:52.014312 [debug] [MainThread]: Flushing usage events
[0m12:49:52.984123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:30.200441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3C84DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3CCF4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3BEDE600>]}


============================== 12:50:30.206794 | f912df23-5a8e-4558-9479-7ca62b5446b7 ==============================
[0m12:50:30.206794 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:50:30.207349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:30.764958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f912df23-5a8e-4558-9479-7ca62b5446b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3CE3A930>]}
[0m12:50:30.836659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f912df23-5a8e-4558-9479-7ca62b5446b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3EC14A10>]}
[0m12:50:30.837813 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:50:31.280533 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:50:31.498944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:50:31.500014 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:50:31.808486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f912df23-5a8e-4558-9479-7ca62b5446b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3F034740>]}
[0m12:50:31.885556 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:50:31.890560 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:50:31.943617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f912df23-5a8e-4558-9479-7ca62b5446b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3F12DD90>]}
[0m12:50:31.944649 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:50:31.946798 [info ] [MainThread]: 
[0m12:50:31.946798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:31.947768 [info ] [MainThread]: 
[0m12:50:31.948768 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:31.949792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:50:32.068123 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:50:32.068123 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:50:32.069123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:32.755864 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.687 seconds
[0m12:50:32.771099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:50:32.836354 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:50:32.836354 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:50:32.837355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:33.132599 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.295 seconds
[0m12:50:33.144324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f912df23-5a8e-4558-9479-7ca62b5446b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3F150110>]}
[0m12:50:33.150792 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:50:33.150792 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:50:33.152793 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:50:33.152793 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:50:33.162049 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:50:33.163148 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:50:33.199846 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:50:33.202813 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:50:33.202813 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (-- -- Step 1: Check Filtered Transactions
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- )
-- SELECT * FROM filtered_transactions

-- -- Step 2: Check Customer Purchase Dates
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- )
-- SELECT * FROM customer_purchase_dates

-- Step 3: Check Monthly Status
WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
)
SELECT * FROM monthly_status

-- -- Step 4: Check Churned Customers
-- WITH filtered_transactions AS (
--     SELECT customer_id,
--            payment_month,
--            revenue_type
--     FROM HOTEL_MGMT.stage.stg_transactions
--     WHERE revenue_type = 1
-- ),
-- customer_purchase_dates AS (
--     SELECT customer_id,
--            payment_month,
--            MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--            MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM filtered_transactions
-- ),
-- monthly_status AS (
--     SELECT payment_month,
--            customer_id,
--            CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
--            CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
--     FROM customer_purchase_dates
-- ),
-- churned_customers AS (
--     SELECT customer_id,
--            payment_month,
--            CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
--     FROM monthly_status
--     WHERE payment_month > last_purchase_date
-- )
-- SELECT * FROM churned_customers
        );
[0m12:50:33.204352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:50:33.879769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m12:50:33.909202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f912df23-5a8e-4558-9479-7ca62b5446b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3A266A80>]}
[0m12:50:33.910359 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 0.76s]
[0m12:50:33.911325 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:50:33.913358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:33.913358 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:50:33.913358 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:50:33.984545 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:50:33.984545 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:50:34.059211 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:50:34.060219 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:50:34.145243 [info ] [MainThread]: 
[0m12:50:34.147866 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m12:50:34.152301 [debug] [MainThread]: Command end result
[0m12:50:34.196011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:50:34.197982 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:50:34.205238 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:50:34.205238 [info ] [MainThread]: 
[0m12:50:34.206544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:34.207494 [info ] [MainThread]: 
[0m12:50:34.208501 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:50:34.211000 [debug] [MainThread]: Command `dbt build` succeeded at 12:50:34.210510 after 4.22 seconds
[0m12:50:34.211000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3A5F0CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3A5F11F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3C76E9F0>]}
[0m12:50:34.212038 [debug] [MainThread]: Flushing usage events
[0m12:50:35.228189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:19.318177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC253D9A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC24710D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC27A888C0>]}


============================== 12:52:19.323216 | 4e1e8706-4178-4f7e-8b43-3f18def55d31 ==============================
[0m12:52:19.323216 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:52:19.324468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:19.873704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e1e8706-4178-4f7e-8b43-3f18def55d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2984ADE0>]}
[0m12:52:19.944704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e1e8706-4178-4f7e-8b43-3f18def55d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2968CD40>]}
[0m12:52:19.945703 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:52:20.381241 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:52:20.579710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:52:20.579710 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:52:20.877873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e1e8706-4178-4f7e-8b43-3f18def55d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC27F746B0>]}
[0m12:52:20.954606 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:52:20.959607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:52:21.011577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e1e8706-4178-4f7e-8b43-3f18def55d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2AD71EE0>]}
[0m12:52:21.011577 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:52:21.013765 [info ] [MainThread]: 
[0m12:52:21.014764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:21.015731 [info ] [MainThread]: 
[0m12:52:21.016733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:52:21.017917 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:52:21.132593 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:52:21.133592 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:52:21.133592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:21.827622 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.694 seconds
[0m12:52:21.842372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:52:21.906947 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:52:21.906947 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:52:21.908205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:22.286712 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.378 seconds
[0m12:52:22.290735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1e8706-4178-4f7e-8b43-3f18def55d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2B26CA70>]}
[0m12:52:22.295719 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:52:22.296760 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:52:22.297726 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:52:22.297726 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:52:22.306177 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:52:22.308174 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:52:22.344853 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:52:22.349051 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:52:22.350032 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
),
previous_data AS (
    SELECT DISTINCT customer_id,
           payment_month AS prev_payment_month
    FROM customer_purchase_dates
    WHERE payment_month < (SELECT MIN(payment_month) FROM customer_purchase_dates)
),
adjusted_monthly_status AS (
    SELECT ms.payment_month,
           ms.customer_id,
           CASE WHEN pd.prev_payment_month IS NULL THEN 1 ELSE ms.is_new_customer END AS is_new_customer,
           ms.is_last_purchase
    FROM monthly_status ms
    LEFT JOIN previous_data pd ON ms.customer_id = pd.customer_id
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM adjusted_monthly_status
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM adjusted_monthly_status
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM adjusted_monthly_status
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:52:22.350032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:52:24.577762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.227 seconds
[0m12:52:24.626035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e1e8706-4178-4f7e-8b43-3f18def55d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC27F74500>]}
[0m12:52:24.627069 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 2.33s]
[0m12:52:24.628232 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:52:24.629232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:24.630264 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:52:24.630264 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:52:24.701175 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:52:24.702172 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:52:24.789248 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:52:24.789248 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:52:24.861402 [info ] [MainThread]: 
[0m12:52:24.864653 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m12:52:24.869968 [debug] [MainThread]: Command end result
[0m12:52:24.911786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:52:24.914092 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:52:24.922377 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:52:24.923366 [info ] [MainThread]: 
[0m12:52:24.924354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:24.925356 [info ] [MainThread]: 
[0m12:52:24.925356 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:24.927563 [debug] [MainThread]: Command `dbt build` succeeded at 12:52:24.927563 after 5.90 seconds
[0m12:52:24.927563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2861E000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2861C080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2861D670>]}
[0m12:52:24.928562 [debug] [MainThread]: Flushing usage events
[0m12:52:25.895089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:03.135279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE70FD54C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE71AA7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE71AA7500>]}


============================== 12:54:03.140474 | 281978d9-0195-4a2b-b69c-f25dfabd7cac ==============================
[0m12:54:03.140474 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:03.141621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:54:03.699176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '281978d9-0195-4a2b-b69c-f25dfabd7cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE74A6BEF0>]}
[0m12:54:03.780749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '281978d9-0195-4a2b-b69c-f25dfabd7cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE749C13D0>]}
[0m12:54:03.781759 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:54:04.217193 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:04.433527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:54:04.433527 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:54:04.740743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '281978d9-0195-4a2b-b69c-f25dfabd7cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE75EB8440>]}
[0m12:54:04.829881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:54:04.834016 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:54:04.885238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '281978d9-0195-4a2b-b69c-f25dfabd7cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE75F85BB0>]}
[0m12:54:04.886427 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:54:04.888420 [info ] [MainThread]: 
[0m12:54:04.889423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:04.889423 [info ] [MainThread]: 
[0m12:54:04.890556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:54:04.891556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:54:05.012948 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:54:05.013948 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:54:05.013948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:05.660189 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.647 seconds
[0m12:54:05.669638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:54:05.729327 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:54:05.729327 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:54:05.729327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:06.088226 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.358 seconds
[0m12:54:06.098080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '281978d9-0195-4a2b-b69c-f25dfabd7cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE765BCA70>]}
[0m12:54:06.112550 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:54:06.114552 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:54:06.116694 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:54:06.117751 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:54:06.138171 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:54:06.139171 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:54:06.175629 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:54:06.180628 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:54:06.181627 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
),
churned_customers AS (
    SELECT customer_id,
           payment_month,
           CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM monthly_status
    WHERE payment_month > last_purchase_date
),
adjusted_monthly_status AS (
    SELECT ms.payment_month,
           ms.customer_id,
           CASE WHEN pd.prev_payment_month IS NULL THEN 1 ELSE ms.is_new_customer END AS is_new_customer,
           ms.is_last_purchase
    FROM monthly_status ms
    LEFT JOIN (
        SELECT customer_id,
               MAX(payment_month) AS prev_payment_month
        FROM monthly_status
        WHERE payment_month < (SELECT MIN(payment_month) FROM monthly_status)
        GROUP BY customer_id
    ) pd ON ms.customer_id = pd.customer_id
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM adjusted_monthly_status
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM adjusted_monthly_status
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM adjusted_monthly_status
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:54:06.181627 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:06.527145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff5c-0000-e6d0-0008-ed5a0002468e
[0m12:54:06.528141 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 37
invalid identifier 'LAST_PURCHASE_DATE'
[0m12:54:06.531337 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 37
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:54:06.534534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '281978d9-0195-4a2b-b69c-f25dfabd7cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE731C46B0>]}
[0m12:54:06.535530 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.42s]
[0m12:54:06.536495 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:54:06.536495 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 37
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m12:54:06.538669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:06.538669 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:54:06.539704 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:54:06.605986 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:54:06.605986 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:54:06.707232 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:54:06.708273 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:54:06.798497 [info ] [MainThread]: 
[0m12:54:06.801089 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m12:54:06.804523 [debug] [MainThread]: Command end result
[0m12:54:06.841456 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:54:06.844675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:54:06.852968 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:54:06.852968 [info ] [MainThread]: 
[0m12:54:06.853952 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:54:06.855951 [info ] [MainThread]: 
[0m12:54:06.856967 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 37
  invalid identifier 'LAST_PURCHASE_DATE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:54:06.857953 [info ] [MainThread]: 
[0m12:54:06.858969 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:54:06.860994 [debug] [MainThread]: Command `dbt build` failed at 12:54:06.860994 after 3.95 seconds
[0m12:54:06.860994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE763F5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE706EBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE706EA8A0>]}
[0m12:54:06.861974 [debug] [MainThread]: Flushing usage events
[0m12:54:07.831795 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:50.045041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA49DC3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA49DF230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA4DB32C0>]}


============================== 12:54:50.050446 | c62d3b3c-dfa6-4dcf-980f-ebb624e490e4 ==============================
[0m12:54:50.050446 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:50.051410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:50.608263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62d3b3c-dfa6-4dcf-980f-ebb624e490e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA527DEE0>]}
[0m12:54:50.682773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62d3b3c-dfa6-4dcf-980f-ebb624e490e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA47098B0>]}
[0m12:54:50.684917 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:54:51.113346 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:51.319630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:54:51.320628 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:54:51.630755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c62d3b3c-dfa6-4dcf-980f-ebb624e490e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA751BA10>]}
[0m12:54:51.710418 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:54:51.714535 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:54:51.769963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c62d3b3c-dfa6-4dcf-980f-ebb624e490e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA7622B70>]}
[0m12:54:51.769963 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:54:51.773179 [info ] [MainThread]: 
[0m12:54:51.773179 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:51.774477 [info ] [MainThread]: 
[0m12:54:51.775485 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:54:51.776487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:54:51.892212 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:54:51.893408 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:54:51.893408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:52.596888 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.703 seconds
[0m12:54:52.619484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:54:52.685748 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:54:52.686747 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:54:52.686747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:53.004848 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.318 seconds
[0m12:54:53.008989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62d3b3c-dfa6-4dcf-980f-ebb624e490e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA761C320>]}
[0m12:54:53.014793 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:54:53.015825 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:54:53.016789 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:54:53.017826 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:54:53.028283 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:54:53.030247 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:54:53.069170 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:54:53.074400 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:54:53.075601 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           first_purchase_date,
           is_last_purchase,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
),
churned_customers AS (
    SELECT customer_id,
           payment_month,
           last_purchase_date,
           first_purchase_date,
           CASE WHEN payment_month > last_purchase_date THEN 1 ELSE 0 END AS is_churned_customer
    FROM monthly_status
    WHERE payment_month > last_purchase_date
),
adjusted_monthly_status AS (
    SELECT ms.payment_month,
           ms.customer_id,
           CASE WHEN pd.prev_payment_month IS NULL THEN 1 ELSE ms.is_new_customer END AS is_new_customer,
           ms.is_last_purchase
    FROM monthly_status ms
    LEFT JOIN (
        SELECT customer_id,
               MAX(payment_month) AS prev_payment_month
        FROM monthly_status
        WHERE payment_month < (SELECT MIN(payment_month) FROM monthly_status)
        GROUP BY customer_id
    ) pd ON ms.customer_id = pd.customer_id
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM adjusted_monthly_status
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM adjusted_monthly_status
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM adjusted_monthly_status
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:54:53.075601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:53.387033 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff5c-0000-e677-0008-ed5a000216be
[0m12:54:53.388033 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 11
invalid identifier 'IS_LAST_PURCHASE'
[0m12:54:53.391138 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 21 at position 11
  invalid identifier 'IS_LAST_PURCHASE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:54:53.394116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62d3b3c-dfa6-4dcf-980f-ebb624e490e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA7C2F2F0>]}
[0m12:54:53.394116 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.38s]
[0m12:54:53.396188 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:54:53.396188 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 21 at position 11
  invalid identifier 'IS_LAST_PURCHASE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m12:54:53.398189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:53.398189 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:54:53.399471 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:54:53.473174 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:54:53.474163 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:54:53.550712 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:54:53.550712 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:54:53.624754 [info ] [MainThread]: 
[0m12:54:53.627744 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m12:54:53.631030 [debug] [MainThread]: Command end result
[0m12:54:53.673342 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:54:53.675372 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:54:53.682642 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:54:53.682642 [info ] [MainThread]: 
[0m12:54:53.683607 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:54:53.686044 [info ] [MainThread]: 
[0m12:54:53.687042 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 21 at position 11
  invalid identifier 'IS_LAST_PURCHASE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:54:53.688042 [info ] [MainThread]: 
[0m12:54:53.689042 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:54:53.691076 [debug] [MainThread]: Command `dbt build` failed at 12:54:53.691076 after 3.84 seconds
[0m12:54:53.691076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA519C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA4678860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA4B35AF0>]}
[0m12:54:53.692041 [debug] [MainThread]: Flushing usage events
[0m12:54:55.117637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:32.735159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019766C212B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019764C4F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019767358EC0>]}


============================== 12:56:32.741427 | 47557db0-dd05-4a90-8a2a-59ed95264706 ==============================
[0m12:56:32.741427 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:56:32.742394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:33.307778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47557db0-dd05-4a90-8a2a-59ed95264706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197694383E0>]}
[0m12:56:33.376444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47557db0-dd05-4a90-8a2a-59ed95264706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197648EA3C0>]}
[0m12:56:33.378914 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:56:33.798967 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:56:34.021387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:34.022387 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:56:34.316622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47557db0-dd05-4a90-8a2a-59ed95264706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019769866C90>]}
[0m12:56:34.391491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:56:34.395648 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:56:34.451067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47557db0-dd05-4a90-8a2a-59ed95264706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019769A7FBF0>]}
[0m12:56:34.451067 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:56:34.453184 [info ] [MainThread]: 
[0m12:56:34.454185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:34.455320 [info ] [MainThread]: 
[0m12:56:34.456366 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:34.457329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:56:34.574432 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:56:34.575433 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:56:34.575433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:35.592128 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.016 seconds
[0m12:56:35.606926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:56:35.665124 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:56:35.665124 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:56:35.665124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:35.996320 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.330 seconds
[0m12:56:36.006899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47557db0-dd05-4a90-8a2a-59ed95264706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001976998A060>]}
[0m12:56:36.023401 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:56:36.025403 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:56:36.028641 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:56:36.030980 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:56:36.054716 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:56:36.057170 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:56:36.094168 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:56:36.098750 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:56:36.099751 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH filtered_transactions AS (
    SELECT customer_id,
           payment_month,
           revenue_type
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
customer_purchase_dates AS (
    SELECT customer_id,
           payment_month,
           MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
           MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM filtered_transactions
),
monthly_status AS (
    SELECT payment_month,
           customer_id,
           first_purchase_date,
           last_purchase_date,
           CASE WHEN payment_month = first_purchase_date THEN 1 ELSE 0 END AS is_new_customer,
           CASE WHEN payment_month = last_purchase_date THEN 1 ELSE 0 END AS is_last_purchase
    FROM customer_purchase_dates
),
adjusted_monthly_status AS (
    SELECT ms.payment_month,
           ms.customer_id,
           ms.first_purchase_date,
           ms.last_purchase_date,
           CASE WHEN pd.prev_payment_month IS NULL THEN 1 ELSE ms.is_new_customer END AS is_new_customer,
           ms.is_last_purchase
    FROM monthly_status ms
    LEFT JOIN (
        SELECT customer_id,
               MAX(payment_month) AS prev_payment_month
        FROM monthly_status
        WHERE payment_month < (SELECT MIN(payment_month) FROM monthly_status)
        GROUP BY customer_id
    ) pd ON ms.customer_id = pd.customer_id
),
lm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm
    FROM adjusted_monthly_status
),
l3m_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m
    FROM adjusted_monthly_status
),
ltm_status AS (
    SELECT customer_id,
           payment_month,
           SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
           SUM(is_last_purchase) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM adjusted_monthly_status
)
SELECT 
    lm_status.customer_id,
    lm_status.payment_month,
    lm_status.new_customers_lm,
    lm_status.churned_customers_lm,
    l3m_status.new_customers_l3m,
    l3m_status.churned_customers_l3m,
    ltm_status.new_customers_ltm,
    ltm_status.churned_customers_ltm
FROM lm_status
JOIN l3m_status USING (customer_id, payment_month)
JOIN ltm_status USING (customer_id, payment_month)
ORDER BY customer_id, payment_month
        );
[0m12:56:36.099751 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:56:38.362831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.262 seconds
[0m12:56:38.390465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47557db0-dd05-4a90-8a2a-59ed95264706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019764A36C00>]}
[0m12:56:38.391473 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 2.36s]
[0m12:56:38.392472 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:56:38.393652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:38.394687 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:56:38.394687 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:56:38.465692 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:56:38.466694 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:56:38.543115 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:56:38.543115 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:56:38.613139 [info ] [MainThread]: 
[0m12:56:38.614110 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m12:56:38.615110 [debug] [MainThread]: Command end result
[0m12:56:38.641443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:56:38.643715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:56:38.651681 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:56:38.651681 [info ] [MainThread]: 
[0m12:56:38.652894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:38.653929 [info ] [MainThread]: 
[0m12:56:38.654941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:56:38.656894 [debug] [MainThread]: Command `dbt build` succeeded at 12:56:38.656894 after 6.12 seconds
[0m12:56:38.656894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019767359DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197696FC0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019769654080>]}
[0m12:56:38.657895 [debug] [MainThread]: Flushing usage events
[0m12:56:39.721809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:30.829312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4DA93320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4DA93230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4F6CC9E0>]}


============================== 12:58:30.834531 | cd18838b-01ce-45c5-bace-ef2c6c9b7e01 ==============================
[0m12:58:30.834531 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:58:30.835752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:58:31.473190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd18838b-01ce-45c5-bace-ef2c6c9b7e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4D097680>]}
[0m12:58:31.543132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd18838b-01ce-45c5-bace-ef2c6c9b7e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E50961BE0>]}
[0m12:58:31.544132 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:58:32.127227 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:58:33.702478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:58:33.703479 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:58:33.993518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd18838b-01ce-45c5-bace-ef2c6c9b7e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E51FB9490>]}
[0m12:58:34.069195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:58:34.087062 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:58:34.168895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd18838b-01ce-45c5-bace-ef2c6c9b7e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E51F75CA0>]}
[0m12:58:34.168895 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:58:34.171926 [info ] [MainThread]: 
[0m12:58:34.171926 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:34.173047 [info ] [MainThread]: 
[0m12:58:34.174033 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:34.175074 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:58:37.628009 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:58:37.629201 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:58:37.629201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:38.416794 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.788 seconds
[0m12:58:38.431463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:58:38.501187 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:58:38.502187 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:58:38.502187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:38.829198 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.327 seconds
[0m12:58:38.833438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd18838b-01ce-45c5-bace-ef2c6c9b7e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E51E76C90>]}
[0m12:58:38.838992 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:58:38.838992 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:58:38.840202 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:58:38.841200 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:58:38.850235 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:58:38.852215 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:58:38.889690 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:58:38.892885 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:58:38.893899 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
),
aggregated_data AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_month THEN customer_id END) AS churned_customers
    FROM churn_new_customers
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM aggregated_data;
[0m12:58:38.893899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:39.364786 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff60-0000-e70c-0008-ed5a00029066
[0m12:58:39.364786 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 29 unexpected ';'.
[0m12:58:39.382386 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 29 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:58:39.385272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd18838b-01ce-45c5-bace-ef2c6c9b7e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E51CE3F50>]}
[0m12:58:39.385272 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.54s]
[0m12:58:39.387402 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:58:39.387966 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 29 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m12:58:39.390006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:39.390006 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:58:39.390006 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:58:39.464875 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:58:39.464875 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:58:39.540904 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:58:39.540904 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:58:39.617974 [info ] [MainThread]: 
[0m12:58:39.618977 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m12:58:39.620976 [debug] [MainThread]: Command end result
[0m12:58:39.648986 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:58:39.652013 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:58:39.659668 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:58:39.660676 [info ] [MainThread]: 
[0m12:58:39.661676 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:58:39.662695 [info ] [MainThread]: 
[0m12:58:39.663677 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 29 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m12:58:39.663677 [info ] [MainThread]: 
[0m12:58:39.664677 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:58:39.666677 [debug] [MainThread]: Command `dbt build` failed at 12:58:39.666677 after 9.06 seconds
[0m12:58:39.666677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4F1D1A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4F7F3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4F7F1370>]}
[0m12:58:39.667711 [debug] [MainThread]: Flushing usage events
[0m12:58:40.685094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:47.961161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C17406750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C19856E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C19855430>]}


============================== 12:58:47.966422 | 7ec571ae-797a-482b-8780-0e43fa73b27f ==============================
[0m12:58:47.966422 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:58:47.967390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:48.517270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ec571ae-797a-482b-8780-0e43fa73b27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C175178C0>]}
[0m12:58:48.586208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ec571ae-797a-482b-8780-0e43fa73b27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1AECBF80>]}
[0m12:58:48.588172 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:58:49.023717 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:58:49.225981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:58:49.225981 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m12:58:49.524578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ec571ae-797a-482b-8780-0e43fa73b27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1C439490>]}
[0m12:58:49.600770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:58:49.606071 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:58:49.655132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ec571ae-797a-482b-8780-0e43fa73b27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1C50FDD0>]}
[0m12:58:49.655132 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m12:58:49.657131 [info ] [MainThread]: 
[0m12:58:49.658132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:49.659310 [info ] [MainThread]: 
[0m12:58:49.660354 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:49.661319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m12:58:49.779737 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m12:58:49.780777 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m12:58:49.780777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:50.258723 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.477 seconds
[0m12:58:50.274545 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m12:58:50.332919 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m12:58:50.332919 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m12:58:50.333921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:50.674496 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.341 seconds
[0m12:58:50.686170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ec571ae-797a-482b-8780-0e43fa73b27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1C414440>]}
[0m12:58:50.702486 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m12:58:50.704847 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m12:58:50.707852 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m12:58:50.710271 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m12:58:50.733089 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m12:58:50.735312 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m12:58:50.773867 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m12:58:50.775868 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m12:58:50.775868 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
),
aggregated_data AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_month THEN customer_id END) AS churned_customers
    FROM churn_new_customers
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM aggregated_data
        );
[0m12:58:50.776870 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:51.588229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m12:58:51.621356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec571ae-797a-482b-8780-0e43fa73b27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C19624710>]}
[0m12:58:51.622400 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 0.91s]
[0m12:58:51.624357 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m12:58:51.625573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:51.625573 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m12:58:51.626574 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m12:58:51.704309 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m12:58:51.704309 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m12:58:51.776579 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m12:58:51.777583 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m12:58:51.869626 [info ] [MainThread]: 
[0m12:58:51.871654 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m12:58:51.876083 [debug] [MainThread]: Command end result
[0m12:58:51.915877 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m12:58:51.918881 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m12:58:51.927099 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m12:58:51.927099 [info ] [MainThread]: 
[0m12:58:51.928513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:51.929503 [info ] [MainThread]: 
[0m12:58:51.930512 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:58:51.951211 [debug] [MainThread]: Command `dbt build` succeeded at 12:58:51.951211 after 4.18 seconds
[0m12:58:51.952420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1A058800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C19E25640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C19EF35F0>]}
[0m12:58:51.952420 [debug] [MainThread]: Flushing usage events
[0m12:58:52.911082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:35.537428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB1881E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB18828A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB1881B50>]}


============================== 13:00:35.543636 | 80638d0e-6e3e-4c10-ae3b-5cf5153f24e1 ==============================
[0m13:00:35.543636 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:00:35.544601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:00:36.119255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80638d0e-6e3e-4c10-ae3b-5cf5153f24e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB2704470>]}
[0m13:00:36.188229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80638d0e-6e3e-4c10-ae3b-5cf5153f24e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB1D9AFC0>]}
[0m13:00:36.190374 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:00:36.638529 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:00:36.867024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:00:36.868024 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m13:00:37.183170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80638d0e-6e3e-4c10-ae3b-5cf5153f24e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB4049460>]}
[0m13:00:37.260045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:00:37.264253 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:00:37.319306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80638d0e-6e3e-4c10-ae3b-5cf5153f24e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB411FCB0>]}
[0m13:00:37.319306 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m13:00:37.322514 [info ] [MainThread]: 
[0m13:00:37.323503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:37.324519 [info ] [MainThread]: 
[0m13:00:37.325503 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:37.327734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m13:00:37.469906 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m13:00:37.471083 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m13:00:37.471083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:38.166008 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.695 seconds
[0m13:00:38.173738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m13:00:38.235288 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m13:00:38.236322 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m13:00:38.236322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:38.650337 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.414 seconds
[0m13:00:38.654419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80638d0e-6e3e-4c10-ae3b-5cf5153f24e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB3FCDA30>]}
[0m13:00:38.658551 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m13:00:38.659550 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m13:00:38.660660 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m13:00:38.660660 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m13:00:38.669899 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m13:00:38.671897 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m13:00:38.708173 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m13:00:38.711270 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m13:00:38.711270 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
),
aggregated_data AS (
    SELECT
        customer_id,
        payment_month,
        CASE WHEN first_purchase_date = payment_month THEN 1 ELSE 0 END AS is_new_customer,
        CASE WHEN last_purchase_date = payment_month THEN 1 ELSE 0 END AS is_churned_customer
    FROM churn_new_customers
)
SELECT 
    customer_id,
    payment_month,
    SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS new_customers,
    SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS churned_customers
FROM aggregated_data
ORDER BY customer_id, payment_month;
[0m13:00:38.712277 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:39.114144 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff62-0000-e6c6-0008-ed5a000275e2
[0m13:00:39.115140 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 35 unexpected ';'.
[0m13:00:39.119331 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 35 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m13:00:39.121484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80638d0e-6e3e-4c10-ae3b-5cf5153f24e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB426C110>]}
[0m13:00:39.122485 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.46s]
[0m13:00:39.123180 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m13:00:39.124238 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 35 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m13:00:39.126367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:39.126367 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m13:00:39.127365 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m13:00:39.193550 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m13:00:39.193550 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m13:00:39.287538 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m13:00:39.287538 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m13:00:39.356785 [info ] [MainThread]: 
[0m13:00:39.357742 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m13:00:39.359747 [debug] [MainThread]: Command end result
[0m13:00:39.396212 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:00:39.399204 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:00:39.406433 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m13:00:39.406433 [info ] [MainThread]: 
[0m13:00:39.407448 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:00:39.408323 [info ] [MainThread]: 
[0m13:00:39.409428 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 35 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m13:00:39.410177 [info ] [MainThread]: 
[0m13:00:39.411214 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:00:39.412189 [debug] [MainThread]: Command `dbt build` failed at 13:00:39.412189 after 4.09 seconds
[0m13:00:39.413218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB18DC320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB18DD460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB18DC2C0>]}
[0m13:00:39.414225 [debug] [MainThread]: Flushing usage events
[0m13:00:40.375752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:46.829828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D80F86A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D811FD36E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D811FD0E30>]}


============================== 13:00:46.835218 | 2d2cab06-afc0-441c-bc89-62890428e53d ==============================
[0m13:00:46.835218 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:00:46.836216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:00:47.389684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d2cab06-afc0-441c-bc89-62890428e53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81262B080>]}
[0m13:00:47.458371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d2cab06-afc0-441c-bc89-62890428e53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81262B860>]}
[0m13:00:47.460632 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:00:47.891820 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:00:48.092045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:00:48.092045 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m13:00:48.402225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d2cab06-afc0-441c-bc89-62890428e53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D814909490>]}
[0m13:00:48.476813 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:00:48.481980 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:00:48.532030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d2cab06-afc0-441c-bc89-62890428e53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8149DFF20>]}
[0m13:00:48.532030 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m13:00:48.534064 [info ] [MainThread]: 
[0m13:00:48.535500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:48.535500 [info ] [MainThread]: 
[0m13:00:48.536541 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:48.538507 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m13:00:48.656255 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m13:00:48.656255 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m13:00:48.657458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:49.290186 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.633 seconds
[0m13:00:49.299815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m13:00:49.356913 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m13:00:49.357944 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m13:00:49.357944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:49.715720 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.358 seconds
[0m13:00:49.721108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d2cab06-afc0-441c-bc89-62890428e53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D813071EB0>]}
[0m13:00:49.725840 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m13:00:49.725840 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m13:00:49.726871 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m13:00:49.727960 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m13:00:49.736202 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m13:00:49.738168 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m13:00:49.775201 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m13:00:49.777203 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m13:00:49.778203 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
),
aggregated_data AS (
    SELECT
        customer_id,
        payment_month,
        CASE WHEN first_purchase_date = payment_month THEN 1 ELSE 0 END AS is_new_customer,
        CASE WHEN last_purchase_date = payment_month THEN 1 ELSE 0 END AS is_churned_customer
    FROM churn_new_customers
)
SELECT 
    customer_id,
    payment_month,
    SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS new_customers,
    SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS churned_customers
FROM aggregated_data
ORDER BY customer_id, payment_month
        );
[0m13:00:49.778203 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:50.830620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.052 seconds
[0m13:00:50.858007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d2cab06-afc0-441c-bc89-62890428e53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D80F9B6A20>]}
[0m13:00:50.859224 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.13s]
[0m13:00:50.860203 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m13:00:50.862191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:50.862191 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m13:00:50.862191 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m13:00:50.939159 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m13:00:50.940156 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m13:00:51.022105 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m13:00:51.023100 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m13:00:51.110486 [info ] [MainThread]: 
[0m13:00:51.111725 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m13:00:51.113762 [debug] [MainThread]: Command end result
[0m13:00:51.148132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:00:51.150168 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:00:51.158343 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m13:00:51.158343 [info ] [MainThread]: 
[0m13:00:51.159379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:51.160376 [info ] [MainThread]: 
[0m13:00:51.161341 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:00:51.163344 [debug] [MainThread]: Command `dbt build` succeeded at 13:00:51.163344 after 4.52 seconds
[0m13:00:51.163344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8124FC7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8124FCAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8121A9A00>]}
[0m13:00:51.164377 [debug] [MainThread]: Flushing usage events
[0m13:00:52.221889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:37.936435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED9B53EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED7582C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED9802960>]}


============================== 13:04:37.941605 | dd8020b8-87ec-41be-aea3-4e31ef46ccc8 ==============================
[0m13:04:37.941605 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:04:37.942605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:04:38.514694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd8020b8-87ec-41be-aea3-4e31ef46ccc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDA1A8DD0>]}
[0m13:04:38.588080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd8020b8-87ec-41be-aea3-4e31ef46ccc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED9F9E870>]}
[0m13:04:38.590627 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:04:39.022632 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:04:39.239533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:39.240638 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m13:04:39.548912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd8020b8-87ec-41be-aea3-4e31ef46ccc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC5197F0>]}
[0m13:04:39.628985 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:04:39.634172 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:04:39.691251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd8020b8-87ec-41be-aea3-4e31ef46ccc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC506C00>]}
[0m13:04:39.691251 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m13:04:39.693606 [info ] [MainThread]: 
[0m13:04:39.694606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:04:39.695575 [info ] [MainThread]: 
[0m13:04:39.695575 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:04:39.697794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m13:04:39.818437 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m13:04:39.818437 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m13:04:39.818437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:40.664116 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.845 seconds
[0m13:04:40.672322 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m13:04:40.734673 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m13:04:40.735641 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m13:04:40.735641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:41.083705 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.348 seconds
[0m13:04:41.089037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd8020b8-87ec-41be-aea3-4e31ef46ccc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDCA4AB70>]}
[0m13:04:41.093617 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m13:04:41.094624 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m13:04:41.095625 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m13:04:41.096624 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m13:04:41.106073 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m13:04:41.108092 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m13:04:41.146358 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m13:04:41.149482 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m13:04:41.149482 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
),
aggregated_data AS (
    SELECT
        customer_id,
        payment_month,
        CASE WHEN first_purchase_date = payment_month THEN 1 ELSE 0 END AS is_new_customer,
        CASE WHEN last_purchase_date = payment_month THEN 1 ELSE 0 END AS is_churned_customer
    FROM churn_new_customers
)
SELECT 
    customer_id,
    payment_month,
    SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
    SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm,
    SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
    SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m,
    SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
    SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
FROM aggregated_data
ORDER BY customer_id, payment_month
        );
[0m13:04:41.150449 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:04:42.300014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.149 seconds
[0m13:04:42.329731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd8020b8-87ec-41be-aea3-4e31ef46ccc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED75D67E0>]}
[0m13:04:42.329731 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.23s]
[0m13:04:42.331167 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m13:04:42.333174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:42.333174 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m13:04:42.334175 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m13:04:42.428027 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m13:04:42.429002 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m13:04:42.503868 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m13:04:42.504917 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m13:04:42.584404 [info ] [MainThread]: 
[0m13:04:42.587657 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m13:04:42.592178 [debug] [MainThread]: Command end result
[0m13:04:42.628095 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:04:42.631094 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:04:42.638305 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m13:04:42.639306 [info ] [MainThread]: 
[0m13:04:42.640303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:42.640303 [info ] [MainThread]: 
[0m13:04:42.641303 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:04:42.643385 [debug] [MainThread]: Command `dbt build` succeeded at 13:04:42.642343 after 4.96 seconds
[0m13:04:42.643385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED9802960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED7E66D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDCA6FAA0>]}
[0m13:04:42.644388 [debug] [MainThread]: Flushing usage events
[0m13:04:43.665813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:57.493555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224260E6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224264A1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242696E570>]}


============================== 13:05:57.498942 | 668a4842-9e7a-4955-ba0e-092e434e225e ==============================
[0m13:05:57.498942 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:05:57.499895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:58.072770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '668a4842-9e7a-4955-ba0e-092e434e225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242ABAE690>]}
[0m13:05:58.145959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '668a4842-9e7a-4955-ba0e-092e434e225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022429B539E0>]}
[0m13:05:58.146959 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:05:58.591493 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:05:58.799456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:58.799456 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m13:05:59.107961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '668a4842-9e7a-4955-ba0e-092e434e225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242ADD7F20>]}
[0m13:05:59.186392 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:05:59.190596 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:05:59.249477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '668a4842-9e7a-4955-ba0e-092e434e225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242B1EF7A0>]}
[0m13:05:59.250593 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m13:05:59.252614 [info ] [MainThread]: 
[0m13:05:59.253591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:59.254179 [info ] [MainThread]: 
[0m13:05:59.255220 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:05:59.256168 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m13:05:59.373657 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m13:05:59.374621 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m13:05:59.374621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:00.198097 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.824 seconds
[0m13:06:00.206583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m13:06:00.268182 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m13:06:00.268182 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m13:06:00.269185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:00.608577 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.339 seconds
[0m13:06:00.612768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '668a4842-9e7a-4955-ba0e-092e434e225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242B115C40>]}
[0m13:06:00.617815 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m13:06:00.618815 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m13:06:00.619834 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m13:06:00.619834 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m13:06:00.629849 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m13:06:00.630856 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m13:06:00.668728 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m13:06:00.672952 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m13:06:00.672952 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
),
aggregated_data AS (
    SELECT
        customer_id,
        payment_month,
        CASE WHEN first_purchase_date = payment_month THEN 1 ELSE 0 END AS is_new_customer,
        CASE WHEN last_purchase_date = payment_month THEN 1 ELSE 0 END AS is_churned_customer
    FROM churn_new_customers
),
timeline_data AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM aggregated_data
)
SELECT 
    payment_month,
    SUM(new_customers_lm) AS total_new_customers_lm,
    SUM(churned_customers_lm) AS total_churned_customers_lm,
    SUM(new_customers_l3m) AS total_new_customers_l3m,
    SUM(churned_customers_l3m) AS total_churned_customers_l3m,
    SUM(new_customers_ltm) AS total_new_customers_ltm,
    SUM(churned_customers_ltm) AS total_churned_customers_ltm
FROM timeline_data
GROUP BY payment_month
ORDER BY payment_month
        );
[0m13:06:00.673954 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:06:01.879004 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.204 seconds
[0m13:06:01.909039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '668a4842-9e7a-4955-ba0e-092e434e225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022428300080>]}
[0m13:06:01.909039 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.29s]
[0m13:06:01.911040 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m13:06:01.912039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:01.913039 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m13:06:01.913039 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m13:06:02.001969 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m13:06:02.001969 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m13:06:02.083940 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m13:06:02.084936 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m13:06:02.190708 [info ] [MainThread]: 
[0m13:06:02.194071 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m13:06:02.198457 [debug] [MainThread]: Command end result
[0m13:06:02.229446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:06:02.233644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:06:02.240969 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m13:06:02.242000 [info ] [MainThread]: 
[0m13:06:02.242545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:06:02.243553 [info ] [MainThread]: 
[0m13:06:02.244558 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:06:02.245158 [debug] [MainThread]: Command `dbt build` succeeded at 13:06:02.245158 after 4.96 seconds
[0m13:06:02.246167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022428A22240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022428C7B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242AFFB590>]}
[0m13:06:02.246167 [debug] [MainThread]: Flushing usage events
[0m13:06:03.606803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:32.980539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA86237D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA8623920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAA38D160>]}


============================== 13:15:32.992047 | 8331c62d-c59b-47e5-946d-101e33c8825f ==============================
[0m13:15:32.992047 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:15:32.993014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:15:33.929916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8331c62d-c59b-47e5-946d-101e33c8825f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA7C37A40>]}
[0m13:15:34.004787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8331c62d-c59b-47e5-946d-101e33c8825f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAB4DA900>]}
[0m13:15:34.006755 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:15:34.645751 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:15:36.360954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:36.361956 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m13:15:36.659709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8331c62d-c59b-47e5-946d-101e33c8825f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EACB696A0>]}
[0m13:15:36.735703 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:15:36.767831 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:15:36.879720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8331c62d-c59b-47e5-946d-101e33c8825f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EACC3BDD0>]}
[0m13:15:36.879720 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m13:15:36.882828 [info ] [MainThread]: 
[0m13:15:36.883828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:36.884830 [info ] [MainThread]: 
[0m13:15:36.885990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:15:36.886975 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m13:15:40.538913 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m13:15:40.538913 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m13:15:40.539914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:41.422976 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.883 seconds
[0m13:15:41.445373 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m13:15:41.517944 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m13:15:41.518914 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m13:15:41.518914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:41.829301 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.310 seconds
[0m13:15:41.834488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8331c62d-c59b-47e5-946d-101e33c8825f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAA1B5340>]}
[0m13:15:41.847748 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m13:15:41.848746 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m13:15:41.850746 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m13:15:41.851745 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m13:15:41.866226 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m13:15:41.869228 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m13:15:41.906955 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m13:15:41.910957 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m13:15:41.911991 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    JOIN HOTEL_MGMT.stage.stg_customers USING (customer_id)
    WHERE return_type=1
),
aggregated_data AS (
    SELECT
        customer_id,
        payment_month,
        CASE WHEN first_purchase_date = payment_month THEN 1 ELSE 0 END AS is_new_customer,
        CASE WHEN last_purchase_date = payment_month THEN 1 ELSE 0 END AS is_churned_customer
    FROM churn_new_customers
),
timeline_data AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM aggregated_data
)
SELECT 
    payment_month,
    SUM(new_customers_lm) AS total_new_customers_lm,
    SUM(churned_customers_lm) AS total_churned_customers_lm,
    SUM(new_customers_l3m) AS total_new_customers_l3m,
    SUM(churned_customers_l3m) AS total_churned_customers_l3m,
    SUM(new_customers_ltm) AS total_new_customers_ltm,
    SUM(churned_customers_ltm) AS total_churned_customers_ltm
FROM timeline_data
GROUP BY payment_month
ORDER BY payment_month
        );
[0m13:15:41.911991 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:15:42.438793 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff71-0000-e677-0008-ed5a00021706
[0m13:15:42.439998 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 10
invalid identifier 'RETURN_TYPE'
[0m13:15:42.459794 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 11 at position 10
  invalid identifier 'RETURN_TYPE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m13:15:42.464022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8331c62d-c59b-47e5-946d-101e33c8825f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA9D40620>]}
[0m13:15:42.464022 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.61s]
[0m13:15:42.466202 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m13:15:42.466749 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 11 at position 10
  invalid identifier 'RETURN_TYPE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m13:15:42.468756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:42.468756 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m13:15:42.468756 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m13:15:42.537454 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m13:15:42.538450 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m13:15:42.607414 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m13:15:42.607414 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m13:15:42.677807 [info ] [MainThread]: 
[0m13:15:42.679317 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m13:15:42.681358 [debug] [MainThread]: Command end result
[0m13:15:42.707325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:15:42.710325 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:15:42.718535 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m13:15:42.718535 [info ] [MainThread]: 
[0m13:15:42.719532 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:15:42.720499 [info ] [MainThread]: 
[0m13:15:42.721523 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 11 at position 10
  invalid identifier 'RETURN_TYPE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m13:15:42.722532 [info ] [MainThread]: 
[0m13:15:42.722532 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:15:42.723748 [debug] [MainThread]: Command `dbt build` failed at 13:15:42.723748 after 10.08 seconds
[0m13:15:42.724788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAA357380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAA0B57C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAA26F9B0>]}
[0m13:15:42.724788 [debug] [MainThread]: Flushing usage events
[0m13:15:43.798304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:18.226563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDDE47650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDDE474D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDDE47530>]}


============================== 13:16:18.232335 | 0861c651-91ca-4ea7-9e02-72a3afcfde20 ==============================
[0m13:16:18.232335 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:16:18.233498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:16:18.815077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0861c651-91ca-4ea7-9e02-72a3afcfde20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE0DB46E0>]}
[0m13:16:18.885044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0861c651-91ca-4ea7-9e02-72a3afcfde20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE0CEA1E0>]}
[0m13:16:18.886493 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:16:19.312524 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:16:19.510235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:19.510235 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m13:16:19.806196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0861c651-91ca-4ea7-9e02-72a3afcfde20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE2323C50>]}
[0m13:16:19.881141 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:16:19.886120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:16:19.936876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0861c651-91ca-4ea7-9e02-72a3afcfde20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE244FE30>]}
[0m13:16:19.937876 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m13:16:19.940112 [info ] [MainThread]: 
[0m13:16:19.941012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:19.942020 [info ] [MainThread]: 
[0m13:16:19.942020 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:16:19.944020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m13:16:20.061982 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m13:16:20.061982 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m13:16:20.062982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:21.001991 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.939 seconds
[0m13:16:21.016078 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m13:16:21.072395 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m13:16:21.072395 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m13:16:21.073396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:21.440803 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.367 seconds
[0m13:16:21.451675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0861c651-91ca-4ea7-9e02-72a3afcfde20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE244C800>]}
[0m13:16:21.467041 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m13:16:21.470040 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m13:16:21.473241 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m13:16:21.474744 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m13:16:21.493226 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m13:16:21.494216 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m13:16:21.530538 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m13:16:21.533543 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m13:16:21.534538 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    
    WHERE return_type=1
),
aggregated_data AS (
    SELECT
        customer_id,
        payment_month,
        CASE WHEN first_purchase_date = payment_month THEN 1 ELSE 0 END AS is_new_customer,
        CASE WHEN last_purchase_date = payment_month THEN 1 ELSE 0 END AS is_churned_customer
    FROM churn_new_customers
),
timeline_data AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM aggregated_data
)
SELECT 
    payment_month,
    SUM(new_customers_lm) AS total_new_customers_lm,
    SUM(churned_customers_lm) AS total_churned_customers_lm,
    SUM(new_customers_l3m) AS total_new_customers_l3m,
    SUM(churned_customers_l3m) AS total_churned_customers_l3m,
    SUM(new_customers_ltm) AS total_new_customers_ltm,
    SUM(churned_customers_ltm) AS total_churned_customers_ltm
FROM timeline_data
GROUP BY payment_month
ORDER BY payment_month
        );
[0m13:16:21.534538 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:21.788970 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff72-0000-e677-0008-ed5a0002170e
[0m13:16:21.790179 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 10
invalid identifier 'RETURN_TYPE'
[0m13:16:21.797383 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 11 at position 10
  invalid identifier 'RETURN_TYPE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m13:16:21.800520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0861c651-91ca-4ea7-9e02-72a3afcfde20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE2959640>]}
[0m13:16:21.801519 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.32s]
[0m13:16:21.803741 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m13:16:21.804738 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 11 at position 10
  invalid identifier 'RETURN_TYPE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m13:16:21.805701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:21.806910 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m13:16:21.806910 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m13:16:21.875221 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m13:16:21.876221 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m13:16:21.949547 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m13:16:21.949547 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m13:16:22.049789 [info ] [MainThread]: 
[0m13:16:22.052723 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m13:16:22.056200 [debug] [MainThread]: Command end result
[0m13:16:22.092933 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:16:22.095934 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:16:22.104931 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m13:16:22.104931 [info ] [MainThread]: 
[0m13:16:22.106178 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:16:22.107178 [info ] [MainThread]: 
[0m13:16:22.108180 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 11 at position 10
  invalid identifier 'RETURN_TYPE'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m13:16:22.109177 [info ] [MainThread]: 
[0m13:16:22.109177 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:16:22.111389 [debug] [MainThread]: Command `dbt build` failed at 13:16:22.111389 after 4.08 seconds
[0m13:16:22.111389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDFEC8B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDFEC9A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE207E7B0>]}
[0m13:16:22.112390 [debug] [MainThread]: Flushing usage events
[0m13:16:23.059514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:48.078819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026903391FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269033900B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026903393F80>]}


============================== 13:16:48.084060 | 6d816562-e82c-49a1-8406-f6287cd0bac5 ==============================
[0m13:16:48.084060 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:16:48.085030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m13:16:48.654807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d816562-e82c-49a1-8406-f6287cd0bac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026905CCC920>]}
[0m13:16:48.726187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d816562-e82c-49a1-8406-f6287cd0bac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026904C44770>]}
[0m13:16:48.728191 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:16:49.152944 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:16:49.352037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:49.353039 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m13:16:49.647288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d816562-e82c-49a1-8406-f6287cd0bac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026905D0C740>]}
[0m13:16:49.723011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:16:49.726968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:16:49.780691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d816562-e82c-49a1-8406-f6287cd0bac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269061F6BA0>]}
[0m13:16:49.780691 [info ] [MainThread]: Found 4 models, 3 sources, 474 macros
[0m13:16:49.783685 [info ] [MainThread]: 
[0m13:16:49.784229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:49.785246 [info ] [MainThread]: 
[0m13:16:49.786271 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:16:49.787236 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m13:16:49.904529 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m13:16:49.905726 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m13:16:49.905726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:50.769313 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.863 seconds
[0m13:16:50.785084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m13:16:50.842601 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m13:16:50.842601 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m13:16:50.842601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:51.154997 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.311 seconds
[0m13:16:51.165998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d816562-e82c-49a1-8406-f6287cd0bac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026904ADD070>]}
[0m13:16:51.178016 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m13:16:51.180230 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m13:16:51.182226 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m13:16:51.182226 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m13:16:51.197290 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m13:16:51.198290 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m13:16:51.237614 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m13:16:51.240613 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m13:16:51.241614 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    
    WHERE revenue_type=1
),
aggregated_data AS (
    SELECT
        customer_id,
        payment_month,
        CASE WHEN first_purchase_date = payment_month THEN 1 ELSE 0 END AS is_new_customer,
        CASE WHEN last_purchase_date = payment_month THEN 1 ELSE 0 END AS is_churned_customer
    FROM churn_new_customers
),
timeline_data AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m,
        SUM(is_new_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
        SUM(is_churned_customer) OVER (PARTITION BY customer_id ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM aggregated_data
)
SELECT 
    payment_month,
    SUM(new_customers_lm) AS total_new_customers_lm,
    SUM(churned_customers_lm) AS total_churned_customers_lm,
    SUM(new_customers_l3m) AS total_new_customers_l3m,
    SUM(churned_customers_l3m) AS total_churned_customers_l3m,
    SUM(new_customers_ltm) AS total_new_customers_ltm,
    SUM(churned_customers_ltm) AS total_churned_customers_ltm
FROM timeline_data
GROUP BY payment_month
ORDER BY payment_month
        );
[0m13:16:51.241614 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:52.359644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.117 seconds
[0m13:16:52.388274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d816562-e82c-49a1-8406-f6287cd0bac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026901306930>]}
[0m13:16:52.389363 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.21s]
[0m13:16:52.390420 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m13:16:52.391369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:52.392370 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m13:16:52.392370 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m13:16:52.512595 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m13:16:52.512595 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m13:16:52.592534 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m13:16:52.592534 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m13:16:52.665721 [info ] [MainThread]: 
[0m13:16:52.667921 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m13:16:52.669924 [debug] [MainThread]: Command end result
[0m13:16:52.697473 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m13:16:52.700689 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m13:16:52.708100 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m13:16:52.708100 [info ] [MainThread]: 
[0m13:16:52.709102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:52.710067 [info ] [MainThread]: 
[0m13:16:52.711098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:16:52.712229 [debug] [MainThread]: Command `dbt build` succeeded at 13:16:52.712229 after 4.82 seconds
[0m13:16:52.712229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269038D1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269038D1D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269016E99D0>]}
[0m13:16:52.713757 [debug] [MainThread]: Flushing usage events
[0m13:16:54.186173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:08.213787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023346B07500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023344ED0D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233484B8860>]}


============================== 14:03:08.223439 | b3f441fa-7375-4b56-a2f1-229a027e46b1 ==============================
[0m14:03:08.223439 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:03:08.225617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m revenue_prod', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:03:09.093828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3f441fa-7375-4b56-a2f1-229a027e46b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023348D389E0>]}
[0m14:03:09.168675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3f441fa-7375-4b56-a2f1-229a027e46b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233490570E0>]}
[0m14:03:09.170742 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:03:09.728707 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:03:11.423003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:03:11.424004 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\transform\revenue_prod.sql
[0m14:03:11.715138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3f441fa-7375-4b56-a2f1-229a027e46b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334AC20FE0>]}
[0m14:03:11.794557 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:03:11.824670 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:03:11.931323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3f441fa-7375-4b56-a2f1-229a027e46b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334B0CAB40>]}
[0m14:03:11.932323 [info ] [MainThread]: Found 5 models, 3 sources, 474 macros
[0m14:03:11.935438 [info ] [MainThread]: 
[0m14:03:11.936436 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:11.936436 [info ] [MainThread]: 
[0m14:03:11.937657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:03:11.938623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:03:15.522198 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:03:15.522198 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:03:15.523391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:16.400242 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.877 seconds
[0m14:03:16.408549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:03:16.465043 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:03:16.466084 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:03:16.466084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:16.871759 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.406 seconds
[0m14:03:16.883965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3f441fa-7375-4b56-a2f1-229a027e46b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334AD99190>]}
[0m14:03:16.899740 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_prod
[0m14:03:16.899740 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.revenue_prod ................................ [RUN]
[0m14:03:16.901740 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_prod'
[0m14:03:16.901740 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_prod
[0m14:03:16.912185 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_prod"
[0m14:03:16.914132 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_prod
[0m14:03:16.954106 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_prod"
[0m14:03:16.956101 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_prod"
[0m14:03:16.957070 [debug] [Thread-1 (]: On model.hotel_booking.revenue_prod: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_prod"} */
create or replace transient table HOTEL_MGMT.stage.revenue_prod
         as
        (WITH product_revenue AS (
    SELECT
        product_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY product_id
),
ranked_products AS (
    SELECT
        product_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT product_id, total_revenue, revenue_rank
FROM ranked_products
ORDER BY revenue_rank;
[0m14:03:16.957070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:03:17.411139 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa1-0000-e6d0-0008-ed5a00024746
[0m14:03:17.412140 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 21 unexpected ';'.
[0m14:03:17.429441 [debug] [Thread-1 (]: Database Error in model revenue_prod (models\transform\revenue_prod.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\revenue_prod.sql
[0m14:03:17.432621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f441fa-7375-4b56-a2f1-229a027e46b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334ADC78F0>]}
[0m14:03:17.433654 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.revenue_prod ....................... [[31mERROR[0m in 0.53s]
[0m14:03:17.434627 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_prod
[0m14:03:17.435858 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.revenue_prod' to be skipped because of status 'error'.  Reason: Database Error in model revenue_prod (models\transform\revenue_prod.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\revenue_prod.sql.
[0m14:03:17.436846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:17.437854 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:03:17.437854 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:03:17.505821 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:03:17.506819 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:03:17.579606 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_prod' was left open.
[0m14:03:17.580608 [debug] [MainThread]: On model.hotel_booking.revenue_prod: Close
[0m14:03:17.656278 [info ] [MainThread]: 
[0m14:03:17.657275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m14:03:17.659275 [debug] [MainThread]: Command end result
[0m14:03:17.688758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:03:17.690919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:03:17.699279 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:03:17.700298 [info ] [MainThread]: 
[0m14:03:17.701279 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:03:17.702282 [info ] [MainThread]: 
[0m14:03:17.703279 [error] [MainThread]:   Database Error in model revenue_prod (models\transform\revenue_prod.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\revenue_prod.sql
[0m14:03:17.704295 [info ] [MainThread]: 
[0m14:03:17.705279 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:03:17.707280 [debug] [MainThread]: Command `dbt build` failed at 14:03:17.707280 after 9.74 seconds
[0m14:03:17.708281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023347D6BEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023348C234D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233481CAF30>]}
[0m14:03:17.709278 [debug] [MainThread]: Flushing usage events
[0m14:03:18.763336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:26.600178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025140905E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002513FF9D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514051D5B0>]}


============================== 14:03:26.605369 | ca0a59ef-41cf-4085-84bf-ef9fc111585d ==============================
[0m14:03:26.605369 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:03:26.606369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m revenue_prod', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:03:27.190312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca0a59ef-41cf-4085-84bf-ef9fc111585d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514153EE70>]}
[0m14:03:27.267270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca0a59ef-41cf-4085-84bf-ef9fc111585d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251415FA390>]}
[0m14:03:27.269356 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:03:27.727961 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:03:27.956315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:03:27.957338 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\revenue_prod.sql
[0m14:03:28.310183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca0a59ef-41cf-4085-84bf-ef9fc111585d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025142A560F0>]}
[0m14:03:28.413299 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:03:28.417409 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:03:28.473395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca0a59ef-41cf-4085-84bf-ef9fc111585d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025142C7ABD0>]}
[0m14:03:28.473395 [info ] [MainThread]: Found 5 models, 3 sources, 474 macros
[0m14:03:28.476533 [info ] [MainThread]: 
[0m14:03:28.477533 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:28.477533 [info ] [MainThread]: 
[0m14:03:28.478643 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:03:28.479639 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:03:28.607420 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:03:28.608421 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:03:28.608421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:29.056301 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.448 seconds
[0m14:03:29.064620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:03:29.140767 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:03:29.141766 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:03:29.141766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:29.461796 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.320 seconds
[0m14:03:29.464982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca0a59ef-41cf-4085-84bf-ef9fc111585d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514325A180>]}
[0m14:03:29.470135 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_prod
[0m14:03:29.471172 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.revenue_prod ................................ [RUN]
[0m14:03:29.472137 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_prod'
[0m14:03:29.472137 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_prod
[0m14:03:29.481582 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_prod"
[0m14:03:29.482589 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_prod
[0m14:03:29.521366 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_prod"
[0m14:03:29.523368 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_prod"
[0m14:03:29.524574 [debug] [Thread-1 (]: On model.hotel_booking.revenue_prod: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_prod"} */
create or replace transient table HOTEL_MGMT.stage.revenue_prod
         as
        (WITH product_revenue AS (
    SELECT
        product_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY product_id
),
ranked_products AS (
    SELECT
        product_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT product_id, total_revenue, revenue_rank
FROM ranked_products
ORDER BY revenue_rank
        );
[0m14:03:29.524574 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:03:30.687898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.162 seconds
[0m14:03:30.713904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca0a59ef-41cf-4085-84bf-ef9fc111585d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002513DCB6C00>]}
[0m14:03:30.713904 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.revenue_prod ........................... [[32mSUCCESS 1[0m in 1.24s]
[0m14:03:30.716098 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_prod
[0m14:03:30.717572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:30.717572 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:03:30.717572 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:03:30.787931 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:03:30.787931 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:03:30.862351 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_prod' was left open.
[0m14:03:30.862351 [debug] [MainThread]: On model.hotel_booking.revenue_prod: Close
[0m14:03:31.268930 [info ] [MainThread]: 
[0m14:03:31.270886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m14:03:31.274199 [debug] [MainThread]: Command end result
[0m14:03:31.299934 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:03:31.304155 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:03:31.310907 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:03:31.311874 [info ] [MainThread]: 
[0m14:03:31.312874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:31.312874 [info ] [MainThread]: 
[0m14:03:31.313876 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:03:31.315876 [debug] [MainThread]: Command `dbt build` succeeded at 14:03:31.315876 after 4.93 seconds
[0m14:03:31.315876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514043B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025140382B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002513FDC4680>]}
[0m14:03:31.316873 [debug] [MainThread]: Flushing usage events
[0m14:03:32.285108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:48.479969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD20D3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD20D34A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD3A88CE0>]}


============================== 14:04:48.485405 | 2be963d7-227d-44b3-a0e5-591019e05c2d ==============================
[0m14:04:48.485405 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:04:48.486405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m revenue_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.049153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2be963d7-227d-44b3-a0e5-591019e05c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD507DBE0>]}
[0m14:04:49.120874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2be963d7-227d-44b3-a0e5-591019e05c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD4335490>]}
[0m14:04:49.122877 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:04:49.563193 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:04:49.779085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:04:49.779085 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\transform\revenue_cust.sql
[0m14:04:50.084927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2be963d7-227d-44b3-a0e5-591019e05c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD66A2060>]}
[0m14:04:50.165318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:04:50.169285 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:04:50.221930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2be963d7-227d-44b3-a0e5-591019e05c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD668EBA0>]}
[0m14:04:50.223051 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:04:50.225051 [info ] [MainThread]: 
[0m14:04:50.226051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:50.227261 [info ] [MainThread]: 
[0m14:04:50.228215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:50.229250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:04:50.350752 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:04:50.350752 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:04:50.350752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:51.228049 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.877 seconds
[0m14:04:51.240454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:04:51.304877 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:04:51.304877 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:04:51.305874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:51.684193 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.379 seconds
[0m14:04:51.688171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2be963d7-227d-44b3-a0e5-591019e05c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD66A3620>]}
[0m14:04:51.693164 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_cust
[0m14:04:51.694130 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.revenue_cust ................................ [RUN]
[0m14:04:51.695131 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_cust'
[0m14:04:51.695131 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_cust
[0m14:04:51.704591 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_cust"
[0m14:04:51.710560 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_cust
[0m14:04:51.761561 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_cust"
[0m14:04:51.763544 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_cust"
[0m14:04:51.764544 [debug] [Thread-1 (]: On model.hotel_booking.revenue_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_cust"} */
create or replace transient table HOTEL_MGMT.stage.revenue_cust
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY customer_id
),
ranked_customers AS (
    SELECT
        customer_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT customer_id, total_revenue, revenue_rank
FROM ranked_customers
ORDER BY revenue_rank;
[0m14:04:51.764544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:52.073096 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa2-0000-e658-0008-ed5a00016762
[0m14:04:52.074333 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 21 unexpected ';'.
[0m14:04:52.080296 [debug] [Thread-1 (]: Database Error in model revenue_cust (models\transform\revenue_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\revenue_cust.sql
[0m14:04:52.083566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2be963d7-227d-44b3-a0e5-591019e05c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD37F4230>]}
[0m14:04:52.084579 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.revenue_cust ....................... [[31mERROR[0m in 0.39s]
[0m14:04:52.085544 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_cust
[0m14:04:52.086578 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.revenue_cust' to be skipped because of status 'error'.  Reason: Database Error in model revenue_cust (models\transform\revenue_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\revenue_cust.sql.
[0m14:04:52.087803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:52.088802 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:04:52.088802 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:04:52.168324 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:04:52.168324 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:04:52.275853 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_cust' was left open.
[0m14:04:52.275853 [debug] [MainThread]: On model.hotel_booking.revenue_cust: Close
[0m14:04:52.350145 [info ] [MainThread]: 
[0m14:04:52.351145 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m14:04:52.352145 [debug] [MainThread]: Command end result
[0m14:04:52.382426 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:04:52.389426 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:04:52.400719 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:04:52.400719 [info ] [MainThread]: 
[0m14:04:52.402741 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:04:52.403719 [info ] [MainThread]: 
[0m14:04:52.404718 [error] [MainThread]:   Database Error in model revenue_cust (models\transform\revenue_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\revenue_cust.sql
[0m14:04:52.405717 [info ] [MainThread]: 
[0m14:04:52.406718 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:04:52.408719 [debug] [MainThread]: Command `dbt build` failed at 14:04:52.407717 after 4.14 seconds
[0m14:04:52.408719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD0BD2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD03F0D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD0D04410>]}
[0m14:04:52.409717 [debug] [MainThread]: Flushing usage events
[0m14:04:53.414322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:02.082275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6660AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D68E9B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D68E9A600>]}


============================== 14:05:02.087656 | 526b614e-b6a3-474c-be41-3cc7769c78bd ==============================
[0m14:05:02.087656 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:05:02.088656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build -m revenue_cust', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:02.637479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '526b614e-b6a3-474c-be41-3cc7769c78bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D69DBA660>]}
[0m14:05:02.706907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '526b614e-b6a3-474c-be41-3cc7769c78bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D69223110>]}
[0m14:05:02.708964 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:05:03.135803 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:05:03.334755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:03.335749 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\revenue_cust.sql
[0m14:05:03.629336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '526b614e-b6a3-474c-be41-3cc7769c78bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B6B1DF0>]}
[0m14:05:03.706742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:05:03.710997 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:05:03.764016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '526b614e-b6a3-474c-be41-3cc7769c78bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6B688B60>]}
[0m14:05:03.765015 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:05:03.767193 [info ] [MainThread]: 
[0m14:05:03.768193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:03.769193 [info ] [MainThread]: 
[0m14:05:03.769193 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:03.771325 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:05:03.888566 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:05:03.888566 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:05:03.889716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:04.353376 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.463 seconds
[0m14:05:04.377428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:05:04.443145 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:05:04.444283 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:05:04.444283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:04.771896 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.327 seconds
[0m14:05:04.776582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526b614e-b6a3-474c-be41-3cc7769c78bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6BCC0560>]}
[0m14:05:04.780910 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_cust
[0m14:05:04.781909 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.revenue_cust ................................ [RUN]
[0m14:05:04.782910 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_cust'
[0m14:05:04.782910 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_cust
[0m14:05:04.792338 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_cust"
[0m14:05:04.793343 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_cust
[0m14:05:04.829792 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_cust"
[0m14:05:04.831756 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_cust"
[0m14:05:04.832796 [debug] [Thread-1 (]: On model.hotel_booking.revenue_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_cust"} */
create or replace transient table HOTEL_MGMT.stage.revenue_cust
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY customer_id
),
ranked_customers AS (
    SELECT
        customer_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT customer_id, total_revenue, revenue_rank
FROM ranked_customers
ORDER BY revenue_rank
        );
[0m14:05:04.832796 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:05.659990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.827 seconds
[0m14:05:05.701577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526b614e-b6a3-474c-be41-3cc7769c78bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D66736B10>]}
[0m14:05:05.702597 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.revenue_cust ........................... [[32mSUCCESS 1[0m in 0.92s]
[0m14:05:05.703042 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_cust
[0m14:05:05.705049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:05.705049 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:05:05.706083 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:05:05.780203 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:05:05.781201 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:05:05.864533 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_cust' was left open.
[0m14:05:05.866528 [debug] [MainThread]: On model.hotel_booking.revenue_cust: Close
[0m14:05:05.961778 [info ] [MainThread]: 
[0m14:05:05.963725 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m14:05:05.968221 [debug] [MainThread]: Command end result
[0m14:05:06.010190 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:05:06.013222 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:05:06.019443 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:05:06.020641 [info ] [MainThread]: 
[0m14:05:06.021592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:06.022592 [info ] [MainThread]: 
[0m14:05:06.023609 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:06.025872 [debug] [MainThread]: Command `dbt build` succeeded at 14:05:06.025872 after 4.14 seconds
[0m14:05:06.025872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D690017C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D66A91310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D687F1CA0>]}
[0m14:05:06.026838 [debug] [MainThread]: Flushing usage events
[0m14:05:07.366921 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:23.480177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087A4B9A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087D6A3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087D6A2900>]}


============================== 14:07:23.486340 | 11e607ac-0820-4697-a76b-bba95fee6257 ==============================
[0m14:07:23.486340 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:07:23.487490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m revenue_prod', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:24.141836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11e607ac-0820-4697-a76b-bba95fee6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087D023C80>]}
[0m14:07:24.236777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11e607ac-0820-4697-a76b-bba95fee6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087E95B980>]}
[0m14:07:24.238745 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:07:24.855748 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:07:26.634332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:26.635337 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\revenue_prod.sql
[0m14:07:26.943514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11e607ac-0820-4697-a76b-bba95fee6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087FEF1EE0>]}
[0m14:07:27.022108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:07:27.039936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:07:27.128179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11e607ac-0820-4697-a76b-bba95fee6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087E79C920>]}
[0m14:07:27.129179 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:07:27.131354 [info ] [MainThread]: 
[0m14:07:27.132383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:27.133348 [info ] [MainThread]: 
[0m14:07:27.134500 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:07:27.136501 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:07:31.273288 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:07:31.273288 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:07:31.274288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:31.983331 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.709 seconds
[0m14:07:31.990641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:07:32.053229 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:07:32.054263 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:07:32.054263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:32.378614 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.324 seconds
[0m14:07:32.381843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11e607ac-0820-4697-a76b-bba95fee6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087FED4440>]}
[0m14:07:32.387950 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_prod
[0m14:07:32.387950 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.revenue_prod ................................ [RUN]
[0m14:07:32.388982 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_prod'
[0m14:07:32.390223 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_prod
[0m14:07:32.398638 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_prod"
[0m14:07:32.400601 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_prod
[0m14:07:32.438072 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_prod"
[0m14:07:32.441040 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_prod"
[0m14:07:32.441040 [debug] [Thread-1 (]: On model.hotel_booking.revenue_prod: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_prod"} */
create or replace transient table HOTEL_MGMT.stage.revenue_prod
         as
        (WITH product_revenue AS (
    SELECT
        product_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY product_id
),
ranked_products AS (
    SELECT
        product_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rp.product_id,
    p.product_name,
    rp.total_revenue,
    rp.revenue_rank
FROM ranked_products rp
JOIN HOTEL_MGMT.stage.stg_products p ON rp.product_id = p.product_id
ORDER BY rp.revenue_rank;
[0m14:07:32.442069 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:32.882571 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa5-0000-e658-0008-ed5a00016786
[0m14:07:32.882571 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 24 unexpected ';'.
[0m14:07:32.899965 [debug] [Thread-1 (]: Database Error in model revenue_prod (models\transform\revenue_prod.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 24 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\revenue_prod.sql
[0m14:07:32.902799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e607ac-0820-4697-a76b-bba95fee6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020800626000>]}
[0m14:07:32.903844 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.revenue_prod ....................... [[31mERROR[0m in 0.51s]
[0m14:07:32.904806 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_prod
[0m14:07:32.905807 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.revenue_prod' to be skipped because of status 'error'.  Reason: Database Error in model revenue_prod (models\transform\revenue_prod.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 24 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\revenue_prod.sql.
[0m14:07:32.906808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:32.908001 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:07:32.908001 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:07:32.976165 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:07:32.977163 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:07:33.060985 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_prod' was left open.
[0m14:07:33.060985 [debug] [MainThread]: On model.hotel_booking.revenue_prod: Close
[0m14:07:33.138998 [info ] [MainThread]: 
[0m14:07:33.140250 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m14:07:33.142250 [debug] [MainThread]: Command end result
[0m14:07:33.170505 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:07:33.174739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:07:33.181774 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:07:33.181774 [info ] [MainThread]: 
[0m14:07:33.182773 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:07:33.184069 [info ] [MainThread]: 
[0m14:07:33.185077 [error] [MainThread]:   Database Error in model revenue_prod (models\transform\revenue_prod.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 24 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\revenue_prod.sql
[0m14:07:33.185077 [info ] [MainThread]: 
[0m14:07:33.186119 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:07:33.188089 [debug] [MainThread]: Command `dbt build` failed at 14:07:33.188089 after 10.03 seconds
[0m14:07:33.189341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087A4B9A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087D9238F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087DA887A0>]}
[0m14:07:33.189341 [debug] [MainThread]: Flushing usage events
[0m14:07:34.197287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:39.984505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3482528D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C348253620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3482513A0>]}


============================== 14:07:39.989669 | 87a026c3-d96e-4e51-883f-b9a92ab5ea86 ==============================
[0m14:07:39.989669 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:07:39.990952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -m revenue_prod', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:40.555521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a026c3-d96e-4e51-883f-b9a92ab5ea86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34876A360>]}
[0m14:07:40.627144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87a026c3-d96e-4e51-883f-b9a92ab5ea86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C348097020>]}
[0m14:07:40.629541 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:07:41.065655 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:07:41.268369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:41.269522 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\revenue_prod.sql
[0m14:07:41.570176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87a026c3-d96e-4e51-883f-b9a92ab5ea86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34AA22150>]}
[0m14:07:41.650041 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:07:41.654292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:07:41.708433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87a026c3-d96e-4e51-883f-b9a92ab5ea86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A9DAF00>]}
[0m14:07:41.708433 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:07:41.710892 [info ] [MainThread]: 
[0m14:07:41.711858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:41.713051 [info ] [MainThread]: 
[0m14:07:41.713607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:07:41.714649 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:07:41.830327 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:07:41.830327 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:07:41.831525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:42.292795 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.462 seconds
[0m14:07:42.304354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:07:42.364069 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:07:42.364069 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:07:42.364069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:42.690465 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.326 seconds
[0m14:07:42.703478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a026c3-d96e-4e51-883f-b9a92ab5ea86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34B0E4440>]}
[0m14:07:42.708670 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_prod
[0m14:07:42.708670 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.revenue_prod ................................ [RUN]
[0m14:07:42.709697 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_prod'
[0m14:07:42.710783 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_prod
[0m14:07:42.719042 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_prod"
[0m14:07:42.721006 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_prod
[0m14:07:42.756742 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_prod"
[0m14:07:42.758806 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_prod"
[0m14:07:42.759841 [debug] [Thread-1 (]: On model.hotel_booking.revenue_prod: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_prod"} */
create or replace transient table HOTEL_MGMT.stage.revenue_prod
         as
        (WITH product_revenue AS (
    SELECT
        product_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY product_id
),
ranked_products AS (
    SELECT
        product_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rp.product_id,
    p.product_name,
    rp.total_revenue,
    rp.revenue_rank
FROM ranked_products rp
JOIN HOTEL_MGMT.stage.stg_products p ON rp.product_id = p.product_id
ORDER BY rp.revenue_rank
        );
[0m14:07:42.760839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:43.085910 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa5-0000-e70c-0008-ed5a0002913e
[0m14:07:43.086911 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 4
invalid identifier 'P.PRODUCT_NAME'
[0m14:07:43.091162 [debug] [Thread-1 (]: Database Error in model revenue_prod (models\transform\revenue_prod.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\hotel_booking\models\transform\revenue_prod.sql
[0m14:07:43.093666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a026c3-d96e-4e51-883f-b9a92ab5ea86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34B006A20>]}
[0m14:07:43.094676 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.revenue_prod ....................... [[31mERROR[0m in 0.38s]
[0m14:07:43.095675 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_prod
[0m14:07:43.095675 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.revenue_prod' to be skipped because of status 'error'.  Reason: Database Error in model revenue_prod (models\transform\revenue_prod.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\hotel_booking\models\transform\revenue_prod.sql.
[0m14:07:43.097859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:43.098880 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:07:43.098880 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:07:43.175489 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:07:43.176485 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:07:43.250253 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_prod' was left open.
[0m14:07:43.251652 [debug] [MainThread]: On model.hotel_booking.revenue_prod: Close
[0m14:07:43.334779 [info ] [MainThread]: 
[0m14:07:43.335743 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m14:07:43.336742 [debug] [MainThread]: Command end result
[0m14:07:43.367724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:07:43.369750 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:07:43.376938 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:07:43.376938 [info ] [MainThread]: 
[0m14:07:43.378055 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:07:43.379061 [info ] [MainThread]: 
[0m14:07:43.380102 [error] [MainThread]:   Database Error in model revenue_prod (models\transform\revenue_prod.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\hotel_booking\models\transform\revenue_prod.sql
[0m14:07:43.380102 [info ] [MainThread]: 
[0m14:07:43.381101 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:07:43.383062 [debug] [MainThread]: Command `dbt build` failed at 14:07:43.383062 after 3.59 seconds
[0m14:07:43.383062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3484A5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3485D18E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3485D28D0>]}
[0m14:07:43.384064 [debug] [MainThread]: Flushing usage events
[0m14:07:44.305956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:31.657979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC8F4F4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC921130B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC92113080>]}


============================== 14:08:31.664196 | e382bb13-f870-4fd2-a04c-b395ee6af55d ==============================
[0m14:08:31.664196 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:08:31.665158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build -m revenue_prod', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:08:32.240362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e382bb13-f870-4fd2-a04c-b395ee6af55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC92D105C0>]}
[0m14:08:32.315279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e382bb13-f870-4fd2-a04c-b395ee6af55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC92E7CEC0>]}
[0m14:08:32.327459 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:08:32.759454 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:08:32.985958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:08:32.986925 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\revenue_prod.sql
[0m14:08:33.298080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e382bb13-f870-4fd2-a04c-b395ee6af55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC945B1E50>]}
[0m14:08:33.380667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:08:33.385897 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:08:33.443573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e382bb13-f870-4fd2-a04c-b395ee6af55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC94488980>]}
[0m14:08:33.444581 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:08:33.446598 [info ] [MainThread]: 
[0m14:08:33.447774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:33.448773 [info ] [MainThread]: 
[0m14:08:33.449771 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:08:33.450773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:08:33.571387 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:08:33.572389 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:08:33.572389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:34.400712 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.828 seconds
[0m14:08:34.409115 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:08:34.470606 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:08:34.471606 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:08:34.471606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:34.815166 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.344 seconds
[0m14:08:34.819199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e382bb13-f870-4fd2-a04c-b395ee6af55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC94BDCB60>]}
[0m14:08:34.824207 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_prod
[0m14:08:34.825206 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.revenue_prod ................................ [RUN]
[0m14:08:34.826206 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_prod'
[0m14:08:34.826206 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_prod
[0m14:08:34.835963 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_prod"
[0m14:08:34.836963 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_prod
[0m14:08:34.874532 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_prod"
[0m14:08:34.876693 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_prod"
[0m14:08:34.877727 [debug] [Thread-1 (]: On model.hotel_booking.revenue_prod: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_prod"} */
create or replace transient table HOTEL_MGMT.stage.revenue_prod
         as
        (WITH product_revenue AS (
    SELECT
        product_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY product_id
),
ranked_products AS (
    SELECT
        product_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rp.product_id,
    p.product_family,
    rp.total_revenue,
    rp.revenue_rank
FROM ranked_products rp
JOIN HOTEL_MGMT.stage.stg_products p ON rp.product_id = p.product_id
ORDER BY rp.revenue_rank
        );
[0m14:08:34.877727 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:35.755684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.877 seconds
[0m14:08:35.783951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e382bb13-f870-4fd2-a04c-b395ee6af55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC917140E0>]}
[0m14:08:35.784981 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.revenue_prod ........................... [[32mSUCCESS 1[0m in 0.95s]
[0m14:08:35.785550 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_prod
[0m14:08:35.787557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:35.787557 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:08:35.788590 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:08:35.863558 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:08:35.864781 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:08:35.944417 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_prod' was left open.
[0m14:08:35.946421 [debug] [MainThread]: On model.hotel_booking.revenue_prod: Close
[0m14:08:36.030695 [info ] [MainThread]: 
[0m14:08:36.031962 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m14:08:36.033966 [debug] [MainThread]: Command end result
[0m14:08:36.059110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:08:36.062124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:08:36.070247 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:08:36.070247 [info ] [MainThread]: 
[0m14:08:36.072691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:36.073695 [info ] [MainThread]: 
[0m14:08:36.074720 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:08:36.076692 [debug] [MainThread]: Command `dbt build` succeeded at 14:08:36.076692 after 4.62 seconds
[0m14:08:36.076692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC91CBDEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC945B1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC949B7650>]}
[0m14:08:36.077917 [debug] [MainThread]: Flushing usage events
[0m14:08:37.429317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:48.832000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BB91FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B8BCA7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BB7718E0>]}


============================== 14:09:48.838106 | 19f7c9db-2dd4-4794-9861-2626f8dcf9ca ==============================
[0m14:09:48.838106 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:09:48.839105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m revenue_cust', 'send_anonymous_usage_stats': 'True'}
[0m14:09:49.395118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19f7c9db-2dd4-4794-9861-2626f8dcf9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BCD3B9B0>]}
[0m14:09:49.464419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19f7c9db-2dd4-4794-9861-2626f8dcf9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BCF44770>]}
[0m14:09:49.466566 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:09:49.911807 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:09:50.114525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:09:50.115646 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\revenue_cust.sql
[0m14:09:50.415713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19f7c9db-2dd4-4794-9861-2626f8dcf9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BE50DE20>]}
[0m14:09:50.491832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:09:50.496949 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:09:50.548183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19f7c9db-2dd4-4794-9861-2626f8dcf9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BE4CA780>]}
[0m14:09:50.548183 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:09:50.550479 [info ] [MainThread]: 
[0m14:09:50.551480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:50.552635 [info ] [MainThread]: 
[0m14:09:50.552635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:09:50.554668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:09:50.674020 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:09:50.675056 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:09:50.675056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:51.395218 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.720 seconds
[0m14:09:51.402608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:09:51.413908 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:09:51.413908 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:09:51.414909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:51.723382 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.308 seconds
[0m14:09:51.734954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19f7c9db-2dd4-4794-9861-2626f8dcf9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BEB94500>]}
[0m14:09:51.751788 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_cust
[0m14:09:51.754077 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.revenue_cust ................................ [RUN]
[0m14:09:51.756604 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_cust'
[0m14:09:51.759001 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_cust
[0m14:09:51.769334 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_cust"
[0m14:09:51.771336 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_cust
[0m14:09:51.809283 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_cust"
[0m14:09:51.811283 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_cust"
[0m14:09:51.811283 [debug] [Thread-1 (]: On model.hotel_booking.revenue_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_cust"} */
create or replace transient table HOTEL_MGMT.stage.revenue_cust
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY customer_id
),
ranked_customers AS (
    SELECT
        customer_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT 
    rc.customer_id,
    c.customer_name,
    rc.total_revenue,
    rc.revenue_rank
FROM ranked_customers rc
JOIN HOTEL_MGMT.stage.stg_customers c ON rc.customer_id = c.customer_id
ORDER BY rc.revenue_rank
        );
[0m14:09:51.812283 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:09:52.113085 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa7-0000-e658-0008-ed5a0001679e
[0m14:09:52.113085 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 4
invalid identifier 'C.CUSTOMER_NAME'
[0m14:09:52.118484 [debug] [Thread-1 (]: Database Error in model revenue_cust (models\transform\revenue_cust.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'C.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\revenue_cust.sql
[0m14:09:52.120486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19f7c9db-2dd4-4794-9861-2626f8dcf9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BEB94380>]}
[0m14:09:52.121483 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.revenue_cust ....................... [[31mERROR[0m in 0.36s]
[0m14:09:52.122493 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_cust
[0m14:09:52.123536 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.revenue_cust' to be skipped because of status 'error'.  Reason: Database Error in model revenue_cust (models\transform\revenue_cust.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'C.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\revenue_cust.sql.
[0m14:09:52.125499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:52.125499 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:09:52.126534 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:09:52.201312 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:09:52.201312 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:09:52.275532 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_cust' was left open.
[0m14:09:52.276532 [debug] [MainThread]: On model.hotel_booking.revenue_cust: Close
[0m14:09:52.348917 [info ] [MainThread]: 
[0m14:09:52.349993 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m14:09:52.351004 [debug] [MainThread]: Command end result
[0m14:09:52.378784 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:09:52.380784 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:09:52.387936 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:09:52.388903 [info ] [MainThread]: 
[0m14:09:52.389904 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:09:52.390912 [info ] [MainThread]: 
[0m14:09:52.390912 [error] [MainThread]:   Database Error in model revenue_cust (models\transform\revenue_cust.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'C.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\revenue_cust.sql
[0m14:09:52.393088 [info ] [MainThread]: 
[0m14:09:52.393088 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:09:52.395089 [debug] [MainThread]: Command `dbt build` failed at 14:09:52.395089 after 3.77 seconds
[0m14:09:52.396123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BB59E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BB59D0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BBEF19D0>]}
[0m14:09:52.396123 [debug] [MainThread]: Flushing usage events
[0m14:09:53.430903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:17.200146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026398953260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263982D0A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263989521E0>]}


============================== 14:10:17.205023 | 242d02a2-70de-497a-bf70-6b53d0493f36 ==============================
[0m14:10:17.205023 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:10:17.205921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -m revenue_cust', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:17.745407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '242d02a2-70de-497a-bf70-6b53d0493f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639B82D730>]}
[0m14:10:17.814294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '242d02a2-70de-497a-bf70-6b53d0493f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263983690D0>]}
[0m14:10:17.816436 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:10:18.256675 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:10:18.462178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:10:18.462178 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\revenue_cust.sql
[0m14:10:18.755582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '242d02a2-70de-497a-bf70-6b53d0493f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639C9B1250>]}
[0m14:10:18.831883 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:10:18.836119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:10:18.885916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '242d02a2-70de-497a-bf70-6b53d0493f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639CFB4DA0>]}
[0m14:10:18.885916 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:10:18.889081 [info ] [MainThread]: 
[0m14:10:18.889081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:18.890049 [info ] [MainThread]: 
[0m14:10:18.891048 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:10:18.892270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:10:19.012299 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:10:19.012299 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:10:19.013297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:19.926670 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.914 seconds
[0m14:10:19.942555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:10:19.953755 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:10:19.953755 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:10:19.953755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:20.294448 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.340 seconds
[0m14:10:20.297434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242d02a2-70de-497a-bf70-6b53d0493f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639CD7C620>]}
[0m14:10:20.303745 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_cust
[0m14:10:20.303745 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.revenue_cust ................................ [RUN]
[0m14:10:20.304745 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_cust'
[0m14:10:20.305777 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_cust
[0m14:10:20.315234 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_cust"
[0m14:10:20.316205 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_cust
[0m14:10:20.353169 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_cust"
[0m14:10:20.355170 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_cust"
[0m14:10:20.356169 [debug] [Thread-1 (]: On model.hotel_booking.revenue_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_cust"} */
create or replace transient table HOTEL_MGMT.stage.revenue_cust
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY customer_id
),
ranked_customers AS (
    SELECT
        customer_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT 
    rc.customer_id,
    c.customername,
    rc.total_revenue,
    rc.revenue_rank
FROM ranked_customers rc
JOIN HOTEL_MGMT.stage.stg_customers c ON rc.customer_id = c.customer_id
ORDER BY rc.revenue_rank
        );
[0m14:10:20.356169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:21.407847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.051 seconds
[0m14:10:21.455871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242d02a2-70de-497a-bf70-6b53d0493f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026397F56B10>]}
[0m14:10:21.456866 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.revenue_cust ........................... [[32mSUCCESS 1[0m in 1.15s]
[0m14:10:21.457958 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_cust
[0m14:10:21.459956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:21.459956 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:10:21.459956 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:10:21.576682 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:10:21.579127 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:10:21.675339 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_cust' was left open.
[0m14:10:21.677340 [debug] [MainThread]: On model.hotel_booking.revenue_cust: Close
[0m14:10:21.755169 [info ] [MainThread]: 
[0m14:10:21.755169 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m14:10:21.757210 [debug] [MainThread]: Command end result
[0m14:10:21.782146 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:10:21.786382 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:10:21.794380 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:10:21.795414 [info ] [MainThread]: 
[0m14:10:21.795414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:21.796382 [info ] [MainThread]: 
[0m14:10:21.797381 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:10:21.798381 [debug] [MainThread]: Command `dbt build` succeeded at 14:10:21.798381 after 4.79 seconds
[0m14:10:21.799630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639CF57FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639A723680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639A721F40>]}
[0m14:10:21.799630 [debug] [MainThread]: Flushing usage events
[0m14:10:22.762298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:58.115763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5F4C966C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5F1F254C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5F49F52B0>]}


============================== 14:11:58.122194 | d3458249-10b5-4d4e-ac9d-d91c24d9320b ==============================
[0m14:11:58.122194 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:11:58.123173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:58.666238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3458249-10b5-4d4e-ac9d-d91c24d9320b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5F6A95580>]}
[0m14:11:58.736236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3458249-10b5-4d4e-ac9d-d91c24d9320b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5F47A0E30>]}
[0m14:11:58.737931 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:11:59.179357 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:11:59.381603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:59.381603 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m14:11:59.613814 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hotel_booking.churn_new_cust' (models\transform\churn_new_cust.sql) depends on a node named 'stg_transaction' which was not found
[0m14:11:59.614960 [debug] [MainThread]: Command `dbt build` failed at 14:11:59.614960 after 1.72 seconds
[0m14:11:59.615994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5F6CC9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5F4B53440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5F47FC350>]}
[0m14:11:59.615994 [debug] [MainThread]: Flushing usage events
[0m14:12:00.624250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:16.237435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140283B4920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140283B4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140283B5A00>]}


============================== 14:12:16.242589 | f2ea9ec4-f467-430a-98e6-27a85bb34cae ==============================
[0m14:12:16.242589 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:12:16.243772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_new_cust', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:16.794704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2ea9ec4-f467-430a-98e6-27a85bb34cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140290C4860>]}
[0m14:12:16.863962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2ea9ec4-f467-430a-98e6-27a85bb34cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014028D440B0>]}
[0m14:12:16.864962 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:12:17.300532 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:12:17.493744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:17.493744 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m14:12:17.787090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2ea9ec4-f467-430a-98e6-27a85bb34cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402A691F10>]}
[0m14:12:17.863343 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:12:17.867554 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:12:17.921249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2ea9ec4-f467-430a-98e6-27a85bb34cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402A670350>]}
[0m14:12:17.921249 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:12:17.923267 [info ] [MainThread]: 
[0m14:12:17.924586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:17.924586 [info ] [MainThread]: 
[0m14:12:17.925737 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:17.926778 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:12:18.045521 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:12:18.046790 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:12:18.046790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:18.863158 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.817 seconds
[0m14:12:18.870515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:12:18.882025 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:12:18.883026 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:12:18.883026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:19.229274 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.346 seconds
[0m14:12:19.243233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2ea9ec4-f467-430a-98e6-27a85bb34cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402AC79820>]}
[0m14:12:19.255948 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m14:12:19.257990 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m14:12:19.260172 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m14:12:19.261214 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m14:12:19.272643 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m14:12:19.273653 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m14:12:19.310182 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m14:12:19.312150 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m14:12:19.313182 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (
 
WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    DATE_TRUNC('month', ca.last_purchase_date) AS period,
    COUNT(DISTINCT ca.customer_id) AS churned_customers,
    ca.customer_id,
    cd.customer_name,
    cd.COMPANY
FROM customer_activity ca
JOIN customer_details cd
ON ca.customer_id = cd.customer_id
JOIN max_month mmo
ON ca.last_purchase_date < DATEADD(month, -3, mmo.max_date)
GROUP BY DATE_TRUNC('month', ca.last_purchase_date), ca.customer_id, cd.customer_name, cd.COMPANY
ORDER BY period
        );
[0m14:12:19.313182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:19.647490 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffaa-0000-e677-0008-ed5a0002179a
[0m14:12:19.647490 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 4
invalid identifier 'CD.CUSTOMER_NAME'
[0m14:12:19.651669 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 4
  invalid identifier 'CD.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m14:12:19.654375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2ea9ec4-f467-430a-98e6-27a85bb34cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402A4EC950>]}
[0m14:12:19.655383 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.39s]
[0m14:12:19.656383 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m14:12:19.657420 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 4
  invalid identifier 'CD.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m14:12:19.658597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:19.659613 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:12:19.659613 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:12:19.747006 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:12:19.748038 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:12:19.818397 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m14:12:19.818397 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m14:12:19.902185 [info ] [MainThread]: 
[0m14:12:19.903119 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m14:12:19.905151 [debug] [MainThread]: Command end result
[0m14:12:19.930281 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:12:19.932540 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:12:19.940515 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:12:19.941782 [info ] [MainThread]: 
[0m14:12:19.942781 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:12:19.943779 [info ] [MainThread]: 
[0m14:12:19.943779 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 27 at position 4
  invalid identifier 'CD.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m14:12:19.944780 [info ] [MainThread]: 
[0m14:12:19.945967 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:12:19.946974 [debug] [MainThread]: Command `dbt build` failed at 14:12:19.946974 after 3.90 seconds
[0m14:12:19.948009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014028142030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014024AA2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014024AA21E0>]}
[0m14:12:19.948009 [debug] [MainThread]: Flushing usage events
[0m14:12:20.953452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:31.966353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C90C11C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C90B4E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C90C611F0>]}


============================== 14:12:31.970894 | 1f5002c9-afe2-49ac-a7e7-1a8054d67358 ==============================
[0m14:12:31.970894 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:12:31.971894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m14:12:32.525641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f5002c9-afe2-49ac-a7e7-1a8054d67358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C93006690>]}
[0m14:12:32.594389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f5002c9-afe2-49ac-a7e7-1a8054d67358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C914E7170>]}
[0m14:12:32.595389 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:12:33.028409 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:12:33.241525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:33.242525 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m14:12:33.539950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f5002c9-afe2-49ac-a7e7-1a8054d67358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9356DF40>]}
[0m14:12:33.620042 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:12:33.624260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:12:33.676943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f5002c9-afe2-49ac-a7e7-1a8054d67358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C93674D10>]}
[0m14:12:33.676943 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:12:33.678976 [info ] [MainThread]: 
[0m14:12:33.680102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:33.681082 [info ] [MainThread]: 
[0m14:12:33.681803 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:33.682844 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:12:33.800669 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:12:33.800669 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:12:33.801669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:34.874757 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.073 seconds
[0m14:12:34.881106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:12:34.892607 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:12:34.893607 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:12:34.893607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:35.220433 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.326 seconds
[0m14:12:35.233320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f5002c9-afe2-49ac-a7e7-1a8054d67358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C93BACB60>]}
[0m14:12:35.249137 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m14:12:35.251591 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m14:12:35.254995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m14:12:35.256050 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m14:12:35.266400 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m14:12:35.267400 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m14:12:35.304626 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m14:12:35.306641 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m14:12:35.307659 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (
 
WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    DATE_TRUNC('month', ca.last_purchase_date) AS period,
    COUNT(DISTINCT ca.customer_id) AS churned_customers,
    ca.customer_id,
    cd.customername,
    cd.COMPANY
FROM customer_activity ca
JOIN customer_details cd
ON ca.customer_id = cd.customer_id
JOIN max_month mmo
ON ca.last_purchase_date < DATEADD(month, -3, mmo.max_date)
GROUP BY DATE_TRUNC('month', ca.last_purchase_date), ca.customer_id, cd.customer_name, cd.COMPANY
ORDER BY period
        );
[0m14:12:35.307659 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:35.611920 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffaa-0000-e6bd-0008-ed5a00026806
[0m14:12:35.612917 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 34 at position 69
invalid identifier 'CD.CUSTOMER_NAME'
[0m14:12:35.617921 [debug] [Thread-1 (]: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 34 at position 69
  invalid identifier 'CD.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m14:12:35.620916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f5002c9-afe2-49ac-a7e7-1a8054d67358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C93216990>]}
[0m14:12:35.621923 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_new_cust ..................... [[31mERROR[0m in 0.37s]
[0m14:12:35.623883 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m14:12:35.623883 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_new_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 34 at position 69
  invalid identifier 'CD.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql.
[0m14:12:35.625862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:35.626906 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:12:35.626906 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:12:35.698963 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:12:35.698963 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:12:35.770248 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m14:12:35.771246 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m14:12:35.853174 [info ] [MainThread]: 
[0m14:12:35.855433 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m14:12:35.859967 [debug] [MainThread]: Command end result
[0m14:12:35.900872 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:12:35.903042 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:12:35.911057 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:12:35.911057 [info ] [MainThread]: 
[0m14:12:35.913278 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:12:35.913802 [info ] [MainThread]: 
[0m14:12:35.913802 [error] [MainThread]:   Database Error in model churn_new_cust (models\transform\churn_new_cust.sql)
  000904 (42000): SQL compilation error: error line 34 at position 69
  invalid identifier 'CD.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\churn_new_cust.sql
[0m14:12:35.915096 [info ] [MainThread]: 
[0m14:12:35.916103 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:12:35.917046 [debug] [MainThread]: Command `dbt build` failed at 14:12:35.917046 after 4.14 seconds
[0m14:12:35.918088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C90A30D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C90A33A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C908E7FB0>]}
[0m14:12:35.918088 [debug] [MainThread]: Flushing usage events
[0m14:12:36.890864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:06.913803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED19A18C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1BED8C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1C05E9F0>]}


============================== 14:13:06.919108 | 4582a64d-1353-4325-86d9-af2ffd59f66b ==============================
[0m14:13:06.919108 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:13:06.920085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:07.466791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4582a64d-1353-4325-86d9-af2ffd59f66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1D3DA3C0>]}
[0m14:13:07.540348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4582a64d-1353-4325-86d9-af2ffd59f66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1A5677A0>]}
[0m14:13:07.542454 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:13:07.986530 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:13:08.196486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:08.197487 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m14:13:08.501824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4582a64d-1353-4325-86d9-af2ffd59f66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1EA71FA0>]}
[0m14:13:08.581278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:13:08.586468 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:13:08.639764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4582a64d-1353-4325-86d9-af2ffd59f66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1EA2B560>]}
[0m14:13:08.641000 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:13:08.642945 [info ] [MainThread]: 
[0m14:13:08.643945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:08.645006 [info ] [MainThread]: 
[0m14:13:08.645615 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:13:08.646657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:13:08.765317 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:13:08.765317 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:13:08.766316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:09.528478 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.762 seconds
[0m14:13:09.535766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:13:09.547162 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:13:09.548267 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:13:09.548267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:09.885817 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.337 seconds
[0m14:13:09.890778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4582a64d-1353-4325-86d9-af2ffd59f66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1EF9C5C0>]}
[0m14:13:09.897537 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m14:13:09.898587 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m14:13:09.899549 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m14:13:09.900813 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m14:13:09.914474 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m14:13:09.915474 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m14:13:09.951787 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m14:13:09.953936 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m14:13:09.954970 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (
 
WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    DATE_TRUNC('month', ca.last_purchase_date) AS period,
    COUNT(DISTINCT ca.customer_id) AS churned_customers,
    ca.customer_id,
    cd.customername,
    cd.COMPANY
FROM customer_activity ca
JOIN customer_details cd
ON ca.customer_id = cd.customer_id
JOIN max_month mmo
ON ca.last_purchase_date < DATEADD(month, -3, mmo.max_date)
GROUP BY DATE_TRUNC('month', ca.last_purchase_date), ca.customer_id, cd.customername, cd.COMPANY
ORDER BY period
        );
[0m14:13:09.955937 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:13:10.730069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m14:13:10.761155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4582a64d-1353-4325-86d9-af2ffd59f66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1F1E8410>]}
[0m14:13:10.762163 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 0.86s]
[0m14:13:10.763162 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m14:13:10.764293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:10.765301 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:13:10.765301 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:13:10.835736 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:13:10.835736 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:13:10.906790 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m14:13:10.907759 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m14:13:10.976751 [info ] [MainThread]: 
[0m14:13:10.978940 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m14:13:10.981990 [debug] [MainThread]: Command end result
[0m14:13:11.015667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:13:11.017900 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:13:11.025002 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:13:11.025002 [info ] [MainThread]: 
[0m14:13:11.026030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:11.026994 [info ] [MainThread]: 
[0m14:13:11.027992 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:13:11.028992 [debug] [MainThread]: Command `dbt build` succeeded at 14:13:11.028992 after 4.30 seconds
[0m14:13:11.030159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1BCEEFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1BCEE870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1C69C500>]}
[0m14:13:11.030159 [debug] [MainThread]: Flushing usage events
[0m14:13:12.076663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:25.661019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09169CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A094F63E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A094F629F0>]}


============================== 14:15:25.667038 | e9702c4a-da76-42de-a607-700d61971da2 ==============================
[0m14:15:25.667038 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:15:25.668019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m14:15:26.215962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9702c4a-da76-42de-a607-700d61971da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09615D460>]}
[0m14:15:26.286662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9702c4a-da76-42de-a607-700d61971da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0961EB9E0>]}
[0m14:15:26.288629 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:15:26.723490 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:15:26.922185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:26.923179 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\churn_new_cust.sql
[0m14:15:27.222856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9702c4a-da76-42de-a607-700d61971da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A097639FA0>]}
[0m14:15:27.298549 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:15:27.302663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:15:27.357182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9702c4a-da76-42de-a607-700d61971da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09773A720>]}
[0m14:15:27.358181 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:15:27.360362 [info ] [MainThread]: 
[0m14:15:27.361330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:27.361330 [info ] [MainThread]: 
[0m14:15:27.362594 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:27.363965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:15:27.481951 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:15:27.481951 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:15:27.482950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:28.283579 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.801 seconds
[0m14:15:28.290072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:15:28.304537 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:15:28.304537 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:15:28.305534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:28.716937 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.411 seconds
[0m14:15:28.720280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9702c4a-da76-42de-a607-700d61971da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0974C8F50>]}
[0m14:15:28.725036 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m14:15:28.726035 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m14:15:28.727194 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m14:15:28.727194 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m14:15:28.736601 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m14:15:28.737602 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m14:15:28.775008 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m14:15:28.777160 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m14:15:28.778159 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (

WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    DATE_TRUNC('month', ca.last_purchase_date) AS period,
    COUNT(DISTINCT CASE WHEN ca.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN ca.customer_id END) AS churned_customers,
    COUNT(DISTINCT CASE WHEN ca.first_purchase_date >= DATEADD(month, -3, mmo.max_date) THEN ca.customer_id END) AS new_customers,
    ca.customer_id,
    cd.customername,
    cd.COMPANY
FROM customer_activity ca
JOIN customer_details cd
ON ca.customer_id = cd.customer_id
JOIN max_month mmo
GROUP BY DATE_TRUNC('month', ca.last_purchase_date), ca.customer_id, cd.customername, cd.COMPANY
ORDER BY period
        );
[0m14:15:28.778159 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:29.707898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.930 seconds
[0m14:15:29.737077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9702c4a-da76-42de-a607-700d61971da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A092806CC0>]}
[0m14:15:29.737077 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.01s]
[0m14:15:29.739157 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m14:15:29.740353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:29.740353 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:15:29.741295 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:15:29.820455 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:15:29.821461 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:15:29.907733 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m14:15:29.908735 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m14:15:29.995828 [info ] [MainThread]: 
[0m14:15:29.998046 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m14:15:30.001321 [debug] [MainThread]: Command end result
[0m14:15:30.034783 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:15:30.037952 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:15:30.045313 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:15:30.046314 [info ] [MainThread]: 
[0m14:15:30.048325 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:30.048325 [info ] [MainThread]: 
[0m14:15:30.049484 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:30.050490 [debug] [MainThread]: Command `dbt build` succeeded at 14:15:30.050490 after 4.67 seconds
[0m14:15:30.051498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0950238F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A097739340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A097437BC0>]}
[0m14:15:30.051498 [debug] [MainThread]: Flushing usage events
[0m14:15:31.014466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:11.404405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F00E4C3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0101D1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0101D0DA0>]}


============================== 14:17:11.410491 | adc642fa-4eea-4aa6-8686-1f8ab7f895ff ==============================
[0m14:17:11.410491 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:17:11.411488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_new_cust', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:17:12.000171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adc642fa-4eea-4aa6-8686-1f8ab7f895ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F00DAF7A40>]}
[0m14:17:12.077191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adc642fa-4eea-4aa6-8686-1f8ab7f895ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F00FB89D00>]}
[0m14:17:12.078190 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:17:12.595570 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:17:12.803139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:12.804138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:12.845278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adc642fa-4eea-4aa6-8686-1f8ab7f895ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F00F6C2A50>]}
[0m14:17:12.933670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:17:12.938788 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:17:12.989580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adc642fa-4eea-4aa6-8686-1f8ab7f895ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0128C1280>]}
[0m14:17:12.989580 [info ] [MainThread]: Found 6 models, 3 sources, 474 macros
[0m14:17:12.991705 [info ] [MainThread]: 
[0m14:17:12.992704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:12.992704 [info ] [MainThread]: 
[0m14:17:12.993704 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:12.994813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:17:13.133891 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:17:13.134891 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:17:13.134891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:13.808044 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.673 seconds
[0m14:17:13.816293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:17:13.828619 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:17:13.829706 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:17:13.829706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:14.208586 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.379 seconds
[0m14:17:14.213826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc642fa-4eea-4aa6-8686-1f8ab7f895ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F01254F530>]}
[0m14:17:14.219729 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_new_cust
[0m14:17:14.219729 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_new_cust .............................. [RUN]
[0m14:17:14.220932 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_new_cust'
[0m14:17:14.221931 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_new_cust
[0m14:17:14.232201 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_new_cust"
[0m14:17:14.233293 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_new_cust
[0m14:17:14.271980 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_new_cust"
[0m14:17:14.274491 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_new_cust"
[0m14:17:14.274491 [debug] [Thread-1 (]: On model.hotel_booking.churn_new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_new_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_new_cust
         as
        (

WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    DATE_TRUNC('month', ca.last_purchase_date) AS period,
    COUNT(DISTINCT CASE WHEN ca.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN ca.customer_id END) AS churned_customers,
    COUNT(DISTINCT CASE WHEN ca.first_purchase_date >= DATEADD(month, -3, mmo.max_date) THEN ca.customer_id END) AS new_customers,
    ca.customer_id,
    cd.customername,
    cd.COMPANY
FROM customer_activity ca
JOIN customer_details cd
ON ca.customer_id = cd.customer_id
JOIN max_month mmo
GROUP BY DATE_TRUNC('month', ca.last_purchase_date), ca.customer_id, cd.customername, cd.COMPANY
ORDER BY period
        );
[0m14:17:14.275492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:15.226634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.950 seconds
[0m14:17:15.271729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc642fa-4eea-4aa6-8686-1f8ab7f895ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F00FBE44D0>]}
[0m14:17:15.272887 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_new_cust ......................... [[32mSUCCESS 1[0m in 1.05s]
[0m14:17:15.273628 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_new_cust
[0m14:17:15.275637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:15.275637 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:17:15.276670 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:17:15.345991 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:17:15.346992 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:17:15.443199 [debug] [MainThread]: Connection 'model.hotel_booking.churn_new_cust' was left open.
[0m14:17:15.445190 [debug] [MainThread]: On model.hotel_booking.churn_new_cust: Close
[0m14:17:15.519917 [info ] [MainThread]: 
[0m14:17:15.521926 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m14:17:15.525946 [debug] [MainThread]: Command end result
[0m14:17:15.552732 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:17:15.555754 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:17:15.562242 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:17:15.563209 [info ] [MainThread]: 
[0m14:17:15.564209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:15.564209 [info ] [MainThread]: 
[0m14:17:15.565428 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:17:15.567468 [debug] [MainThread]: Command `dbt build` succeeded at 14:17:15.566443 after 4.44 seconds
[0m14:17:15.567468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F00D134320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F01028DB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F01028C3B0>]}
[0m14:17:15.568470 [debug] [MainThread]: Flushing usage events
[0m14:17:16.896585 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:34.306652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026479095A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264763367E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264789C0830>]}


============================== 14:22:34.312010 | baee062d-bf90-4f7d-89a4-b2267071a516 ==============================
[0m14:22:34.312010 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:22:34.312757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m newlogos', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:22:34.927126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baee062d-bf90-4f7d-89a4-b2267071a516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026479E54680>]}
[0m14:22:34.996305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baee062d-bf90-4f7d-89a4-b2267071a516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026479B813A0>]}
[0m14:22:34.998270 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:22:35.567895 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:22:37.170423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:22:37.170423 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\transform\newlogos.sql
[0m14:22:37.461454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baee062d-bf90-4f7d-89a4-b2267071a516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647AF52F90>]}
[0m14:22:37.552401 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:22:37.570372 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:22:37.652185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baee062d-bf90-4f7d-89a4-b2267071a516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B528980>]}
[0m14:22:37.652185 [info ] [MainThread]: Found 7 models, 3 sources, 474 macros
[0m14:22:37.655352 [info ] [MainThread]: 
[0m14:22:37.655793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:37.656801 [info ] [MainThread]: 
[0m14:22:37.657307 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:37.658619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:22:41.006022 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:22:41.007017 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:22:41.007017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:41.768586 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.761 seconds
[0m14:22:41.782276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:22:41.796010 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:22:41.797171 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:22:41.797171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:42.187145 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.390 seconds
[0m14:22:42.190295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baee062d-bf90-4f7d-89a4-b2267071a516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647BA9CB60>]}
[0m14:22:42.195658 [debug] [Thread-1 (]: Began running node model.hotel_booking.newlogos
[0m14:22:42.196658 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.newlogos .................................... [RUN]
[0m14:22:42.197657 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.newlogos'
[0m14:22:42.197657 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.newlogos
[0m14:22:42.207244 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.newlogos"
[0m14:22:42.208242 [debug] [Thread-1 (]: Began executing node model.hotel_booking.newlogos
[0m14:22:42.245394 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.newlogos"
[0m14:22:42.248398 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.newlogos"
[0m14:22:42.248398 [debug] [Thread-1 (]: On model.hotel_booking.newlogos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.newlogos"} */
create or replace transient table HOTEL_MGMT.stage.newlogos
         as
        (DECLARE @fiscal_year_start_month INT = 4;
[0m14:22:42.249399 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:42.745628 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb4-0000-e6bd-0008-ed5a0002681a
[0m14:22:42.746830 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 3 at position 9 unexpected 'DECLARE'.
[0m14:22:42.765745 [debug] [Thread-1 (]: Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'DECLARE'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql
[0m14:22:42.768933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baee062d-bf90-4f7d-89a4-b2267071a516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647BB01D00>]}
[0m14:22:42.768933 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.newlogos ........................... [[31mERROR[0m in 0.57s]
[0m14:22:42.770932 [debug] [Thread-1 (]: Finished running node model.hotel_booking.newlogos
[0m14:22:42.770932 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.newlogos' to be skipped because of status 'error'.  Reason: Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'DECLARE'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql.
[0m14:22:42.772586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:42.773628 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:22:42.773628 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:22:42.852817 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:22:42.852817 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:22:42.930349 [debug] [MainThread]: Connection 'model.hotel_booking.newlogos' was left open.
[0m14:22:42.931349 [debug] [MainThread]: On model.hotel_booking.newlogos: Close
[0m14:22:43.002332 [info ] [MainThread]: 
[0m14:22:43.003327 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m14:22:43.004328 [debug] [MainThread]: Command end result
[0m14:22:43.031581 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:22:43.034612 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:22:43.041840 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:22:43.042806 [info ] [MainThread]: 
[0m14:22:43.043805 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:22:43.043805 [info ] [MainThread]: 
[0m14:22:43.044806 [error] [MainThread]:   Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'DECLARE'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql
[0m14:22:43.045803 [info ] [MainThread]: 
[0m14:22:43.046804 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:22:43.047806 [debug] [MainThread]: Command `dbt build` failed at 14:22:43.047806 after 8.97 seconds
[0m14:22:43.048807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026478806DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264786221B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B3F1F40>]}
[0m14:22:43.048807 [debug] [MainThread]: Flushing usage events
[0m14:22:44.441109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:50.976899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C4C247A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C2928CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C28CA5A0>]}


============================== 14:22:50.983202 | 0945449c-79f5-4829-8f4c-84f5df041182 ==============================
[0m14:22:50.983202 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:22:50.984381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m newlogos', 'send_anonymous_usage_stats': 'True'}
[0m14:22:51.527442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0945449c-79f5-4829-8f4c-84f5df041182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C5D1A450>]}
[0m14:22:51.598670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0945449c-79f5-4829-8f4c-84f5df041182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C5E93BF0>]}
[0m14:22:51.600111 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:22:52.029610 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:22:52.229555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:52.230554 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\newlogos.sql
[0m14:22:52.522183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0945449c-79f5-4829-8f4c-84f5df041182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C76023F0>]}
[0m14:22:52.596924 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:22:52.601075 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:22:52.655241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0945449c-79f5-4829-8f4c-84f5df041182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C75E1EE0>]}
[0m14:22:52.655241 [info ] [MainThread]: Found 7 models, 3 sources, 474 macros
[0m14:22:52.657465 [info ] [MainThread]: 
[0m14:22:52.658787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:52.659796 [info ] [MainThread]: 
[0m14:22:52.660828 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:52.662033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:22:52.779656 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:22:52.780656 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:22:52.780656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:53.353653 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.573 seconds
[0m14:22:53.369644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:22:53.381048 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:22:53.381048 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:22:53.382048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:53.747996 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.366 seconds
[0m14:22:53.761238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0945449c-79f5-4829-8f4c-84f5df041182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C7C90AD0>]}
[0m14:22:53.776689 [debug] [Thread-1 (]: Began running node model.hotel_booking.newlogos
[0m14:22:53.779743 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.newlogos .................................... [RUN]
[0m14:22:53.783029 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.newlogos'
[0m14:22:53.784030 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.newlogos
[0m14:22:53.808441 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.newlogos"
[0m14:22:53.824207 [debug] [Thread-1 (]: Began executing node model.hotel_booking.newlogos
[0m14:22:53.858856 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.newlogos"
[0m14:22:53.860855 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.newlogos"
[0m14:22:53.860855 [debug] [Thread-1 (]: On model.hotel_booking.newlogos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.newlogos"} */
create or replace transient table HOTEL_MGMT.stage.newlogos
         as
        (DECLARE @fiscal_year_start_month INT = 4;
[0m14:22:53.861856 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:54.255972 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb4-0000-e677-0008-ed5a000217be
[0m14:22:54.255972 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 3 at position 9 unexpected 'DECLARE'.
[0m14:22:54.260159 [debug] [Thread-1 (]: Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'DECLARE'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql
[0m14:22:54.262796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0945449c-79f5-4829-8f4c-84f5df041182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C4794980>]}
[0m14:22:54.262796 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.newlogos ........................... [[31mERROR[0m in 0.48s]
[0m14:22:54.264242 [debug] [Thread-1 (]: Finished running node model.hotel_booking.newlogos
[0m14:22:54.265283 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.newlogos' to be skipped because of status 'error'.  Reason: Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'DECLARE'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql.
[0m14:22:54.267489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:54.267489 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:22:54.267489 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:22:54.352449 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:22:54.353459 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:22:54.431829 [debug] [MainThread]: Connection 'model.hotel_booking.newlogos' was left open.
[0m14:22:54.431829 [debug] [MainThread]: On model.hotel_booking.newlogos: Close
[0m14:22:54.513922 [info ] [MainThread]: 
[0m14:22:54.514892 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m14:22:54.516881 [debug] [MainThread]: Command end result
[0m14:22:54.546072 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:22:54.548275 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:22:54.555442 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:22:54.556447 [info ] [MainThread]: 
[0m14:22:54.557446 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:22:54.558442 [info ] [MainThread]: 
[0m14:22:54.558442 [error] [MainThread]:   Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'DECLARE'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql
[0m14:22:54.560444 [info ] [MainThread]: 
[0m14:22:54.561445 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:22:54.562676 [debug] [MainThread]: Command `dbt build` failed at 14:22:54.562676 after 3.78 seconds
[0m14:22:54.563706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C2479A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C5F29D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C5F29310>]}
[0m14:22:54.563706 [debug] [MainThread]: Flushing usage events
[0m14:22:55.496213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:51.371459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF8DD27E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF98D3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF98D3620>]}


============================== 14:25:51.376212 | 0436bae3-1def-400e-9155-e25fb92a06ba ==============================
[0m14:25:51.376212 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:25:51.377350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m newlogos', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:25:51.935546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0436bae3-1def-400e-9155-e25fb92a06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF8EE7AA0>]}
[0m14:25:52.006640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0436bae3-1def-400e-9155-e25fb92a06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFB4B2270>]}
[0m14:25:52.008929 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:25:52.440600 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:25:52.639652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:52.639652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:52.678798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0436bae3-1def-400e-9155-e25fb92a06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFD9A10D0>]}
[0m14:25:52.757678 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:25:52.761805 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:25:52.816261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0436bae3-1def-400e-9155-e25fb92a06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFDDEF0B0>]}
[0m14:25:52.817243 [info ] [MainThread]: Found 7 models, 3 sources, 474 macros
[0m14:25:52.818770 [info ] [MainThread]: 
[0m14:25:52.819769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:52.819769 [info ] [MainThread]: 
[0m14:25:52.821000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:52.822543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:25:52.953583 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:25:52.953583 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:25:52.954750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:53.626735 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.672 seconds
[0m14:25:53.633551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:25:53.644929 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:25:53.644929 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:25:53.644929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:53.982251 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.336 seconds
[0m14:25:53.985214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0436bae3-1def-400e-9155-e25fb92a06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFC87B830>]}
[0m14:25:53.991188 [debug] [Thread-1 (]: Began running node model.hotel_booking.newlogos
[0m14:25:53.992188 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.newlogos .................................... [RUN]
[0m14:25:53.993187 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.newlogos'
[0m14:25:53.994188 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.newlogos
[0m14:25:54.002587 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.newlogos"
[0m14:25:54.004785 [debug] [Thread-1 (]: Began executing node model.hotel_booking.newlogos
[0m14:25:54.040756 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.newlogos"
[0m14:25:54.042975 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.newlogos"
[0m14:25:54.042975 [debug] [Thread-1 (]: On model.hotel_booking.newlogos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.newlogos"} */
create or replace transient table HOTEL_MGMT.stage.newlogos
         as
        (DECLARE @fiscal_year_start_month INT = 4;
[0m14:25:54.043975 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:54.291899 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb7-0000-e6bd-0008-ed5a00026822
[0m14:25:54.292995 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 3 at position 9 unexpected 'DECLARE'.
[0m14:25:54.297218 [debug] [Thread-1 (]: Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'DECLARE'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql
[0m14:25:54.300192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0436bae3-1def-400e-9155-e25fb92a06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFAFF48F0>]}
[0m14:25:54.300192 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.newlogos ........................... [[31mERROR[0m in 0.30s]
[0m14:25:54.301369 [debug] [Thread-1 (]: Finished running node model.hotel_booking.newlogos
[0m14:25:54.302380 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.newlogos' to be skipped because of status 'error'.  Reason: Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'DECLARE'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql.
[0m14:25:54.304380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:54.305515 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:25:54.305515 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:25:54.381387 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:25:54.382420 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:25:54.459308 [debug] [MainThread]: Connection 'model.hotel_booking.newlogos' was left open.
[0m14:25:54.460273 [debug] [MainThread]: On model.hotel_booking.newlogos: Close
[0m14:25:54.535781 [info ] [MainThread]: 
[0m14:25:54.538085 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m14:25:54.541086 [debug] [MainThread]: Command end result
[0m14:25:54.583631 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:25:54.586635 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:25:54.597079 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:25:54.597079 [info ] [MainThread]: 
[0m14:25:54.598076 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:25:54.599044 [info ] [MainThread]: 
[0m14:25:54.599044 [error] [MainThread]:   Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'DECLARE'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql
[0m14:25:54.600077 [info ] [MainThread]: 
[0m14:25:54.601050 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:25:54.603052 [debug] [MainThread]: Command `dbt build` failed at 14:25:54.603052 after 3.42 seconds
[0m14:25:54.603052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFB7F6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF76CAD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF76CAD50>]}
[0m14:25:54.604076 [debug] [MainThread]: Flushing usage events
[0m14:25:55.623565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:57.169001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199284666F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992A6B0D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992A6B0D70>]}


============================== 14:26:57.174407 | b8e73e1d-56a5-4e90-8401-cd0cd0394a3c ==============================
[0m14:26:57.174407 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:26:57.175375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m newlogos', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:57.725937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8e73e1d-56a5-4e90-8401-cd0cd0394a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992B1C5EB0>]}
[0m14:26:57.798417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8e73e1d-56a5-4e90-8401-cd0cd0394a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992B1EA6C0>]}
[0m14:26:57.799417 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:26:58.231285 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:26:58.451553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:26:58.451553 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\newlogos.sql
[0m14:26:58.744417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8e73e1d-56a5-4e90-8401-cd0cd0394a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992CF96CC0>]}
[0m14:26:58.822774 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:26:58.827091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:26:58.880313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8e73e1d-56a5-4e90-8401-cd0cd0394a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992D6092B0>]}
[0m14:26:58.881314 [info ] [MainThread]: Found 7 models, 3 sources, 474 macros
[0m14:26:58.883474 [info ] [MainThread]: 
[0m14:26:58.884444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:58.885086 [info ] [MainThread]: 
[0m14:26:58.886093 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:26:58.887092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:26:59.005965 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:26:59.006966 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:26:59.006966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:59.765450 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.758 seconds
[0m14:26:59.772616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:26:59.785158 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:26:59.785158 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:26:59.786339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:00.123069 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.337 seconds
[0m14:27:00.126299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8e73e1d-56a5-4e90-8401-cd0cd0394a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992D3FD340>]}
[0m14:27:00.132487 [debug] [Thread-1 (]: Began running node model.hotel_booking.newlogos
[0m14:27:00.132487 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.newlogos .................................... [RUN]
[0m14:27:00.133703 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.newlogos'
[0m14:27:00.134745 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.newlogos
[0m14:27:00.143126 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.newlogos"
[0m14:27:00.144096 [debug] [Thread-1 (]: Began executing node model.hotel_booking.newlogos
[0m14:27:00.179637 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.newlogos"
[0m14:27:00.182817 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.newlogos"
[0m14:27:00.182817 [debug] [Thread-1 (]: On model.hotel_booking.newlogos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.newlogos"} */
create or replace transient table HOTEL_MGMT.stage.newlogos
         as
        (WITH params AS (
    SELECT 4 AS fiscal_year_start_month 
),
customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
fiscal_years AS (
    SELECT
        ca.customer_id,
        ca.first_purchase_date,
        CASE
            WHEN EXTRACT(MONTH FROM ca.first_purchase_date) >= p.fiscal_year_start_month THEN EXTRACT(YEAR FROM ca.first_purchase_date)
            ELSE EXTRACT(YEAR FROM ca.first_purchase_date) - 1
        END AS fiscal_year
    FROM customer_activity ca
    CROSS JOIN params p
)
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_logos
FROM fiscal_years
GROUP BY fiscal_year
ORDER BY fiscal_year
        );
[0m14:27:00.183813 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:00.973688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.790 seconds
[0m14:27:01.000789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8e73e1d-56a5-4e90-8401-cd0cd0394a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019928576870>]}
[0m14:27:01.001996 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.newlogos ............................... [[32mSUCCESS 1[0m in 0.87s]
[0m14:27:01.002996 [debug] [Thread-1 (]: Finished running node model.hotel_booking.newlogos
[0m14:27:01.004995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:01.004995 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:27:01.006191 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:27:01.077290 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:27:01.078283 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:27:01.170040 [debug] [MainThread]: Connection 'model.hotel_booking.newlogos' was left open.
[0m14:27:01.172046 [debug] [MainThread]: On model.hotel_booking.newlogos: Close
[0m14:27:01.253804 [info ] [MainThread]: 
[0m14:27:01.255767 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m14:27:01.258054 [debug] [MainThread]: Command end result
[0m14:27:01.296138 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:27:01.298302 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:27:01.306277 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:27:01.307277 [info ] [MainThread]: 
[0m14:27:01.308477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:01.309467 [info ] [MainThread]: 
[0m14:27:01.309970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:27:01.310978 [debug] [MainThread]: Command `dbt build` succeeded at 14:27:01.310978 after 4.34 seconds
[0m14:27:01.312011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992AF51A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992AF53770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992AF526F0>]}
[0m14:27:01.312011 [debug] [MainThread]: Flushing usage events
[0m14:27:02.280523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:14.975136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C9631430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C9631C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C72509B0>]}


============================== 14:29:14.980506 | 39e9318a-6c96-4154-aac5-5603053781ea ==============================
[0m14:29:14.980506 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:29:14.981507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build -m newlogos', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:15.551876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39e9318a-6c96-4154-aac5-5603053781ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237CA8F30E0>]}
[0m14:29:15.623660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39e9318a-6c96-4154-aac5-5603053781ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C9E37170>]}
[0m14:29:15.625630 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:29:16.066234 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:29:16.281142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:29:16.282143 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\newlogos.sql
[0m14:29:16.586859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39e9318a-6c96-4154-aac5-5603053781ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237CBEB2510>]}
[0m14:29:16.665132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:29:16.669365 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:29:16.722623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39e9318a-6c96-4154-aac5-5603053781ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237CBFC8C80>]}
[0m14:29:16.722623 [info ] [MainThread]: Found 7 models, 3 sources, 474 macros
[0m14:29:16.724638 [info ] [MainThread]: 
[0m14:29:16.726116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:29:16.726116 [info ] [MainThread]: 
[0m14:29:16.727156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:29:16.729123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:29:16.848430 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:29:16.848430 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:29:16.849427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:17.679448 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.830 seconds
[0m14:29:17.686813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:29:17.697248 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:29:17.698424 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:29:17.698424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:18.029559 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.330 seconds
[0m14:29:18.035908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39e9318a-6c96-4154-aac5-5603053781ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237CC50AC30>]}
[0m14:29:18.043165 [debug] [Thread-1 (]: Began running node model.hotel_booking.newlogos
[0m14:29:18.044217 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.newlogos .................................... [RUN]
[0m14:29:18.046182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.newlogos'
[0m14:29:18.047217 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.newlogos
[0m14:29:18.057541 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.newlogos"
[0m14:29:18.058538 [debug] [Thread-1 (]: Began executing node model.hotel_booking.newlogos
[0m14:29:18.095442 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.newlogos"
[0m14:29:18.097442 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.newlogos"
[0m14:29:18.098441 [debug] [Thread-1 (]: On model.hotel_booking.newlogos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.newlogos"} */
create or replace transient table HOTEL_MGMT.stage.newlogos
         as
        (WITH params AS (
    SELECT 4 AS fiscal_year_start_month -- Change this value to set the fiscal year start month
),
customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
fiscal_years AS (
    SELECT
        ca.customer_id,
        ca.first_purchase_date,
        CASE
            WHEN EXTRACT(MONTH FROM ca.first_purchase_date) >= p.fiscal_year_start_month THEN EXTRACT(YEAR FROM ca.first_purchase_date)
            ELSE EXTRACT(YEAR FROM ca.first_purchase_date) - 1
        END AS fiscal_year
    FROM customer_activity ca
    CROSS JOIN params p
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
)
SELECT
    fy.fiscal_year,
    fy.customer_id,
    cd.customername,
    cd.COMPANY,
    fy.first_purchase_date
FROM fiscal_years fy
JOIN customer_details cd ON fy.customer_id = cd.customer_id
ORDER BY fy.fiscal_year, fy.customer_id
        );
[0m14:29:18.098441 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:29:18.828542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m14:29:18.857559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e9318a-6c96-4154-aac5-5603053781ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C6ED6C30>]}
[0m14:29:18.858567 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.newlogos ............................... [[32mSUCCESS 1[0m in 0.81s]
[0m14:29:18.859586 [debug] [Thread-1 (]: Finished running node model.hotel_booking.newlogos
[0m14:29:18.861755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:18.861755 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:29:18.861755 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:29:18.938826 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:29:18.938826 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:29:19.020678 [debug] [MainThread]: Connection 'model.hotel_booking.newlogos' was left open.
[0m14:29:19.021711 [debug] [MainThread]: On model.hotel_booking.newlogos: Close
[0m14:29:19.097954 [info ] [MainThread]: 
[0m14:29:19.098953 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m14:29:19.099974 [debug] [MainThread]: Command end result
[0m14:29:19.126299 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:29:19.129636 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:29:19.137768 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:29:19.137768 [info ] [MainThread]: 
[0m14:29:19.138773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:19.139767 [info ] [MainThread]: 
[0m14:29:19.140797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:29:19.141921 [debug] [MainThread]: Command `dbt build` succeeded at 14:29:19.141921 after 4.36 seconds
[0m14:29:19.142923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C8FB28A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C8FB1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C8FB2F30>]}
[0m14:29:19.142923 [debug] [MainThread]: Flushing usage events
[0m14:29:20.523889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:24.483106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8AC9A630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C876A67B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8A1DEF00>]}


============================== 14:34:24.498833 | 8362a475-064f-488a-b878-77e0dd27501e ==============================
[0m14:34:24.498833 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:34:24.498833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m new_cust', 'send_anonymous_usage_stats': 'True'}
[0m14:34:25.313889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8362a475-064f-488a-b878-77e0dd27501e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8CA4FA10>]}
[0m14:34:25.377525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8362a475-064f-488a-b878-77e0dd27501e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8B871220>]}
[0m14:34:25.393334 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:34:25.846201 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:34:26.084717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:34:26.084717 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\transform\new_cust.sql
[0m14:34:26.411086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8362a475-064f-488a-b878-77e0dd27501e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8CFC2960>]}
[0m14:34:26.478461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:34:26.490196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:34:26.569752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8362a475-064f-488a-b878-77e0dd27501e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8CD6CAA0>]}
[0m14:34:26.569752 [info ] [MainThread]: Found 8 models, 3 sources, 474 macros
[0m14:34:26.569752 [info ] [MainThread]: 
[0m14:34:26.569752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:26.569752 [info ] [MainThread]: 
[0m14:34:26.569752 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:26.582870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:34:26.707344 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:34:26.707344 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:34:26.707344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:27.776445 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.063 seconds
[0m14:34:27.783508 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:34:27.792442 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:34:27.792442 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:34:27.792442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:28.099577 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.306 seconds
[0m14:34:28.115315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8362a475-064f-488a-b878-77e0dd27501e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8CE95340>]}
[0m14:34:28.151130 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m14:34:28.151130 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m14:34:28.153135 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m14:34:28.153135 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m14:34:28.162898 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m14:34:28.165051 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m14:34:28.201291 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m14:34:28.203258 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m14:34:28.204291 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
recent_months AS (
    SELECT
        customer_id,
        first_purchase_date
    FROM customer_activity
    WHERE first_purchase_date >= DATEADD(month, -3, CURRENT_DATE)
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
)
SELECT
    rm.customer_id,
    cd.customername,
    cd.COMPANY,
    rm.first_purchase_date
FROM recent_months rm
JOIN customer_details cd ON rm.customer_id = cd.customer_id
ORDER BY rm.first_purchase_date
        );
[0m14:34:28.204291 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:28.778242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m14:34:28.811823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8362a475-064f-488a-b878-77e0dd27501e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C88046630>]}
[0m14:34:28.811823 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.new_cust ............................... [[32mSUCCESS 1[0m in 0.66s]
[0m14:34:28.811823 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m14:34:28.811823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:28.811823 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:34:28.811823 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:34:28.894991 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:34:28.894991 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:34:28.959874 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m14:34:28.959874 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m14:34:29.056196 [info ] [MainThread]: 
[0m14:34:29.058215 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m14:34:29.058215 [debug] [MainThread]: Command end result
[0m14:34:29.096029 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:34:29.096029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:34:29.096029 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:34:29.110904 [info ] [MainThread]: 
[0m14:34:29.111844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:29.112518 [info ] [MainThread]: 
[0m14:34:29.112518 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:34:29.112518 [debug] [MainThread]: Command `dbt build` succeeded at 14:34:29.112518 after 4.96 seconds
[0m14:34:29.112518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8A905730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8A1565D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8A156060>]}
[0m14:34:29.112518 [debug] [MainThread]: Flushing usage events
[0m14:34:30.219978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:47.155060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59E5061E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59E506150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59E505580>]}


============================== 14:38:47.160103 | c06ce2bb-7b33-4c61-9735-86a3a1dcbaf8 ==============================
[0m14:38:47.160103 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:38:47.161111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m new_cust', 'send_anonymous_usage_stats': 'True'}
[0m14:38:47.772019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c06ce2bb-7b33-4c61-9735-86a3a1dcbaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59F12FAD0>]}
[0m14:38:47.844753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c06ce2bb-7b33-4c61-9735-86a3a1dcbaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59F017170>]}
[0m14:38:47.844753 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:38:48.457701 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:38:50.069040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:38:50.069040 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m14:38:50.375949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c06ce2bb-7b33-4c61-9735-86a3a1dcbaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A0494350>]}
[0m14:38:50.450891 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:38:50.480803 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:38:50.575596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c06ce2bb-7b33-4c61-9735-86a3a1dcbaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A0535A90>]}
[0m14:38:50.576102 [info ] [MainThread]: Found 8 models, 3 sources, 474 macros
[0m14:38:50.576102 [info ] [MainThread]: 
[0m14:38:50.576102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:50.576102 [info ] [MainThread]: 
[0m14:38:50.576102 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:38:50.576102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:38:54.049639 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:38:54.049639 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:38:54.050639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:54.959815 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.914 seconds
[0m14:38:54.959815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:38:54.982841 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:38:54.982841 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:38:54.982841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:55.558036 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.588 seconds
[0m14:38:55.582014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c06ce2bb-7b33-4c61-9735-86a3a1dcbaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A07A5A30>]}
[0m14:38:55.589661 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m14:38:55.589661 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m14:38:55.589661 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m14:38:55.589661 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m14:38:55.589661 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m14:38:55.589661 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m14:38:55.627856 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m14:38:55.627856 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m14:38:55.642847 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (
 
WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
new_customers AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', first_purchase_date) AS period,
        first_purchase_date
    FROM customer_activity
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    nc.period,
    nc.customer_id,
    cd.customer_name,
    cd.COMPANY
FROM new_customers nc
JOIN customer_details cd
ON nc.customer_id = cd.customer_id
JOIN max_month mmo
ON nc.first_purchase_date > DATEADD(month, -3, mmo.max_date)
ORDER BY nc.period
        );
[0m14:38:55.643786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:38:56.107601 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc4-0000-e6c6-0008-ed5a0002777a
[0m14:38:56.123701 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 34 at position 4
invalid identifier 'CD.CUSTOMER_NAME'
[0m14:38:56.139718 [debug] [Thread-1 (]: Database Error in model new_cust (models\transform\new_cust.sql)
  000904 (42000): SQL compilation error: error line 34 at position 4
  invalid identifier 'CD.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\new_cust.sql
[0m14:38:56.139718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06ce2bb-7b33-4c61-9735-86a3a1dcbaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59D9C4140>]}
[0m14:38:56.139718 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.new_cust ........................... [[31mERROR[0m in 0.55s]
[0m14:38:56.139718 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m14:38:56.139718 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.new_cust' to be skipped because of status 'error'.  Reason: Database Error in model new_cust (models\transform\new_cust.sql)
  000904 (42000): SQL compilation error: error line 34 at position 4
  invalid identifier 'CD.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\new_cust.sql.
[0m14:38:56.139718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:56.139718 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:38:56.139718 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:38:56.220674 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:38:56.222607 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:38:56.293280 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m14:38:56.293280 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m14:38:56.373758 [info ] [MainThread]: 
[0m14:38:56.373758 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m14:38:56.390481 [debug] [MainThread]: Command end result
[0m14:38:56.411951 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:38:56.411951 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:38:56.428791 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:38:56.428791 [info ] [MainThread]: 
[0m14:38:56.428791 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:38:56.428791 [info ] [MainThread]: 
[0m14:38:56.428791 [error] [MainThread]:   Database Error in model new_cust (models\transform\new_cust.sql)
  000904 (42000): SQL compilation error: error line 34 at position 4
  invalid identifier 'CD.CUSTOMER_NAME'
  compiled code at target\run\hotel_booking\models\transform\new_cust.sql
[0m14:38:56.428791 [info ] [MainThread]: 
[0m14:38:56.428791 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:38:56.428791 [debug] [MainThread]: Command `dbt build` failed at 14:38:56.428791 after 9.60 seconds
[0m14:38:56.428791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59D93D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59D93E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59D93F800>]}
[0m14:38:56.428791 [debug] [MainThread]: Flushing usage events
[0m14:38:57.435477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:15.287580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141DE6E2B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141DDD37D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141DBC79160>]}


============================== 14:39:15.305271 | 614bafe3-86b7-4985-b0bc-bfc58966c708 ==============================
[0m14:39:15.305271 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:39:15.307277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -m new_cust', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:39:15.854305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '614bafe3-86b7-4985-b0bc-bfc58966c708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141DF2F1BE0>]}
[0m14:39:15.917743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '614bafe3-86b7-4985-b0bc-bfc58966c708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141DBC794F0>]}
[0m14:39:15.917743 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:39:16.370237 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:39:16.590904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:16.590904 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m14:39:16.888307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '614bafe3-86b7-4985-b0bc-bfc58966c708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141E09916A0>]}
[0m14:39:16.972675 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:39:16.976689 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:39:17.027991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '614bafe3-86b7-4985-b0bc-bfc58966c708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141E0A6DD60>]}
[0m14:39:17.027991 [info ] [MainThread]: Found 8 models, 3 sources, 474 macros
[0m14:39:17.030261 [info ] [MainThread]: 
[0m14:39:17.032270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:17.032270 [info ] [MainThread]: 
[0m14:39:17.032270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:17.032270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:39:17.149248 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:39:17.149248 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:39:17.149248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:17.905023 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.748 seconds
[0m14:39:17.910789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:39:17.924691 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:39:17.924691 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:39:17.924691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:18.218760 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.290 seconds
[0m14:39:18.230507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '614bafe3-86b7-4985-b0bc-bfc58966c708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141E0FD07D0>]}
[0m14:39:18.246365 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m14:39:18.246365 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m14:39:18.246365 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m14:39:18.246365 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m14:39:18.263390 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m14:39:18.265390 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m14:39:18.306677 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m14:39:18.309703 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m14:39:18.309703 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (
 
WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
new_customers AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', first_purchase_date) AS period,
        first_purchase_date
    FROM customer_activity
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    nc.period,
    nc.customer_id,
    cd.customername,
    cd.COMPANY
FROM new_customers nc
JOIN customer_details cd
ON nc.customer_id = cd.customer_id
JOIN max_month mmo
ON nc.first_purchase_date > DATEADD(month, -3, mmo.max_date)
ORDER BY nc.period
        );
[0m14:39:18.310702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:18.866859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m14:39:18.895001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '614bafe3-86b7-4985-b0bc-bfc58966c708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141DDBA41D0>]}
[0m14:39:18.896747 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.new_cust ............................... [[32mSUCCESS 1[0m in 0.65s]
[0m14:39:18.896747 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m14:39:18.896747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:18.896747 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:39:18.896747 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:39:18.965110 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:39:18.966154 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:39:19.032849 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m14:39:19.032849 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m14:39:19.097312 [info ] [MainThread]: 
[0m14:39:19.097312 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m14:39:19.097312 [debug] [MainThread]: Command end result
[0m14:39:19.137825 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:39:19.139826 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:39:19.139826 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:39:19.139826 [info ] [MainThread]: 
[0m14:39:19.139826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:19.139826 [info ] [MainThread]: 
[0m14:39:19.150505 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:39:19.151514 [debug] [MainThread]: Command `dbt build` succeeded at 14:39:19.151514 after 4.04 seconds
[0m14:39:19.152550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141DD7A67B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141DD7A47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141E0A7B9E0>]}
[0m14:39:19.152550 [debug] [MainThread]: Flushing usage events
[0m14:39:20.331441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:59.684751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9BC82990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9AAB13A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9CAD52B0>]}


============================== 14:40:59.687957 | 1df994a0-34c1-4215-99b4-da51315cb530 ==============================
[0m14:40:59.687957 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:40:59.687957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m new_cust', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:41:00.234076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1df994a0-34c1-4215-99b4-da51315cb530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9BC82990>]}
[0m14:41:00.297367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1df994a0-34c1-4215-99b4-da51315cb530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9CAAA270>]}
[0m14:41:00.297367 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:41:00.732740 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:41:00.924236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:00.924236 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m14:41:01.222074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1df994a0-34c1-4215-99b4-da51315cb530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9F076840>]}
[0m14:41:01.300242 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:41:01.300242 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:41:01.347576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1df994a0-34c1-4215-99b4-da51315cb530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9F17D610>]}
[0m14:41:01.363637 [info ] [MainThread]: Found 8 models, 3 sources, 474 macros
[0m14:41:01.363637 [info ] [MainThread]: 
[0m14:41:01.363637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:01.363637 [info ] [MainThread]: 
[0m14:41:01.363637 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:01.370727 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:41:01.487790 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:41:01.488793 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:41:01.488793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:02.270428 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.782 seconds
[0m14:41:02.270428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:41:02.286984 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:41:02.286984 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:41:02.286984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:02.721011 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.430 seconds
[0m14:41:02.725018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1df994a0-34c1-4215-99b4-da51315cb530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9F5C4B90>]}
[0m14:41:02.730771 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m14:41:02.730771 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m14:41:02.732790 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m14:41:02.732790 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m14:41:02.742808 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m14:41:02.744552 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m14:41:02.775019 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m14:41:02.775019 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m14:41:02.775019 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (
 
WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
new_customers AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', first_purchase_date) AS period,
        first_purchase_date
    FROM customer_activity
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT min(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    nc.period,
    nc.customer_id,
    cd.customername,
    cd.COMPANY
FROM new_customers nc
JOIN customer_details cd
ON nc.customer_id = cd.customer_id
JOIN max_month mmo
ON nc.first_purchase_date > DATEADD(month, -3, mmo.max_date)
ORDER BY nc.period
        );
[0m14:41:02.775019 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:03.796527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.012 seconds
[0m14:41:03.821897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df994a0-34c1-4215-99b4-da51315cb530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9A126B40>]}
[0m14:41:03.821897 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.new_cust ............................... [[32mSUCCESS 1[0m in 1.09s]
[0m14:41:03.821897 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m14:41:03.821897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:03.821897 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:41:03.821897 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:41:03.922562 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:41:03.923560 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:41:04.001194 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m14:41:04.001194 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m14:41:04.085307 [info ] [MainThread]: 
[0m14:41:04.085307 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m14:41:04.107427 [debug] [MainThread]: Command end result
[0m14:41:04.129796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:41:04.138346 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:41:04.147727 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:41:04.147727 [info ] [MainThread]: 
[0m14:41:04.147727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:04.147727 [info ] [MainThread]: 
[0m14:41:04.147727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:41:04.147727 [debug] [MainThread]: Command `dbt build` succeeded at 14:41:04.147727 after 4.72 seconds
[0m14:41:04.147727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9A4A0AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9A4A07A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9C67FFB0>]}
[0m14:41:04.147727 [debug] [MainThread]: Flushing usage events
[0m14:41:05.118306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:39.435988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238242A5A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023823E7D5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023821546870>]}


============================== 14:44:39.441565 | 63ad0d95-a0b8-4847-b117-e1527bd4142c ==============================
[0m14:44:39.441565 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:44:39.442531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_cust', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:44:40.038317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63ad0d95-a0b8-4847-b117-e1527bd4142c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023824278920>]}
[0m14:44:40.119955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63ad0d95-a0b8-4847-b117-e1527bd4142c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023824C34C80>]}
[0m14:44:40.121502 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:44:40.583023 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:44:40.771096 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:44:40.786458 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\transform\churn_cust.sql
[0m14:44:40.787278 [debug] [MainThread]: Partial parsing: deleted file: hotel_booking://models\transform\churn_new_cust.sql
[0m14:44:41.021304 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hotel_booking.churn_cust' (models\transform\churn_cust.sql) depends on a node named 'stg_transaction' which was not found
[0m14:44:41.021304 [debug] [MainThread]: Command `dbt build` failed at 14:44:41.021304 after 1.80 seconds
[0m14:44:41.021304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023823767D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023824DE0C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023824CE3440>]}
[0m14:44:41.021304 [debug] [MainThread]: Flushing usage events
[0m14:44:41.956688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:59.751269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001436DE72D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014370A417F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014370A43380>]}


============================== 14:44:59.759676 | ba6d5efc-6a57-4b03-a542-361c893180b2 ==============================
[0m14:44:59.759676 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:44:59.759676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -m churn_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:45:00.340649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba6d5efc-6a57-4b03-a542-361c893180b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001436DE72D50>]}
[0m14:45:00.407398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba6d5efc-6a57-4b03-a542-361c893180b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014371601640>]}
[0m14:45:00.407398 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:45:00.857252 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:45:01.052630 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:45:01.052630 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\transform\churn_cust.sql
[0m14:45:01.052630 [debug] [MainThread]: Partial parsing: deleted file: hotel_booking://models\transform\churn_new_cust.sql
[0m14:45:01.362168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba6d5efc-6a57-4b03-a542-361c893180b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014372F56A80>]}
[0m14:45:01.439324 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:45:01.439324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:45:01.502581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba6d5efc-6a57-4b03-a542-361c893180b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014372F06BD0>]}
[0m14:45:01.517329 [info ] [MainThread]: Found 8 models, 3 sources, 474 macros
[0m14:45:01.518337 [info ] [MainThread]: 
[0m14:45:01.518337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:01.518337 [info ] [MainThread]: 
[0m14:45:01.518337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:01.518337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:45:01.657052 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:45:01.657052 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:45:01.658024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:02.409337 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.759 seconds
[0m14:45:02.409337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:45:02.426063 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:45:02.426063 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:45:02.426063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:02.710788 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.275 seconds
[0m14:45:02.710788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6d5efc-6a57-4b03-a542-361c893180b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143734A5E50>]}
[0m14:45:02.726855 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_cust
[0m14:45:02.726855 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_cust .................................. [RUN]
[0m14:45:02.726855 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_cust'
[0m14:45:02.726855 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_cust
[0m14:45:02.726855 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_cust"
[0m14:45:02.743020 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_cust
[0m14:45:02.778831 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_cust"
[0m14:45:02.778831 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_cust"
[0m14:45:02.778831 [debug] [Thread-1 (]: On model.hotel_booking.churn_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    DATE_TRUNC('month', ca.last_purchase_date) AS period,
    COUNT(DISTINCT ca.customer_id) AS churned_customers,
    ca.customer_id,
    cd.customername,
    cd.COMPANY
FROM customer_activity ca
JOIN customer_details cd
ON ca.customer_id = cd.customer_id
JOIN max_month mmo
ON ca.last_purchase_date < DATEADD(month, -3, mmo.max_date)
GROUP BY DATE_TRUNC('month', ca.last_purchase_date), ca.customer_id, cd.customername, cd.COMPANY
ORDER BY period
        );
[0m14:45:02.778831 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:03.513699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m14:45:03.542477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6d5efc-6a57-4b03-a542-361c893180b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001436DF76CF0>]}
[0m14:45:03.543792 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_cust ............................. [[32mSUCCESS 1[0m in 0.80s]
[0m14:45:03.543792 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_cust
[0m14:45:03.543792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:03.543792 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:45:03.543792 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:45:03.619146 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:45:03.619146 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:45:03.692204 [debug] [MainThread]: Connection 'model.hotel_booking.churn_cust' was left open.
[0m14:45:03.692204 [debug] [MainThread]: On model.hotel_booking.churn_cust: Close
[0m14:45:03.772431 [info ] [MainThread]: 
[0m14:45:03.772431 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m14:45:03.772431 [debug] [MainThread]: Command end result
[0m14:45:03.817687 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:45:03.817687 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:45:03.827547 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:45:03.827547 [info ] [MainThread]: 
[0m14:45:03.827547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:03.827547 [info ] [MainThread]: 
[0m14:45:03.827547 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:45:03.827547 [debug] [MainThread]: Command `dbt build` succeeded at 14:45:03.827547 after 4.26 seconds
[0m14:45:03.827547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001437075D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014370416600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014370B5B7D0>]}
[0m14:45:03.827547 [debug] [MainThread]: Flushing usage events
[0m14:45:04.828684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:03.834746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B90D6CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B944A6DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9455FFB0>]}


============================== 14:56:03.834746 | 064b254b-2178-41a2-886a-7a60f5bcb5ba ==============================
[0m14:56:03.834746 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:56:03.834746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_prod', 'send_anonymous_usage_stats': 'True'}
[0m14:56:04.479798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '064b254b-2178-41a2-886a-7a60f5bcb5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9455C230>]}
[0m14:56:04.543196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '064b254b-2178-41a2-886a-7a60f5bcb5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B956D7A40>]}
[0m14:56:04.560398 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:56:05.165656 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:56:06.750649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:56:06.750649 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\transform\churn_prod.sql
[0m14:56:06.750649 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m14:56:07.056419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '064b254b-2178-41a2-886a-7a60f5bcb5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B96BE5A30>]}
[0m14:56:07.131683 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:56:07.147682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:56:07.231690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '064b254b-2178-41a2-886a-7a60f5bcb5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B96C753A0>]}
[0m14:56:07.231690 [info ] [MainThread]: Found 9 models, 3 sources, 474 macros
[0m14:56:07.234128 [info ] [MainThread]: 
[0m14:56:07.234837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:07.235412 [info ] [MainThread]: 
[0m14:56:07.235412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:56:07.237214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m14:56:10.649981 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m14:56:10.649981 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m14:56:10.649981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:12.237446 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.592 seconds
[0m14:56:12.251466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m14:56:12.267524 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m14:56:12.267524 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m14:56:12.267524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:12.606654 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.330 seconds
[0m14:56:12.609459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '064b254b-2178-41a2-886a-7a60f5bcb5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B96E2D340>]}
[0m14:56:12.622424 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_prod
[0m14:56:12.622424 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_prod .................................. [RUN]
[0m14:56:12.622424 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_prod'
[0m14:56:12.622424 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_prod
[0m14:56:12.622424 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_prod"
[0m14:56:12.638106 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_prod
[0m14:56:12.675729 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_prod"
[0m14:56:12.677965 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_prod"
[0m14:56:12.678998 [debug] [Thread-1 (]: On model.hotel_booking.churn_prod: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_prod"} */
create or replace transient table HOTEL_MGMT.stage.churn_prod
         as
        (WITH customer_product_activity AS (
    SELECT
        customer_id,
        product_id,
        MAX(payment_month) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY customer_id, product_id
),
max_month AS (
    SELECT MAX(payment_month) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
),
churned_products AS (
    SELECT
        cpa.customer_id,
        cpa.product_id,
        cpa.last_purchase_date,
        CASE
            WHEN cpa.last_purchase_date < DATEADD(month, -3, mm.max_date) THEN 1
            ELSE 0
        END AS is_churned
    FROM customer_product_activity cpa
    CROSS JOIN max_month mm
)
SELECT
    product_id,
    COUNT(DISTINCT customer_id) AS total_customers,
    SUM(is_churned) AS churned_customers,
    (SUM(is_churned) * 1.0 / COUNT(DISTINCT customer_id)) AS churn_rate
FROM churned_products
GROUP BY product_id
ORDER BY churn_rate DESC
        );
[0m14:56:12.678998 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:56:13.738506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.067 seconds
[0m14:56:13.770185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '064b254b-2178-41a2-886a-7a60f5bcb5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B91F26A80>]}
[0m14:56:13.770185 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_prod ............................. [[32mSUCCESS 1[0m in 1.15s]
[0m14:56:13.770185 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_prod
[0m14:56:13.770185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:13.770185 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m14:56:13.770185 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m14:56:13.844822 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m14:56:13.844822 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m14:56:13.925144 [debug] [MainThread]: Connection 'model.hotel_booking.churn_prod' was left open.
[0m14:56:13.925144 [debug] [MainThread]: On model.hotel_booking.churn_prod: Close
[0m14:56:14.011871 [info ] [MainThread]: 
[0m14:56:14.011871 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.78 seconds (6.78s).
[0m14:56:14.011871 [debug] [MainThread]: Command end result
[0m14:56:14.037138 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m14:56:14.037138 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m14:56:14.037138 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m14:56:14.037138 [info ] [MainThread]: 
[0m14:56:14.052805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:14.054050 [info ] [MainThread]: 
[0m14:56:14.055057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:56:14.056310 [debug] [MainThread]: Command `dbt build` succeeded at 14:56:14.056310 after 10.46 seconds
[0m14:56:14.057382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B92913500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B92913710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9499BE30>]}
[0m14:56:14.057382 [debug] [MainThread]: Flushing usage events
[0m14:56:15.388621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:53.917854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0EEE12B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0EDDDBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0EDDCA70>]}


============================== 15:02:53.934711 | aafc58de-8604-4178-9e8a-abc715835ca1 ==============================
[0m15:02:53.934711 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:02:53.934711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -m new_cust', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:02:54.482037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aafc58de-8604-4178-9e8a-abc715835ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0F77A300>]}
[0m15:02:54.540086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aafc58de-8604-4178-9e8a-abc715835ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0F3A0E30>]}
[0m15:02:54.555854 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:02:54.995922 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:02:55.201158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:55.201158 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m15:02:55.495936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aafc58de-8604-4178-9e8a-abc715835ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F11AB3050>]}
[0m15:02:55.560383 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:02:55.575483 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:02:55.622909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aafc58de-8604-4178-9e8a-abc715835ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0F293D40>]}
[0m15:02:55.622909 [info ] [MainThread]: Found 9 models, 3 sources, 474 macros
[0m15:02:55.622909 [info ] [MainThread]: 
[0m15:02:55.622909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:55.622909 [info ] [MainThread]: 
[0m15:02:55.622909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:55.622909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m15:02:55.744533 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m15:02:55.744533 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m15:02:55.744533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:56.540944 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.795 seconds
[0m15:02:56.558796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m15:02:56.558796 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m15:02:56.558796 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m15:02:56.558796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:56.916967 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.350 seconds
[0m15:02:56.916967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aafc58de-8604-4178-9e8a-abc715835ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F117F84A0>]}
[0m15:02:56.916967 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m15:02:56.932872 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m15:02:56.932872 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m15:02:56.932872 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m15:02:56.941486 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m15:02:56.943492 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m15:02:56.980320 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m15:02:56.983320 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m15:02:56.983320 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
new_customers AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', first_purchase_date) AS period,
        first_purchase_date
    FROM customer_activity
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT min(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    nc.period,
    nc.customer_id,
    cd.customername,
    cd.COMPANY
FROM new_customers nc
JOIN customer_details cd
ON nc.customer_id = cd.customer_id
JOIN max_month mmo
ON nc.first_purchase_date < DATEADD(month, -3, mmo.max_date)
ORDER BY nc.period
        );
[0m15:02:56.984318 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:02:57.748600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m15:02:57.791544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aafc58de-8604-4178-9e8a-abc715835ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0EC04290>]}
[0m15:02:57.792580 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.new_cust ............................... [[32mSUCCESS 1[0m in 0.86s]
[0m15:02:57.793546 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m15:02:57.794537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:57.795578 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m15:02:57.795974 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m15:02:57.864537 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m15:02:57.864537 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m15:02:57.945941 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m15:02:57.946952 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m15:02:58.014478 [info ] [MainThread]: 
[0m15:02:58.014478 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m15:02:58.014478 [debug] [MainThread]: Command end result
[0m15:02:58.056682 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:02:58.059666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:02:58.066817 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m15:02:58.067785 [info ] [MainThread]: 
[0m15:02:58.068800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:58.069690 [info ] [MainThread]: 
[0m15:02:58.071707 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:02:58.073714 [debug] [MainThread]: Command `dbt build` succeeded at 15:02:58.073714 after 4.42 seconds
[0m15:02:58.073714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0EF2FA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0D2B2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F117F8EC0>]}
[0m15:02:58.073714 [debug] [MainThread]: Flushing usage events
[0m15:02:59.453071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:24.885925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F15487590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F154872F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F16B83CE0>]}


============================== 15:03:24.891948 | 4447f3ad-5037-4069-9745-f6cce70b9ce7 ==============================
[0m15:03:24.891948 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:03:24.893696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m new_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:03:25.427476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4447f3ad-5037-4069-9745-f6cce70b9ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F176F6690>]}
[0m15:03:25.510668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4447f3ad-5037-4069-9745-f6cce70b9ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F16BE0F20>]}
[0m15:03:25.512173 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:03:25.943981 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:03:26.134060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:03:26.134060 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m15:03:26.430511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4447f3ad-5037-4069-9745-f6cce70b9ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F199E32C0>]}
[0m15:03:26.494102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:03:26.513011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:03:26.557283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4447f3ad-5037-4069-9745-f6cce70b9ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F198535F0>]}
[0m15:03:26.557283 [info ] [MainThread]: Found 9 models, 3 sources, 474 macros
[0m15:03:26.557283 [info ] [MainThread]: 
[0m15:03:26.557283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:03:26.557283 [info ] [MainThread]: 
[0m15:03:26.557283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:03:26.557283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m15:03:26.675135 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m15:03:26.675135 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m15:03:26.675135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:27.816090 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.130 seconds
[0m15:03:27.823019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m15:03:27.825761 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m15:03:27.825761 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m15:03:27.825761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:28.144887 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.311 seconds
[0m15:03:28.152965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4447f3ad-5037-4069-9745-f6cce70b9ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F199A20C0>]}
[0m15:03:28.160675 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m15:03:28.160675 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m15:03:28.160675 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m15:03:28.160675 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m15:03:28.160675 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m15:03:28.176512 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m15:03:28.213416 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m15:03:28.215384 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m15:03:28.216417 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
new_customers AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', first_purchase_date) AS period,
        first_purchase_date
    FROM customer_activity
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT min(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    nc.period,
    nc.customer_id,
    cd.customername,
    cd.COMPANY
FROM new_customers nc
JOIN customer_details cd
ON nc.customer_id = cd.customer_id
JOIN max_month mmo
ON nc.first_purchase_date > DATEADD(month, -3, mmo.max_date)
ORDER BY nc.period
        );
[0m15:03:28.216417 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:03:28.927154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m15:03:28.958822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4447f3ad-5037-4069-9745-f6cce70b9ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F16BB4440>]}
[0m15:03:28.958822 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.new_cust ............................... [[32mSUCCESS 1[0m in 0.80s]
[0m15:03:28.958822 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m15:03:28.958822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:28.958822 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m15:03:28.958822 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m15:03:29.038333 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m15:03:29.039336 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m15:03:29.125191 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m15:03:29.127201 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m15:03:29.203955 [info ] [MainThread]: 
[0m15:03:29.205978 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m15:03:29.205978 [debug] [MainThread]: Command end result
[0m15:03:29.244581 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:03:29.244581 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:03:29.261330 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m15:03:29.261330 [info ] [MainThread]: 
[0m15:03:29.261330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:29.261330 [info ] [MainThread]: 
[0m15:03:29.261330 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:03:29.261330 [debug] [MainThread]: Command `dbt build` succeeded at 15:03:29.261330 after 4.57 seconds
[0m15:03:29.261330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F19724140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F181410D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F18140350>]}
[0m15:03:29.261330 [debug] [MainThread]: Flushing usage events
[0m15:03:30.267950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:58.339837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB1FE2A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB1FE0D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB1FE1820>]}


============================== 15:03:58.339837 | 1aa4b88a-21e3-489e-80a6-d209c961e05a ==============================
[0m15:03:58.339837 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:03:58.339837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -m new_cust', 'send_anonymous_usage_stats': 'True'}
[0m15:03:59.031850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aa4b88a-21e3-489e-80a6-d209c961e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB33FC170>]}
[0m15:03:59.112812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aa4b88a-21e3-489e-80a6-d209c961e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB368F170>]}
[0m15:03:59.113812 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:03:59.596249 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:03:59.831408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:03:59.832695 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m15:04:00.162062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aa4b88a-21e3-489e-80a6-d209c961e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB4DE72C0>]}
[0m15:04:00.248434 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:04:00.252470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:04:00.312153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aa4b88a-21e3-489e-80a6-d209c961e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB4CA1490>]}
[0m15:04:00.313154 [info ] [MainThread]: Found 9 models, 3 sources, 474 macros
[0m15:04:00.314818 [info ] [MainThread]: 
[0m15:04:00.321350 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:00.322366 [info ] [MainThread]: 
[0m15:04:00.323392 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:04:00.325394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m15:04:00.449165 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m15:04:00.449165 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m15:04:00.450166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:01.494102 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.052 seconds
[0m15:04:01.532799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m15:04:01.560600 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m15:04:01.577255 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m15:04:01.577255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:01.966732 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.390 seconds
[0m15:04:01.966732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa4b88a-21e3-489e-80a6-d209c961e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB54116D0>]}
[0m15:04:01.966732 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m15:04:01.966732 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m15:04:01.966732 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m15:04:01.966732 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m15:04:01.982699 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m15:04:01.982699 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m15:04:02.026914 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m15:04:02.031910 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m15:04:02.031910 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
new_customers AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', first_purchase_date) AS period,
        first_purchase_date
    FROM customer_activity
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT max(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    nc.period,
    nc.customer_id,
    cd.customername,
    cd.COMPANY
FROM new_customers nc
JOIN customer_details cd
ON nc.customer_id = cd.customer_id
JOIN max_month mmo
ON nc.first_purchase_date > DATEADD(month, -3, mmo.max_date)
ORDER BY nc.period
        );
[0m15:04:02.031910 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:04:02.622995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m15:04:02.666929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa4b88a-21e3-489e-80a6-d209c961e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB1FB41D0>]}
[0m15:04:02.667937 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.new_cust ............................... [[32mSUCCESS 1[0m in 0.70s]
[0m15:04:02.668428 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m15:04:02.670435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:02.671118 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m15:04:02.671118 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m15:04:02.737324 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m15:04:02.738323 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m15:04:02.820200 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m15:04:02.820200 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m15:04:02.904509 [info ] [MainThread]: 
[0m15:04:02.904509 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m15:04:02.904509 [debug] [MainThread]: Command end result
[0m15:04:02.937951 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:04:02.940949 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:04:02.945507 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m15:04:02.945507 [info ] [MainThread]: 
[0m15:04:02.945507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:02.945507 [info ] [MainThread]: 
[0m15:04:02.945507 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:04:02.945507 [debug] [MainThread]: Command `dbt build` succeeded at 15:04:02.945507 after 4.82 seconds
[0m15:04:02.945507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FAFF3FD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB23DA780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB2699B50>]}
[0m15:04:02.945507 [debug] [MainThread]: Flushing usage events
[0m15:04:03.921780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:05.674239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE4D96660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE75FEF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE5200CB0>]}


============================== 15:06:05.674239 | 38003123-cc60-4e2f-b057-fca400bc38d2 ==============================
[0m15:06:05.674239 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:06:05.674239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m new_cust', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:06:06.333053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38003123-cc60-4e2f-b057-fca400bc38d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE749B500>]}
[0m15:06:06.400639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38003123-cc60-4e2f-b057-fca400bc38d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE7B46240>]}
[0m15:06:06.400639 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:06:06.985151 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:06:08.640290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:08.640290 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m15:06:08.859399 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hotel_booking.new_cust' (models\transform\new_cust.sql) depends on a node named 'stg_transaction' which was not found
[0m15:06:08.859399 [debug] [MainThread]: Command `dbt build` failed at 15:06:08.859399 after 3.45 seconds
[0m15:06:08.859399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE7248C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE199F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE9B7A9C0>]}
[0m15:06:08.863977 [debug] [MainThread]: Flushing usage events
[0m15:06:09.863102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:25.034440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017485BA2DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017485BA0FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017485BA2900>]}


============================== 15:06:25.034440 | 54b63475-de0c-4d32-9b68-d089b225d09b ==============================
[0m15:06:25.034440 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:06:25.034440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m new_cust', 'send_anonymous_usage_stats': 'True'}
[0m15:06:25.583791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b63475-de0c-4d32-9b68-d089b225d09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001748741BC20>]}
[0m15:06:25.663136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54b63475-de0c-4d32-9b68-d089b225d09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174873061B0>]}
[0m15:06:25.663136 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:06:26.084921 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:06:26.274474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:26.274474 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m15:06:26.571321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54b63475-de0c-4d32-9b68-d089b225d09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017488993080>]}
[0m15:06:26.648511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:06:26.666680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:06:26.749781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54b63475-de0c-4d32-9b68-d089b225d09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174886D4230>]}
[0m15:06:26.752952 [info ] [MainThread]: Found 9 models, 3 sources, 474 macros
[0m15:06:26.755405 [info ] [MainThread]: 
[0m15:06:26.755405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:06:26.755405 [info ] [MainThread]: 
[0m15:06:26.755405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:26.755405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m15:06:30.115350 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m15:06:30.115350 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m15:06:30.115350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:30.938673 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.828 seconds
[0m15:06:30.938673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m15:06:30.954449 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m15:06:30.954449 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m15:06:30.954449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:31.314588 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.356 seconds
[0m15:06:31.324293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54b63475-de0c-4d32-9b68-d089b225d09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017488993020>]}
[0m15:06:31.324293 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m15:06:31.324293 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m15:06:31.324293 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m15:06:31.324293 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m15:06:31.342610 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m15:06:31.343609 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m15:06:31.376890 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m15:06:31.376890 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m15:06:31.376890 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    DATE_TRUNC('month', ca.last_purchase_date) AS period,
    COUNT(DISTINCT ca.customer_id) AS churned_customers,
    ca.customer_id,
    cd.customername,
    cd.COMPANY
FROM customer_activity ca
JOIN customer_details cd
ON ca.customer_id = cd.customer_id
JOIN max_month mmo
ON ca.last_purchase_date < DATEADD(month, -3, mmo.max_date)
GROUP BY DATE_TRUNC('month', ca.last_purchase_date), ca.customer_id, cd.customername, cd.COMPANY
ORDER BY period
        );
[0m15:06:31.376890 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:06:32.265104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m15:06:32.292943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b63475-de0c-4d32-9b68-d089b225d09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017483A666C0>]}
[0m15:06:32.292943 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.new_cust ............................... [[32mSUCCESS 1[0m in 0.97s]
[0m15:06:32.292943 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m15:06:32.296992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:32.296992 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m15:06:32.296992 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m15:06:32.363677 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m15:06:32.364715 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m15:06:32.447904 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m15:06:32.447904 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m15:06:32.523537 [info ] [MainThread]: 
[0m15:06:32.526574 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m15:06:32.526574 [debug] [MainThread]: Command end result
[0m15:06:32.552932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:06:32.560343 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:06:32.560343 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m15:06:32.560343 [info ] [MainThread]: 
[0m15:06:32.560343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:32.560343 [info ] [MainThread]: 
[0m15:06:32.560343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:06:32.560343 [debug] [MainThread]: Command `dbt build` succeeded at 15:06:32.560343 after 7.74 seconds
[0m15:06:32.560343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017487306180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017487306030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017487307230>]}
[0m15:06:32.560343 [debug] [MainThread]: Flushing usage events
[0m15:06:33.591048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:59.704569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D5D24110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D59C52B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D545C920>]}


============================== 15:08:59.712622 | 30c2c4bb-8a7f-48bc-8d07-d13af746bbd7 ==============================
[0m15:08:59.712622 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:08:59.712622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m new_cust', 'send_anonymous_usage_stats': 'True'}
[0m15:09:00.285392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30c2c4bb-8a7f-48bc-8d07-d13af746bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D5CF99D0>]}
[0m15:09:00.348647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30c2c4bb-8a7f-48bc-8d07-d13af746bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D69E3FE0>]}
[0m15:09:00.348647 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:09:00.773096 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:09:00.988588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:00.988588 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m15:09:01.210772 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hotel_booking.new_cust' (models\transform\new_cust.sql) depends on a node named 'stg_transaction' which was not found
[0m15:09:01.210772 [debug] [MainThread]: Command `dbt build` failed at 15:09:01.210772 after 1.70 seconds
[0m15:09:01.210772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D570FE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D7DA6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D7CA4BF0>]}
[0m15:09:01.210772 [debug] [MainThread]: Flushing usage events
[0m15:09:02.623865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:17.451785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016055C7E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016055A7C860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016055A7F9B0>]}


============================== 15:09:17.457496 | 1d1134b2-02db-496e-b1ec-b3f849fa64b9 ==============================
[0m15:09:17.457496 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:09:17.457496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m new_cust', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:09:18.018055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d1134b2-02db-496e-b1ec-b3f849fa64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001605588C620>]}
[0m15:09:18.097088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d1134b2-02db-496e-b1ec-b3f849fa64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016053A39160>]}
[0m15:09:18.097088 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:09:18.550758 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:09:18.758234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:18.760241 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\transform\new_cust.sql
[0m15:09:19.069561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d1134b2-02db-496e-b1ec-b3f849fa64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160586E2990>]}
[0m15:09:19.149354 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:09:19.149354 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:09:19.212441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d1134b2-02db-496e-b1ec-b3f849fa64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016058424290>]}
[0m15:09:19.214450 [info ] [MainThread]: Found 9 models, 3 sources, 474 macros
[0m15:09:19.216457 [info ] [MainThread]: 
[0m15:09:19.216457 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:09:19.216457 [info ] [MainThread]: 
[0m15:09:19.216457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:09:19.216457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m15:09:19.341019 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m15:09:19.341019 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m15:09:19.341019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:20.153106 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.814 seconds
[0m15:09:20.153106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m15:09:20.176804 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m15:09:20.176804 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m15:09:20.176804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:20.522982 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.347 seconds
[0m15:09:20.539631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d1134b2-02db-496e-b1ec-b3f849fa64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016058B0A180>]}
[0m15:09:20.544735 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m15:09:20.544735 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m15:09:20.545778 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m15:09:20.546776 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m15:09:20.556506 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m15:09:20.557610 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m15:09:20.593971 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m15:09:20.597078 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m15:09:20.598077 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
new_customers AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', first_purchase_date) AS period,
        first_purchase_date
    FROM customer_activity
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    nc.period,
    nc.customer_id,
    cd.customername,
    cd.COMPANY
FROM new_customers nc
JOIN customer_details cd
ON nc.customer_id = cd.customer_id
JOIN max_month mmo
ON nc.first_purchase_date > DATEADD(month, -3, mmo.max_date)
ORDER BY nc.period
        );
[0m15:09:20.598077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:09:21.255934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m15:09:21.303517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1134b2-02db-496e-b1ec-b3f849fa64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160537F65A0>]}
[0m15:09:21.303517 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.new_cust ............................... [[32mSUCCESS 1[0m in 0.76s]
[0m15:09:21.303517 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m15:09:21.319182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:21.319182 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m15:09:21.319182 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m15:09:21.396076 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m15:09:21.396076 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m15:09:21.477015 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m15:09:21.477015 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m15:09:21.575861 [info ] [MainThread]: 
[0m15:09:21.575861 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m15:09:21.575861 [debug] [MainThread]: Command end result
[0m15:09:21.614138 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:09:21.617179 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:09:21.619179 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m15:09:21.619179 [info ] [MainThread]: 
[0m15:09:21.619179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:21.619179 [info ] [MainThread]: 
[0m15:09:21.619179 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:21.627812 [debug] [MainThread]: Command `dbt build` succeeded at 15:09:21.627812 after 4.37 seconds
[0m15:09:21.628822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016053B37F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001605623C8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016055A32030>]}
[0m15:09:21.628822 [debug] [MainThread]: Flushing usage events
[0m15:09:22.549418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:19.133207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5DF69CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E2E5E540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E2E5CEC0>]}


============================== 15:10:19.133207 | f9200ae9-17b8-4c58-ac8a-c5050f20b93a ==============================
[0m15:10:19.133207 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:10:19.133207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m new_cust', 'send_anonymous_usage_stats': 'True'}
[0m15:10:19.819505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9200ae9-17b8-4c58-ac8a-c5050f20b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E404EDB0>]}
[0m15:10:19.898156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9200ae9-17b8-4c58-ac8a-c5050f20b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E3F039E0>]}
[0m15:10:19.900175 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:10:20.354307 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:10:20.554682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:10:20.554682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:10:20.589129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9200ae9-17b8-4c58-ac8a-c5050f20b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E5444A10>]}
[0m15:10:20.687152 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:10:20.689191 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:10:20.737191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9200ae9-17b8-4c58-ac8a-c5050f20b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E563CD70>]}
[0m15:10:20.737191 [info ] [MainThread]: Found 9 models, 3 sources, 474 macros
[0m15:10:20.753755 [info ] [MainThread]: 
[0m15:10:20.753755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:10:20.753755 [info ] [MainThread]: 
[0m15:10:20.753755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:10:20.758832 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m15:10:20.885737 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m15:10:20.885737 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m15:10:20.885737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:21.716394 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.842 seconds
[0m15:10:21.736524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m15:10:21.748533 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m15:10:21.748533 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m15:10:21.748533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:22.124963 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.376 seconds
[0m15:10:22.129965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9200ae9-17b8-4c58-ac8a-c5050f20b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E34B0FE0>]}
[0m15:10:22.135960 [debug] [Thread-1 (]: Began running node model.hotel_booking.new_cust
[0m15:10:22.136963 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.new_cust .................................... [RUN]
[0m15:10:22.137963 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.new_cust'
[0m15:10:22.138964 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.new_cust
[0m15:10:22.148641 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.new_cust"
[0m15:10:22.150648 [debug] [Thread-1 (]: Began executing node model.hotel_booking.new_cust
[0m15:10:22.191501 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.new_cust"
[0m15:10:22.191501 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.new_cust"
[0m15:10:22.199805 [debug] [Thread-1 (]: On model.hotel_booking.new_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.new_cust"} */
create or replace transient table HOTEL_MGMT.stage.new_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
 
new_customers AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', first_purchase_date) AS period,
        first_purchase_date
    FROM customer_activity
),
 
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
 
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
)
 
SELECT
    nc.period,
    nc.customer_id,
    cd.customername,
    cd.COMPANY
FROM new_customers nc
JOIN customer_details cd
ON nc.customer_id = cd.customer_id
JOIN max_month mmo
ON nc.first_purchase_date > DATEADD(month, -3, mmo.max_date)
ORDER BY nc.period
        );
[0m15:10:22.199805 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:10:23.369832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.182 seconds
[0m15:10:23.401677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9200ae9-17b8-4c58-ac8a-c5050f20b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E090C7A0>]}
[0m15:10:23.401677 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.new_cust ............................... [[32mSUCCESS 1[0m in 1.26s]
[0m15:10:23.401677 [debug] [Thread-1 (]: Finished running node model.hotel_booking.new_cust
[0m15:10:23.401677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:23.401677 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m15:10:23.401677 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m15:10:23.488657 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m15:10:23.489574 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m15:10:23.565501 [debug] [MainThread]: Connection 'model.hotel_booking.new_cust' was left open.
[0m15:10:23.565501 [debug] [MainThread]: On model.hotel_booking.new_cust: Close
[0m15:10:23.890391 [info ] [MainThread]: 
[0m15:10:23.890391 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m15:10:23.890391 [debug] [MainThread]: Command end result
[0m15:10:23.912411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m15:10:23.912411 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m15:10:23.930608 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m15:10:23.930608 [info ] [MainThread]: 
[0m15:10:23.931244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:23.933308 [info ] [MainThread]: 
[0m15:10:23.934299 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:10:23.935299 [debug] [MainThread]: Command `dbt build` succeeded at 15:10:23.935299 after 4.99 seconds
[0m15:10:23.935299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E291AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E291A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5E291B380>]}
[0m15:10:23.935299 [debug] [MainThread]: Flushing usage events
[0m15:10:24.924513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:37.821958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB6AD5A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB4AF2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB651F1D0>]}


============================== 15:16:37.832126 | dd031714-dcfa-4cde-8ca5-7167eb17d3d1 ==============================
[0m15:16:37.832126 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:16:37.833125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:16:38.419704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd031714-dcfa-4cde-8ca5-7167eb17d3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB43A41D0>]}
[0m15:16:38.534757 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:16:38.536758 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:16:38.540760 [debug] [MainThread]: Command `cli deps` succeeded at 15:16:38.540760 after 6.58 seconds
[0m15:16:38.540760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB4AF2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB6B3A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB6B389E0>]}
[0m15:16:38.541757 [debug] [MainThread]: Flushing usage events
[0m15:16:40.272855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:23:30.324261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF6226780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF6D33230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF6D330E0>]}


============================== 18:23:30.324261 | 66113300-0910-41af-9a16-d84ff4f2ec40 ==============================
[0m18:23:30.324261 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:23:30.324261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:23:30.358238 [info ] [MainThread]: dbt version: 1.9.3
[0m18:23:30.359271 [info ] [MainThread]: python version: 3.12.5
[0m18:23:30.360738 [info ] [MainThread]: python path: c:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\.venv\Scripts\python.exe
[0m18:23:30.361135 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m18:23:30.732987 [info ] [MainThread]: Using profiles dir at C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking
[0m18:23:30.732987 [info ] [MainThread]: Using profiles.yml file at C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\profiles.yml
[0m18:23:30.732987 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\dbt_project.yml
[0m18:23:30.732987 [info ] [MainThread]: adapter type: snowflake
[0m18:23:30.732987 [info ] [MainThread]: adapter version: 1.9.2
[0m18:23:30.860454 [info ] [MainThread]: Configuration:
[0m18:23:30.861435 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:23:30.862457 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:23:30.862457 [info ] [MainThread]: Required dependencies:
[0m18:23:30.863992 [debug] [MainThread]: Executing "git --help"
[0m18:23:30.934524 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:23:30.934524 [debug] [MainThread]: STDERR: "b''"
[0m18:23:30.935523 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:23:30.936205 [info ] [MainThread]: Connection:
[0m18:23:30.937215 [info ] [MainThread]:   account: AMITJNS-CT72498
[0m18:23:30.938228 [info ] [MainThread]:   user: MANASA26
[0m18:23:30.938228 [info ] [MainThread]:   database: HOTEL_MGMT
[0m18:23:30.939246 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m18:23:30.940256 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m18:23:30.940256 [info ] [MainThread]:   schema: stage
[0m18:23:30.941267 [info ] [MainThread]:   authenticator: None
[0m18:23:30.942265 [info ] [MainThread]:   oauth_client_id: None
[0m18:23:30.943267 [info ] [MainThread]:   query_tag: None
[0m18:23:30.944266 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:23:30.945281 [info ] [MainThread]:   host: None
[0m18:23:30.946265 [info ] [MainThread]:   port: None
[0m18:23:30.946265 [info ] [MainThread]:   proxy_host: None
[0m18:23:30.947265 [info ] [MainThread]:   proxy_port: None
[0m18:23:30.948262 [info ] [MainThread]:   protocol: None
[0m18:23:30.949266 [info ] [MainThread]:   connect_retries: 1
[0m18:23:30.950269 [info ] [MainThread]:   connect_timeout: None
[0m18:23:30.951269 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:23:30.952665 [info ] [MainThread]:   retry_all: False
[0m18:23:30.953677 [info ] [MainThread]:   insecure_mode: False
[0m18:23:30.953677 [info ] [MainThread]:   reuse_connections: True
[0m18:23:30.955682 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:23:31.497226 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:23:31.603880 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:23:31.603880 [debug] [MainThread]: On debug: select 1 as id
[0m18:23:31.603880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:32.444119 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.843 seconds
[0m18:23:32.444119 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:23:32.444119 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:23:32.444119 [debug] [MainThread]: Command `dbt debug` succeeded at 18:23:32.444119 after 2.35 seconds
[0m18:23:32.459889 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:23:32.459889 [debug] [MainThread]: On debug: Close
[0m18:23:32.531111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF854FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF83F9A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF9B99670>]}
[0m18:23:32.531111 [debug] [MainThread]: Flushing usage events
[0m18:23:33.564577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:23:46.563093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA9A173E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA9A174A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA9A17380>]}


============================== 18:23:46.573228 | 3609c401-c9c5-453d-b703-8d69f882b22b ==============================
[0m18:23:46.573228 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:23:46.575238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m churn_cust', 'send_anonymous_usage_stats': 'True'}
[0m18:23:47.128381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3609c401-c9c5-453d-b703-8d69f882b22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAB7DE600>]}
[0m18:23:47.211760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3609c401-c9c5-453d-b703-8d69f882b22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAD9EFCE0>]}
[0m18:23:47.227943 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:23:47.749256 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:23:47.958215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:47.960221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:47.996035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3609c401-c9c5-453d-b703-8d69f882b22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAC9CB590>]}
[0m18:23:48.079314 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:23:48.130031 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:23:48.231978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3609c401-c9c5-453d-b703-8d69f882b22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAADDCB3E0>]}
[0m18:23:48.231978 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:23:48.236630 [info ] [MainThread]: 
[0m18:23:48.236630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:48.236630 [info ] [MainThread]: 
[0m18:23:48.236630 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:23:48.240942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:23:48.379646 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:23:48.381653 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:23:48.381653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:49.185396 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.811 seconds
[0m18:23:49.201226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m18:23:49.203234 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:23:49.203234 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:23:49.203234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:49.596559 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.381 seconds
[0m18:23:49.602134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3609c401-c9c5-453d-b703-8d69f882b22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAADDCB3E0>]}
[0m18:23:49.629378 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_cust
[0m18:23:49.630378 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_cust .................................. [RUN]
[0m18:23:49.631652 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_cust'
[0m18:23:49.632661 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_cust
[0m18:23:49.642097 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_cust"
[0m18:23:49.643912 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_cust
[0m18:23:49.686431 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_cust"
[0m18:23:49.690395 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_cust"
[0m18:23:49.690395 [debug] [Thread-1 (]: On model.hotel_booking.churn_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
),
churned_customers AS (
    SELECT
        ca.customer_id,
        ca.last_purchase_date,
        SUM(t.revenue) AS total_revenue,
        CASE
            WHEN ca.last_purchase_date < DATEADD(month, -1, mm.max_date)
            THEN 1 ELSE 0
        END AS is_churned
    FROM customer_activity ca
    JOIN HOTEL_MGMT.stage.stg_transactions t ON ca.customer_id = t.customer_id
    CROSS JOIN max_month mm
    GROUP BY ca.customer_id, ca.last_purchase_date, mm.max_date
)
SELECT
    DATE_TRUNC('month', cc.last_purchase_date) AS period,
    COUNT(DISTINCT CASE WHEN cc.is_churned = 1 THEN cc.customer_id END) AS churned_customers,
    cc.customer_id,
    cd.customername,
    cd.COMPANY,
    cc.total_revenue AS churned_revenue
FROM churned_customers cc
JOIN customer_details cd ON cc.customer_id = cd.customer_id
WHERE cc.is_churned = 1
GROUP BY DATE_TRUNC('month', cc.last_purchase_date), cc.customer_id, cd.customername, cd.COMPANY, cc.total_revenue
ORDER BY period;
[0m18:23:49.691395 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:23:50.143605 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00a5-0000-e6d0-0008-ed5a00024a9e
[0m18:23:50.158380 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 43 at position 15 unexpected ';'.
[0m18:23:50.175522 [debug] [Thread-1 (]: Database Error in model churn_cust (models\mart\churn_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 15 unexpected ';'.
  compiled code at target\run\hotel_booking\models\mart\churn_cust.sql
[0m18:23:50.177532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3609c401-c9c5-453d-b703-8d69f882b22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAB138110>]}
[0m18:23:50.177532 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_cust ......................... [[31mERROR[0m in 0.54s]
[0m18:23:50.177532 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_cust
[0m18:23:50.177532 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_cust (models\mart\churn_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 15 unexpected ';'.
  compiled code at target\run\hotel_booking\models\mart\churn_cust.sql.
[0m18:23:50.177532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:50.177532 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:23:50.177532 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:23:50.257704 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:23:50.258174 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:23:50.328760 [debug] [MainThread]: Connection 'model.hotel_booking.churn_cust' was left open.
[0m18:23:50.329759 [debug] [MainThread]: On model.hotel_booking.churn_cust: Close
[0m18:23:50.409278 [info ] [MainThread]: 
[0m18:23:50.409278 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m18:23:50.411286 [debug] [MainThread]: Command end result
[0m18:23:50.443531 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:23:50.445541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:23:50.457148 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:23:50.457148 [info ] [MainThread]: 
[0m18:23:50.457148 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:23:50.457148 [info ] [MainThread]: 
[0m18:23:50.457148 [error] [MainThread]:   Database Error in model churn_cust (models\mart\churn_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 15 unexpected ';'.
  compiled code at target\run\hotel_booking\models\mart\churn_cust.sql
[0m18:23:50.457148 [info ] [MainThread]: 
[0m18:23:50.457148 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:23:50.457148 [debug] [MainThread]: Command `dbt build` failed at 18:23:50.457148 after 4.27 seconds
[0m18:23:50.465802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAB161130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAB1610A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAB5F21B0>]}
[0m18:23:50.467881 [debug] [MainThread]: Flushing usage events
[0m18:23:51.442162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:01.301746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD622D9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD622D88C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD622D9F40>]}


============================== 18:24:01.306718 | 1b1c04e4-467c-4f0a-8bc2-b4cc6b746821 ==============================
[0m18:24:01.306718 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:24:01.307716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:24:01.790117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b1c04e4-467c-4f0a-8bc2-b4cc6b746821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD63CAE720>]}
[0m18:24:01.858507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b1c04e4-467c-4f0a-8bc2-b4cc6b746821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD62C3AC30>]}
[0m18:24:01.858507 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:24:02.293780 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:24:02.487316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:02.487316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:02.518698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b1c04e4-467c-4f0a-8bc2-b4cc6b746821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD63CAF7D0>]}
[0m18:24:02.599323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:24:02.599323 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:24:02.645080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b1c04e4-467c-4f0a-8bc2-b4cc6b746821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6508ABA0>]}
[0m18:24:02.645080 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:24:02.645080 [info ] [MainThread]: 
[0m18:24:02.659347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:02.659347 [info ] [MainThread]: 
[0m18:24:02.661097 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:24:02.661097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:24:02.780102 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:24:02.780102 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:24:02.780102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:04.230982 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.444 seconds
[0m18:24:04.230982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m18:24:04.250638 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:24:04.250638 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:24:04.250638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:04.878305 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.636 seconds
[0m18:24:04.888338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b1c04e4-467c-4f0a-8bc2-b4cc6b746821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD63D43410>]}
[0m18:24:04.894086 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_cust
[0m18:24:04.894086 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_cust .................................. [RUN]
[0m18:24:04.894086 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_cust'
[0m18:24:04.894086 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_cust
[0m18:24:04.894086 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_cust"
[0m18:24:04.910008 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_cust
[0m18:24:04.946373 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_cust"
[0m18:24:04.946373 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_cust"
[0m18:24:04.946373 [debug] [Thread-1 (]: On model.hotel_booking.churn_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
),
churned_customers AS (
    SELECT
        ca.customer_id,
        ca.last_purchase_date,
        SUM(t.revenue) AS total_revenue,
        CASE
            WHEN ca.last_purchase_date < DATEADD(month, -1, mm.max_date)
            THEN 1 ELSE 0
        END AS is_churned
    FROM customer_activity ca
    JOIN HOTEL_MGMT.stage.stg_transactions t ON ca.customer_id = t.customer_id
    CROSS JOIN max_month mm
    GROUP BY ca.customer_id, ca.last_purchase_date, mm.max_date
)
SELECT
    DATE_TRUNC('month', cc.last_purchase_date) AS period,
    COUNT(DISTINCT CASE WHEN cc.is_churned = 1 THEN cc.customer_id END) AS churned_customers,
    cc.customer_id,
    cd.customername,
    cd.COMPANY,
    cc.total_revenue AS churned_revenue
FROM churned_customers cc
JOIN customer_details cd ON cc.customer_id = cd.customer_id
WHERE cc.is_churned = 1
GROUP BY DATE_TRUNC('month', cc.last_purchase_date), cc.customer_id, cd.customername, cd.COMPANY, cc.total_revenue
ORDER BY period
        );
[0m18:24:04.946373 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:24:06.208730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.257 seconds
[0m18:24:06.224888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1c04e4-467c-4f0a-8bc2-b4cc6b746821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD623C0470>]}
[0m18:24:06.224888 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_cust ............................. [[32mSUCCESS 1[0m in 1.33s]
[0m18:24:06.224888 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_cust
[0m18:24:06.240951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:06.240951 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:24:06.240951 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:24:06.315020 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:24:06.315020 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:24:06.378635 [debug] [MainThread]: Connection 'model.hotel_booking.churn_cust' was left open.
[0m18:24:06.378635 [debug] [MainThread]: On model.hotel_booking.churn_cust: Close
[0m18:24:06.457750 [info ] [MainThread]: 
[0m18:24:06.457750 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m18:24:06.457750 [debug] [MainThread]: Command end result
[0m18:24:06.487866 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:24:06.487866 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:24:06.498017 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:24:06.498017 [info ] [MainThread]: 
[0m18:24:06.498017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:06.498017 [info ] [MainThread]: 
[0m18:24:06.498017 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:24:06.498017 [debug] [MainThread]: Command `dbt build` succeeded at 18:24:06.498017 after 5.40 seconds
[0m18:24:06.498017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD623919D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD62DC26F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6244EF00>]}
[0m18:24:06.498017 [debug] [MainThread]: Flushing usage events
[0m18:24:08.146776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:25:21.607590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D59481190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5974D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D56132480>]}


============================== 18:25:21.607590 | 5dc83a99-a2ef-4275-a268-1153b11328d1 ==============================
[0m18:25:21.607590 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:25:21.607590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_cust', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:25:22.091879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dc83a99-a2ef-4275-a268-1153b11328d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D59ADA390>]}
[0m18:25:22.173509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dc83a99-a2ef-4275-a268-1153b11328d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D55DB1D00>]}
[0m18:25:22.173509 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:25:22.608112 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:25:22.808513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:25:22.808513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:25:22.841516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dc83a99-a2ef-4275-a268-1153b11328d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5B8D6A50>]}
[0m18:25:22.923907 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:25:22.923907 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:25:22.978560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dc83a99-a2ef-4275-a268-1153b11328d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5BC2E630>]}
[0m18:25:22.978560 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:25:22.978560 [info ] [MainThread]: 
[0m18:25:22.978560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:22.978560 [info ] [MainThread]: 
[0m18:25:22.978560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:25:22.990004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:25:23.117803 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:25:23.117803 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:25:23.117803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:24.057466 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.941 seconds
[0m18:25:24.057466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m18:25:24.084243 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:25:24.086250 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:25:24.086250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:24.519257 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.435 seconds
[0m18:25:24.526462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dc83a99-a2ef-4275-a268-1153b11328d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5BA7F260>]}
[0m18:25:24.528841 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_cust
[0m18:25:24.528841 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_cust .................................. [RUN]
[0m18:25:24.528841 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_cust'
[0m18:25:24.535080 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_cust
[0m18:25:24.535080 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_cust"
[0m18:25:24.535080 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_cust
[0m18:25:24.588739 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_cust"
[0m18:25:24.592685 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_cust"
[0m18:25:24.594706 [debug] [Thread-1 (]: On model.hotel_booking.churn_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_cust
         as
        (WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
),
churned_customers AS (
    SELECT
        ca.customer_id,
        ca.last_purchase_date,
        SUM(t.revenue) AS total_revenue,
        CASE
            WHEN ca.last_purchase_date < DATEADD(month, -1, mm.max_date)
            THEN 1 ELSE 0
        END AS is_churned
    FROM customer_activity ca
    JOIN HOTEL_MGMT.stage.stg_transactions t ON ca.customer_id = t.customer_id
    CROSS JOIN max_month mm
    GROUP BY ca.customer_id, ca.last_purchase_date, mm.max_date
)
SELECT
    DATE_TRUNC('month', cc.last_purchase_date) AS period,
    COUNT(DISTINCT CASE WHEN cc.is_churned = 1 THEN cc.customer_id END) AS churned_customers,
    cc.customer_id,
    cd.customername,
    cd.COMPANY,
    cc.total_revenue AS churned_revenue
FROM churned_customers cc
JOIN customer_details cd ON cc.customer_id = cd.customer_id
WHERE cc.is_churned = 1
GROUP BY DATE_TRUNC('month', cc.last_purchase_date), cc.customer_id, cd.customername, cd.COMPANY, cc.total_revenue
ORDER BY period
        );
[0m18:25:24.594706 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:25.728110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.138 seconds
[0m18:25:25.760570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dc83a99-a2ef-4275-a268-1153b11328d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D58F78500>]}
[0m18:25:25.760570 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_cust ............................. [[32mSUCCESS 1[0m in 1.23s]
[0m18:25:25.760570 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_cust
[0m18:25:25.760570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:25.760570 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:25:25.760570 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:25:25.847555 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:25:25.848557 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:25:25.941276 [debug] [MainThread]: Connection 'model.hotel_booking.churn_cust' was left open.
[0m18:25:25.941276 [debug] [MainThread]: On model.hotel_booking.churn_cust: Close
[0m18:25:26.028409 [info ] [MainThread]: 
[0m18:25:26.029407 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m18:25:26.030406 [debug] [MainThread]: Command end result
[0m18:25:26.059299 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:25:26.063316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:25:26.071352 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:25:26.072359 [info ] [MainThread]: 
[0m18:25:26.072359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:26.094746 [info ] [MainThread]: 
[0m18:25:26.096759 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:25:26.101123 [debug] [MainThread]: Command `dbt build` succeeded at 18:25:26.099112 after 4.69 seconds
[0m18:25:26.101123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D59481190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D59A8DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D59454A40>]}
[0m18:25:26.101123 [debug] [MainThread]: Flushing usage events
[0m18:25:27.061440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:10.142865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1AA6A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A19EF2D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A19EF0410>]}


============================== 18:30:10.149514 | 1886d40d-5381-4ada-95a9-a6bc668a6e72 ==============================
[0m18:30:10.149514 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:30:10.151522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m churn_cust', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:30:10.680358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1886d40d-5381-4ada-95a9-a6bc668a6e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1C856690>]}
[0m18:30:10.755872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1886d40d-5381-4ada-95a9-a6bc668a6e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1C82CC80>]}
[0m18:30:10.757882 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:30:11.183414 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:30:11.374346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:11.374346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:11.421873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1886d40d-5381-4ada-95a9-a6bc668a6e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1AA6A1E0>]}
[0m18:30:11.509098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:30:11.509098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:30:11.564887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1886d40d-5381-4ada-95a9-a6bc668a6e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1CA7F7D0>]}
[0m18:30:11.569157 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:30:11.571582 [info ] [MainThread]: 
[0m18:30:11.573591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:11.573591 [info ] [MainThread]: 
[0m18:30:11.575596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:30:11.577136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:30:11.700451 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:30:11.700451 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:30:11.700451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:12.706282 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.009 seconds
[0m18:30:12.722214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m18:30:12.737969 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:30:12.737969 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:30:12.737969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:13.108395 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.368 seconds
[0m18:30:13.118401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1886d40d-5381-4ada-95a9-a6bc668a6e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1CA55DC0>]}
[0m18:30:13.125401 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_cust
[0m18:30:13.126402 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_cust .................................. [RUN]
[0m18:30:13.127400 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_cust'
[0m18:30:13.128399 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_cust
[0m18:30:13.128821 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_cust"
[0m18:30:13.128821 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_cust
[0m18:30:13.163994 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_cust"
[0m18:30:13.181665 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_cust"
[0m18:30:13.182666 [debug] [Thread-1 (]: On model.hotel_booking.churn_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_cust
         as
        (config{
    "model_name": "churn_cust",
    "model_type": "incremental",
    "unique_key": "customer_id",
    "target_schema": "mart",
    "target_table": "churn_cust",

    "materialized": "table"
}
WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
),
churned_customers AS (
    SELECT
        ca.customer_id,
        ca.last_purchase_date,
        SUM(t.revenue) AS total_revenue,
        CASE
            WHEN ca.last_purchase_date < DATEADD(month, -1, mm.max_date)
            THEN 1 ELSE 0
        END AS is_churned
    FROM customer_activity ca
    JOIN HOTEL_MGMT.stage.stg_transactions t ON ca.customer_id = t.customer_id
    CROSS JOIN max_month mm
    GROUP BY ca.customer_id, ca.last_purchase_date, mm.max_date
)
SELECT
    DATE_TRUNC('month', cc.last_purchase_date) AS period,
    COUNT(DISTINCT CASE WHEN cc.is_churned = 1 THEN cc.customer_id END) AS churned_customers,
    cc.customer_id,
    cd.customername,
    cd.COMPANY,
    cc.total_revenue AS churned_revenue
FROM churned_customers cc
JOIN customer_details cd ON cc.customer_id = cd.customer_id
WHERE cc.is_churned = 1
GROUP BY DATE_TRUNC('month', cc.last_purchase_date), cc.customer_id, cd.customername, cd.COMPANY, cc.total_revenue
ORDER BY period
        );
[0m18:30:13.182666 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:30:13.548511 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ac-0000-e677-0008-ed5a00021c2a
[0m18:30:13.548511 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 3 at position 9 unexpected 'config'.
syntax error line 15 at position 27 unexpected 'AS'.
[0m18:30:13.568487 [debug] [Thread-1 (]: Database Error in model churn_cust (models\mart\churn_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'config'.
  syntax error line 15 at position 27 unexpected 'AS'.
  compiled code at target\run\hotel_booking\models\mart\churn_cust.sql
[0m18:30:13.570497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1886d40d-5381-4ada-95a9-a6bc668a6e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A19F24350>]}
[0m18:30:13.572508 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.churn_cust ......................... [[31mERROR[0m in 0.44s]
[0m18:30:13.572508 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_cust
[0m18:30:13.574519 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_cust' to be skipped because of status 'error'.  Reason: Database Error in model churn_cust (models\mart\churn_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'config'.
  syntax error line 15 at position 27 unexpected 'AS'.
  compiled code at target\run\hotel_booking\models\mart\churn_cust.sql.
[0m18:30:13.576527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:13.576527 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:30:13.576527 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:30:13.868823 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:30:13.874185 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:30:13.956122 [debug] [MainThread]: Connection 'model.hotel_booking.churn_cust' was left open.
[0m18:30:13.956122 [debug] [MainThread]: On model.hotel_booking.churn_cust: Close
[0m18:30:14.047224 [info ] [MainThread]: 
[0m18:30:14.058250 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m18:30:14.058250 [debug] [MainThread]: Command end result
[0m18:30:14.089773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:30:14.091836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:30:14.099054 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:30:14.099054 [info ] [MainThread]: 
[0m18:30:14.104357 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:30:14.104357 [info ] [MainThread]: 
[0m18:30:14.104357 [error] [MainThread]:   Database Error in model churn_cust (models\mart\churn_cust.sql)
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 9 unexpected 'config'.
  syntax error line 15 at position 27 unexpected 'AS'.
  compiled code at target\run\hotel_booking\models\mart\churn_cust.sql
[0m18:30:14.104357 [info ] [MainThread]: 
[0m18:30:14.104357 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:30:14.108796 [debug] [MainThread]: Command `dbt build` failed at 18:30:14.108796 after 4.17 seconds
[0m18:30:14.110259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1CAAF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1AA69DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1AA68230>]}
[0m18:30:14.110621 [debug] [MainThread]: Flushing usage events
[0m18:30:15.454917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:38.242877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F550341C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F550EBD5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F550792E40>]}


============================== 18:31:38.252271 | 59b8828f-df1e-434c-a6f8-ac35dd9ea490 ==============================
[0m18:31:38.252271 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:31:38.252271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -m churn_cust', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:31:39.289359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59b8828f-df1e-434c-a6f8-ac35dd9ea490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F54E657AD0>]}
[0m18:31:39.361480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59b8828f-df1e-434c-a6f8-ac35dd9ea490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F54EE12270>]}
[0m18:31:39.361480 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:31:39.974261 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:31:40.148443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:40.148443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:40.196068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59b8828f-df1e-434c-a6f8-ac35dd9ea490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5530A90A0>]}
[0m18:31:40.290380 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:31:40.322910 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:31:40.443775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59b8828f-df1e-434c-a6f8-ac35dd9ea490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F553412BD0>]}
[0m18:31:40.443775 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:31:40.443775 [info ] [MainThread]: 
[0m18:31:40.443775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:40.443775 [info ] [MainThread]: 
[0m18:31:40.443775 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:31:40.443775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:31:44.126923 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:31:44.126923 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:31:44.128929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:45.091823 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.964 seconds
[0m18:31:45.108380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m18:31:45.121601 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:31:45.121601 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:31:45.121601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:45.489418 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.368 seconds
[0m18:31:45.495449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59b8828f-df1e-434c-a6f8-ac35dd9ea490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F551FB5340>]}
[0m18:31:45.501446 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_cust
[0m18:31:45.501446 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.churn_cust .................................. [RUN]
[0m18:31:45.505967 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_cust'
[0m18:31:45.505967 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_cust
[0m18:31:45.516767 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_cust"
[0m18:31:45.518764 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_cust
[0m18:31:45.574863 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_cust"
[0m18:31:45.578863 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_cust"
[0m18:31:45.578863 [debug] [Thread-1 (]: On model.hotel_booking.churn_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_cust"} */
create or replace transient table HOTEL_MGMT.stage.churn_cust
         as
        (-- config{
--     "model_name": "churn_cust",
--     "model_type": "incremental",
--     "unique_key": "customer_id",
--     "target_schema": "mart",
--     "target_table": "churn_cust",

--     "materialized": "table"
-- }
WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
),
churned_customers AS (
    SELECT
        ca.customer_id,
        ca.last_purchase_date,
        SUM(t.revenue) AS total_revenue,
        CASE
            WHEN ca.last_purchase_date < DATEADD(month, -1, mm.max_date)
            THEN 1 ELSE 0
        END AS is_churned
    FROM customer_activity ca
    JOIN HOTEL_MGMT.stage.stg_transactions t ON ca.customer_id = t.customer_id
    CROSS JOIN max_month mm
    GROUP BY ca.customer_id, ca.last_purchase_date, mm.max_date
)
SELECT
    DATE_TRUNC('month', cc.last_purchase_date) AS period,
    COUNT(DISTINCT CASE WHEN cc.is_churned = 1 THEN cc.customer_id END) AS churned_customers,
    cc.customer_id,
    cd.customername,
    cd.COMPANY,
    cc.total_revenue AS churned_revenue
FROM churned_customers cc
JOIN customer_details cd ON cc.customer_id = cd.customer_id
WHERE cc.is_churned = 1
GROUP BY DATE_TRUNC('month', cc.last_purchase_date), cc.customer_id, cd.customername, cd.COMPANY, cc.total_revenue
ORDER BY period
        );
[0m18:31:45.579863 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:46.563134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.988 seconds
[0m18:31:46.594845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b8828f-df1e-434c-a6f8-ac35dd9ea490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F54E656AE0>]}
[0m18:31:46.594845 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.churn_cust ............................. [[32mSUCCESS 1[0m in 1.09s]
[0m18:31:46.594845 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_cust
[0m18:31:46.610604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:46.610604 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:31:46.610604 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:31:46.727079 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:31:46.728083 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:31:46.798067 [debug] [MainThread]: Connection 'model.hotel_booking.churn_cust' was left open.
[0m18:31:46.798067 [debug] [MainThread]: On model.hotel_booking.churn_cust: Close
[0m18:31:46.900662 [info ] [MainThread]: 
[0m18:31:46.901644 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m18:31:46.902643 [debug] [MainThread]: Command end result
[0m18:31:46.934919 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:31:46.938750 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:31:46.946735 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:31:46.946735 [info ] [MainThread]: 
[0m18:31:46.946735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:46.946735 [info ] [MainThread]: 
[0m18:31:46.946735 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:31:46.946735 [debug] [MainThread]: Command `dbt build` succeeded at 18:31:46.946735 after 8.96 seconds
[0m18:31:46.946735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F54EF5BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5507EEFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5507EEFF0>]}
[0m18:31:46.953787 [debug] [MainThread]: Flushing usage events
[0m18:31:48.255039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:26.361454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD1DA9A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD50918E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD4D74980>]}


============================== 18:33:26.367398 | 616d7432-bbb9-40ff-84b9-80831274ea09 ==============================
[0m18:33:26.367398 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:33:26.368398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build -m churn_cust', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:33:26.945979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616d7432-bbb9-40ff-84b9-80831274ea09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD5729220>]}
[0m18:33:27.013067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616d7432-bbb9-40ff-84b9-80831274ea09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD621BEC0>]}
[0m18:33:27.022708 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:33:27.473860 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:33:27.673314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:27.673314 [debug] [MainThread]: Partial parsing: updated file: hotel_booking://models\mart\churn_cust.sql
[0m18:33:27.902414 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hotel_booking.churn_cust' (models\mart\churn_cust.sql) depends on a node named 'remove_null_transactions' which was not found
[0m18:33:27.902414 [debug] [MainThread]: Command `dbt build` failed at 18:33:27.902414 after 1.79 seconds
[0m18:33:27.902414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD1E54320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD7514F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD48D09B0>]}
[0m18:33:27.902414 [debug] [MainThread]: Flushing usage events
[0m18:33:28.947587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:10.491624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96BC165A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96E0DB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96E0DA480>]}


============================== 18:34:10.507291 | 65fdaf7a-42a1-4f38-8c5a-1ab0135403da ==============================
[0m18:34:10.507291 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:34:10.507291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_cust', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:11.059712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65fdaf7a-42a1-4f38-8c5a-1ab0135403da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96E982300>]}
[0m18:34:11.139186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65fdaf7a-42a1-4f38-8c5a-1ab0135403da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96E328E30>]}
[0m18:34:11.139186 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:34:11.587841 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:34:11.776613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:11.776613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:11.808476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65fdaf7a-42a1-4f38-8c5a-1ab0135403da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96ED1B950>]}
[0m18:34:11.885367 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:34:11.901035 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:34:11.948909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65fdaf7a-42a1-4f38-8c5a-1ab0135403da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D970BC2600>]}
[0m18:34:11.948909 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:34:11.948909 [info ] [MainThread]: 
[0m18:34:11.948909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:11.948909 [info ] [MainThread]: 
[0m18:34:11.948909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:34:11.964816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:34:12.084395 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:34:12.084395 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:34:12.084395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:13.455773 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.369 seconds
[0m18:34:13.455773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOTEL_MGMT, now create_HOTEL_MGMT_stage_mart)
[0m18:34:13.455773 [debug] [ThreadPool]: Creating schema "database: "HOTEL_MGMT"
schema: "stage_mart"
"
[0m18:34:13.471518 [debug] [ThreadPool]: Using snowflake connection "create_HOTEL_MGMT_stage_mart"
[0m18:34:13.471518 [debug] [ThreadPool]: On create_HOTEL_MGMT_stage_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "create_HOTEL_MGMT_stage_mart"} */
create schema if not exists HOTEL_MGMT.stage_mart
[0m18:34:13.551196 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m18:34:13.567305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage_mart'
[0m18:34:13.579821 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage_mart"
[0m18:34:13.579821 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage_mart"} */
show objects in HOTEL_MGMT.stage_mart limit 10000;
[0m18:34:13.579821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:13.900532 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.320 seconds
[0m18:34:13.904564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOTEL_MGMT_stage_mart, now list_HOTEL_MGMT_stage)
[0m18:34:13.906571 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:34:13.906571 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:34:13.995590 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.088 seconds
[0m18:34:13.997600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65fdaf7a-42a1-4f38-8c5a-1ab0135403da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D970A1DC40>]}
[0m18:34:13.997600 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_cust
[0m18:34:13.997600 [info ] [Thread-1 (]: 1 of 1 START sql table model stage_mart.churn_cust ............................. [RUN]
[0m18:34:14.009221 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_cust'
[0m18:34:14.009221 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_cust
[0m18:34:14.019255 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_cust"
[0m18:34:14.021263 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_cust
[0m18:34:14.058476 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_cust"
[0m18:34:14.061475 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_cust"
[0m18:34:14.061475 [debug] [Thread-1 (]: On model.hotel_booking.churn_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_cust"} */
create or replace transient table HOTEL_MGMT.stage_mart.churn_cust
         as
        (-- config{
--     "model_name": "churn_cust",
--     "model_type": "incremental",
--     "unique_key": "customer_id",
--     "target_schema": "mart",
--     "target_table": "churn_cust",

--     "materialized": "table"
-- }

 
WITH customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MAX(PAYMENT_MONTH) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
),
max_month AS (
    SELECT MAX(PAYMENT_MONTH) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
),
churned_customers AS (
    SELECT
        ca.customer_id,
        ca.last_purchase_date,
        SUM(t.revenue) AS total_revenue,
        CASE
            WHEN ca.last_purchase_date < DATEADD(month, -1, mm.max_date)
            THEN 1 ELSE 0
        END AS is_churned
    FROM customer_activity ca
    JOIN HOTEL_MGMT.stage.stg_transactions t ON ca.customer_id = t.customer_id
    CROSS JOIN max_month mm
    GROUP BY ca.customer_id, ca.last_purchase_date, mm.max_date
)
SELECT
    DATE_TRUNC('month', cc.last_purchase_date) AS period,
    COUNT(DISTINCT CASE WHEN cc.is_churned = 1 THEN cc.customer_id END) AS churned_customers,
    cc.customer_id,
    cd.customername,
    cd.COMPANY,
    cc.total_revenue AS churned_revenue
FROM churned_customers cc
JOIN customer_details cd ON cc.customer_id = cd.customer_id
WHERE cc.is_churned = 1
GROUP BY DATE_TRUNC('month', cc.last_purchase_date), cc.customer_id, cd.customername, cd.COMPANY, cc.total_revenue
ORDER BY period
        );
[0m18:34:14.062475 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:14.836449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m18:34:14.851742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65fdaf7a-42a1-4f38-8c5a-1ab0135403da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96DE445C0>]}
[0m18:34:14.851742 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage_mart.churn_cust ........................ [[32mSUCCESS 1[0m in 0.84s]
[0m18:34:14.851742 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_cust
[0m18:34:14.851742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:14.851742 [debug] [MainThread]: Connection 'create_HOTEL_MGMT_stage_mart' was left open.
[0m18:34:14.851742 [debug] [MainThread]: On create_HOTEL_MGMT_stage_mart: Close
[0m18:34:14.953510 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:34:14.953510 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:34:15.017114 [debug] [MainThread]: Connection 'model.hotel_booking.churn_cust' was left open.
[0m18:34:15.017114 [debug] [MainThread]: On model.hotel_booking.churn_cust: Close
[0m18:34:15.090174 [info ] [MainThread]: 
[0m18:34:15.090174 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m18:34:15.090174 [debug] [MainThread]: Command end result
[0m18:34:15.170384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:34:15.170384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:34:15.170384 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:34:15.170384 [info ] [MainThread]: 
[0m18:34:15.170384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:15.170384 [info ] [MainThread]: 
[0m18:34:15.170384 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:15.170384 [debug] [MainThread]: Command `dbt build` succeeded at 18:34:15.170384 after 4.88 seconds
[0m18:34:15.170384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96E13F9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96E641DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D96E04E780>]}
[0m18:34:15.185420 [debug] [MainThread]: Flushing usage events
[0m18:34:16.142672 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:18.254780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6DBFA6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6DBF93A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6E38E4E0>]}


============================== 18:35:18.260816 | 72d46814-7fb7-4b9b-9ed0-fdc0db2a45f7 ==============================
[0m18:35:18.260816 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:35:18.261784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_prod', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:18.815161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72d46814-7fb7-4b9b-9ed0-fdc0db2a45f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6F4AC1D0>]}
[0m18:35:18.894533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72d46814-7fb7-4b9b-9ed0-fdc0db2a45f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6E84A960>]}
[0m18:35:18.894533 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:35:19.323022 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:35:19.508116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:19.508116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:19.539947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72d46814-7fb7-4b9b-9ed0-fdc0db2a45f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6E3C99D0>]}
[0m18:35:19.619170 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:35:19.619170 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:35:19.682273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72d46814-7fb7-4b9b-9ed0-fdc0db2a45f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE70B19280>]}
[0m18:35:19.682273 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:35:19.682273 [info ] [MainThread]: 
[0m18:35:19.691956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:19.691956 [info ] [MainThread]: 
[0m18:35:19.691956 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:35:19.695447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:35:19.817100 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:35:19.817100 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:35:19.817100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:20.796137 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.977 seconds
[0m18:35:20.803569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage_mart'
[0m18:35:20.819294 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage_mart"
[0m18:35:20.819294 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage_mart"} */
show objects in HOTEL_MGMT.stage_mart limit 10000;
[0m18:35:20.819294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:21.117158 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.294 seconds
[0m18:35:21.117158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOTEL_MGMT_stage_mart, now list_HOTEL_MGMT_stage)
[0m18:35:21.117158 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:35:21.117158 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:35:21.211365 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.092 seconds
[0m18:35:21.221717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d46814-7fb7-4b9b-9ed0-fdc0db2a45f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7084F1A0>]}
[0m18:35:21.227268 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_prod
[0m18:35:21.228303 [info ] [Thread-1 (]: 1 of 1 START sql table model stage_mart.churn_prod ............................. [RUN]
[0m18:35:21.229300 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_prod'
[0m18:35:21.229300 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_prod
[0m18:35:21.240893 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_prod"
[0m18:35:21.243847 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_prod
[0m18:35:21.271391 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_prod"
[0m18:35:21.284928 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_prod"
[0m18:35:21.284928 [debug] [Thread-1 (]: On model.hotel_booking.churn_prod: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_prod"} */
create or replace transient table HOTEL_MGMT.stage_mart.churn_prod
         as
        (
WITH customer_product_activity AS (
    SELECT
        customer_id,
        product_id,
        MAX(payment_month) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
    GROUP BY customer_id, product_id
),
max_month AS (
    SELECT MAX(payment_month) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
churned_products AS (
    SELECT
        cpa.customer_id,
        cpa.product_id,
        cpa.last_purchase_date,
        CASE
            WHEN cpa.last_purchase_date < DATEADD(month, -1, mm.max_date)
            THEN 1 ELSE 0
        END AS is_churned
    FROM customer_product_activity cpa
    CROSS JOIN max_month mm
),
product_details AS (
    SELECT
        product_id,
        product_family
    FROM HOTEL_MGMT.stage.stg_products
),
customer_churn AS (
    SELECT
        cp.customer_id,
        SUM(cp.is_churned) AS total_churn_products,
        SUM(CASE WHEN cp.is_churned = 1 THEN t.revenue ELSE 0 END) AS total_churn_revenue
    FROM churned_products cp
    JOIN product_details pd ON TRIM(cp.product_id) = pd.product_id
    JOIN HOTEL_MGMT.stage.stg_transactions t ON cp.customer_id = t.customer_id AND cp.product_id = t.product_id
    GROUP BY cp.customer_id
)
SELECT
    c.customer_id,
    c.customername,
    COALESCE(cc.total_churn_products, 0) AS total_churn_products,
    COALESCE(cc.total_churn_revenue, 0) AS total_churn_revenue
FROM HOTEL_MGMT.stage.stg_customers c
LEFT JOIN customer_churn cc ON c.customer_id = cc.customer_id
ORDER BY total_churn_products DESC;
[0m18:35:21.284928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:21.856026 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b1-0000-e683-0008-ed5a00013ce2
[0m18:35:21.869866 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 53 at position 34 unexpected ';'.
[0m18:35:21.896894 [debug] [Thread-1 (]: Database Error in model churn_prod (models\transform\churn_prod.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 34 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_prod.sql
[0m18:35:21.896894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d46814-7fb7-4b9b-9ed0-fdc0db2a45f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6DCE4230>]}
[0m18:35:21.896894 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage_mart.churn_prod .................... [[31mERROR[0m in 0.67s]
[0m18:35:21.902773 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_prod
[0m18:35:21.904282 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.churn_prod' to be skipped because of status 'error'.  Reason: Database Error in model churn_prod (models\transform\churn_prod.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 34 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_prod.sql.
[0m18:35:21.904282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:21.904282 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:35:21.904282 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:35:21.983349 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:35:21.987046 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:35:22.055301 [debug] [MainThread]: Connection 'model.hotel_booking.churn_prod' was left open.
[0m18:35:22.055301 [debug] [MainThread]: On model.hotel_booking.churn_prod: Close
[0m18:35:22.118156 [info ] [MainThread]: 
[0m18:35:22.134055 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m18:35:22.134055 [debug] [MainThread]: Command end result
[0m18:35:22.167561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:35:22.171806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:35:22.178369 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:35:22.178369 [info ] [MainThread]: 
[0m18:35:22.178369 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:35:22.178369 [info ] [MainThread]: 
[0m18:35:22.178369 [error] [MainThread]:   Database Error in model churn_prod (models\transform\churn_prod.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 34 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\churn_prod.sql
[0m18:35:22.178369 [info ] [MainThread]: 
[0m18:35:22.178369 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:35:22.178369 [debug] [MainThread]: Command `dbt build` failed at 18:35:22.178369 after 4.15 seconds
[0m18:35:22.186541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6DD6F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6DD6EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6E5B38F0>]}
[0m18:35:22.187335 [debug] [MainThread]: Flushing usage events
[0m18:35:23.203693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:34.166414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B5148CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B550A4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B5521AA20>]}


============================== 18:35:34.170975 | d6c28428-3e57-426b-8892-01dff49a201f ==============================
[0m18:35:34.170975 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:35:34.172126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m churn_prod', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:34.849357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6c28428-3e57-426b-8892-01dff49a201f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B55F6B380>]}
[0m18:35:34.932799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6c28428-3e57-426b-8892-01dff49a201f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B55BB4C80>]}
[0m18:35:34.932799 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:35:35.380146 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:35:35.600268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:35.600268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:35.633537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6c28428-3e57-426b-8892-01dff49a201f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B57032450>]}
[0m18:35:35.734650 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:35:35.734650 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:35:35.800327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6c28428-3e57-426b-8892-01dff49a201f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B571C1280>]}
[0m18:35:35.800327 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:35:35.803895 [info ] [MainThread]: 
[0m18:35:35.803895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:35.803895 [info ] [MainThread]: 
[0m18:35:35.816519 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:35:35.817045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:35:35.963522 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:35:35.963522 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:35:35.963522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:36.759477 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.796 seconds
[0m18:35:36.771997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m18:35:36.784821 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:35:36.784821 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:35:36.784821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:37.102944 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.315 seconds
[0m18:35:37.102944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOTEL_MGMT_stage, now list_HOTEL_MGMT_stage_mart)
[0m18:35:37.121464 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage_mart"
[0m18:35:37.121464 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage_mart"} */
show objects in HOTEL_MGMT.stage_mart limit 10000;
[0m18:35:37.198141 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.072 seconds
[0m18:35:37.201577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c28428-3e57-426b-8892-01dff49a201f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B55F68980>]}
[0m18:35:37.210104 [debug] [Thread-1 (]: Began running node model.hotel_booking.churn_prod
[0m18:35:37.210104 [info ] [Thread-1 (]: 1 of 1 START sql table model stage_mart.churn_prod ............................. [RUN]
[0m18:35:37.217838 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.churn_prod'
[0m18:35:37.217838 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.churn_prod
[0m18:35:37.234530 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.churn_prod"
[0m18:35:37.236901 [debug] [Thread-1 (]: Began executing node model.hotel_booking.churn_prod
[0m18:35:37.331850 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.churn_prod"
[0m18:35:37.336815 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.churn_prod"
[0m18:35:37.338844 [debug] [Thread-1 (]: On model.hotel_booking.churn_prod: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.churn_prod"} */
create or replace transient table HOTEL_MGMT.stage_mart.churn_prod
         as
        (
WITH customer_product_activity AS (
    SELECT
        customer_id,
        product_id,
        MAX(payment_month) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
    GROUP BY customer_id, product_id
),
max_month AS (
    SELECT MAX(payment_month) AS max_date
    FROM HOTEL_MGMT.stage.stg_transactions
    WHERE revenue_type = 1
),
churned_products AS (
    SELECT
        cpa.customer_id,
        cpa.product_id,
        cpa.last_purchase_date,
        CASE
            WHEN cpa.last_purchase_date < DATEADD(month, -1, mm.max_date)
            THEN 1 ELSE 0
        END AS is_churned
    FROM customer_product_activity cpa
    CROSS JOIN max_month mm
),
product_details AS (
    SELECT
        product_id,
        product_family
    FROM HOTEL_MGMT.stage.stg_products
),
customer_churn AS (
    SELECT
        cp.customer_id,
        SUM(cp.is_churned) AS total_churn_products,
        SUM(CASE WHEN cp.is_churned = 1 THEN t.revenue ELSE 0 END) AS total_churn_revenue
    FROM churned_products cp
    JOIN product_details pd ON TRIM(cp.product_id) = pd.product_id
    JOIN HOTEL_MGMT.stage.stg_transactions t ON cp.customer_id = t.customer_id AND cp.product_id = t.product_id
    GROUP BY cp.customer_id
)
SELECT
    c.customer_id,
    c.customername,
    COALESCE(cc.total_churn_products, 0) AS total_churn_products,
    COALESCE(cc.total_churn_revenue, 0) AS total_churn_revenue
FROM HOTEL_MGMT.stage.stg_customers c
LEFT JOIN customer_churn cc ON c.customer_id = cc.customer_id
ORDER BY total_churn_products DESC
        );
[0m18:35:37.338844 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:38.369492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.042 seconds
[0m18:35:38.425220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6c28428-3e57-426b-8892-01dff49a201f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B546D4410>]}
[0m18:35:38.425220 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage_mart.churn_prod ........................ [[32mSUCCESS 1[0m in 1.21s]
[0m18:35:38.425220 [debug] [Thread-1 (]: Finished running node model.hotel_booking.churn_prod
[0m18:35:38.425220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:38.425220 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:35:38.425220 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:35:38.509168 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage_mart' was left open.
[0m18:35:38.509168 [debug] [MainThread]: On list_HOTEL_MGMT_stage_mart: Close
[0m18:35:38.587595 [debug] [MainThread]: Connection 'model.hotel_booking.churn_prod' was left open.
[0m18:35:38.588608 [debug] [MainThread]: On model.hotel_booking.churn_prod: Close
[0m18:35:38.692112 [info ] [MainThread]: 
[0m18:35:38.692112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m18:35:38.692112 [debug] [MainThread]: Command end result
[0m18:35:38.723560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:35:38.725557 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:35:38.725557 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:35:38.725557 [info ] [MainThread]: 
[0m18:35:38.736727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:38.737182 [info ] [MainThread]: 
[0m18:35:38.738221 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:35:38.739220 [debug] [MainThread]: Command `dbt build` succeeded at 18:35:38.739220 after 4.77 seconds
[0m18:35:38.740220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B550D3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B54D23BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B52943F20>]}
[0m18:35:38.740220 [debug] [MainThread]: Flushing usage events
[0m18:35:39.722326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:36:20.106050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCFC63470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCFC63440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCFC636B0>]}


============================== 18:36:20.106050 | ceb3f254-ea10-45ae-9842-d13c4e88521f ==============================
[0m18:36:20.106050 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:36:20.106050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -m cross_sell', 'send_anonymous_usage_stats': 'True'}
[0m18:36:20.657849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceb3f254-ea10-45ae-9842-d13c4e88521f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD2866E70>]}
[0m18:36:20.736778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceb3f254-ea10-45ae-9842-d13c4e88521f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD2AE5490>]}
[0m18:36:20.736778 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:36:21.161442 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:36:21.365916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:21.366913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:21.407061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceb3f254-ea10-45ae-9842-d13c4e88521f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD20AA3F0>]}
[0m18:36:21.492919 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:36:21.497565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:36:21.557211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceb3f254-ea10-45ae-9842-d13c4e88521f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD406F260>]}
[0m18:36:21.558209 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:36:21.561251 [info ] [MainThread]: 
[0m18:36:21.562042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:36:21.563599 [info ] [MainThread]: 
[0m18:36:21.564876 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:36:21.565961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:36:21.699861 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:36:21.700861 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:36:21.700861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:22.714002 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.018 seconds
[0m18:36:22.714002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage'
[0m18:36:22.732329 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:36:22.732329 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:36:22.732329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:23.077526 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.342 seconds
[0m18:36:23.077526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOTEL_MGMT_stage, now list_HOTEL_MGMT_stage_mart)
[0m18:36:23.077526 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage_mart"
[0m18:36:23.077526 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage_mart"} */
show objects in HOTEL_MGMT.stage_mart limit 10000;
[0m18:36:23.158099 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.073 seconds
[0m18:36:23.158099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb3f254-ea10-45ae-9842-d13c4e88521f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD45C9DF0>]}
[0m18:36:23.158099 [debug] [Thread-1 (]: Began running node model.hotel_booking.cross_sell
[0m18:36:23.173771 [info ] [Thread-1 (]: 1 of 1 START sql table model stage_mart.cross_sell ............................. [RUN]
[0m18:36:23.173771 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.cross_sell'
[0m18:36:23.173771 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.cross_sell
[0m18:36:23.173771 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.cross_sell"
[0m18:36:23.173771 [debug] [Thread-1 (]: Began executing node model.hotel_booking.cross_sell
[0m18:36:23.214683 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.cross_sell"
[0m18:36:23.214683 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.cross_sell"
[0m18:36:23.214683 [debug] [Thread-1 (]: On model.hotel_booking.cross_sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.cross_sell"} */
create or replace transient table HOTEL_MGMT.stage_mart.cross_sell
         as
        (
WITH customer_purchase_history AS (
    SELECT
        t.customer_id,
        t.product_id,
        t.payment_month,
        MIN(t.payment_month) OVER (PARTITION BY t.customer_id) AS first_purchase_month
    FROM HOTEL_MGMT.stage.stg_transactions t
),
product_purchase_counts AS (
    SELECT
        customer_id,
        product_id,
        COUNT(DISTINCT payment_month) AS purchase_count,
        MAX(payment_month) AS last_purchase_month
    FROM customer_purchase_history
    GROUP BY customer_id, product_id
),
customer_cross_sell AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS total_cross_sells
    FROM customer_purchase_history
    WHERE payment_month > first_purchase_month
    GROUP BY customer_id
),

combined_metrics AS (
    SELECT
        c.customer_id,
        c.customername,
        COALESCE(cs.total_cross_sells,0) AS total_cross_sells,
       
    FROM HOTEL_MGMT.stage.stg_customers c
    LEFT JOIN customer_cross_sell cs
      ON c.customer_id = cs.customer_id

)
SELECT *
FROM combined_metrics
ORDER BY  total_cross_sells DESC
        );
[0m18:36:23.214683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:36:24.067085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.839 seconds
[0m18:36:24.081805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb3f254-ea10-45ae-9842-d13c4e88521f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD13981D0>]}
[0m18:36:24.081805 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage_mart.cross_sell ........................ [[32mSUCCESS 1[0m in 0.91s]
[0m18:36:24.081805 [debug] [Thread-1 (]: Finished running node model.hotel_booking.cross_sell
[0m18:36:24.096931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:24.096931 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:36:24.097957 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:36:24.167310 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage_mart' was left open.
[0m18:36:24.167310 [debug] [MainThread]: On list_HOTEL_MGMT_stage_mart: Close
[0m18:36:24.268820 [debug] [MainThread]: Connection 'model.hotel_booking.cross_sell' was left open.
[0m18:36:24.268820 [debug] [MainThread]: On model.hotel_booking.cross_sell: Close
[0m18:36:24.345201 [info ] [MainThread]: 
[0m18:36:24.345201 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m18:36:24.345201 [debug] [MainThread]: Command end result
[0m18:36:24.383466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:36:24.386475 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:36:24.388515 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:36:24.388515 [info ] [MainThread]: 
[0m18:36:24.388515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:24.388515 [info ] [MainThread]: 
[0m18:36:24.388515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:36:24.388515 [debug] [MainThread]: Command `dbt build` succeeded at 18:36:24.388515 after 4.51 seconds
[0m18:36:24.398285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD1A0F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD1A41460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD1A40350>]}
[0m18:36:24.398285 [debug] [MainThread]: Flushing usage events
[0m18:36:25.700578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:37:25.634741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AC1572F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AC1573B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AC157230>]}


============================== 18:37:25.641797 | cbcddb04-9d65-44ed-825c-99f320ec621d ==============================
[0m18:37:25.641797 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:37:25.641797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -m newlogos', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:37:26.335040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbcddb04-9d65-44ed-825c-99f320ec621d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AED51070>]}
[0m18:37:26.410542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbcddb04-9d65-44ed-825c-99f320ec621d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AEF224E0>]}
[0m18:37:26.414653 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:37:26.994454 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:37:27.235655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:27.235655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:27.283445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbcddb04-9d65-44ed-825c-99f320ec621d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B01E7950>]}
[0m18:37:27.426650 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:37:27.469780 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:37:27.580865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbcddb04-9d65-44ed-825c-99f320ec621d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B053EDB0>]}
[0m18:37:27.580865 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:37:27.586896 [info ] [MainThread]: 
[0m18:37:27.588906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:27.588906 [info ] [MainThread]: 
[0m18:37:27.591926 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:27.591926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:37:31.348198 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:37:31.348198 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:37:31.348198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:32.201105 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.845 seconds
[0m18:37:32.208725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage_mart'
[0m18:37:32.220984 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage_mart"
[0m18:37:32.221981 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage_mart"} */
show objects in HOTEL_MGMT.stage_mart limit 10000;
[0m18:37:32.221981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:32.515128 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.292 seconds
[0m18:37:32.522629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOTEL_MGMT_stage_mart, now list_HOTEL_MGMT_stage)
[0m18:37:32.531663 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:37:32.532661 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:37:32.598098 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.065 seconds
[0m18:37:32.605825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbcddb04-9d65-44ed-825c-99f320ec621d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0955790>]}
[0m18:37:32.614144 [debug] [Thread-1 (]: Began running node model.hotel_booking.newlogos
[0m18:37:32.615144 [info ] [Thread-1 (]: 1 of 1 START sql table model stage_mart.newlogos ............................... [RUN]
[0m18:37:32.617271 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.newlogos'
[0m18:37:32.618576 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.newlogos
[0m18:37:32.632865 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.newlogos"
[0m18:37:32.641045 [debug] [Thread-1 (]: Began executing node model.hotel_booking.newlogos
[0m18:37:32.677257 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.newlogos"
[0m18:37:32.679223 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.newlogos"
[0m18:37:32.680223 [debug] [Thread-1 (]: On model.hotel_booking.newlogos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.newlogos"} */
create or replace transient table HOTEL_MGMT.stage_mart.newlogos
         as
        (
WITH params AS (
    SELECT 1 AS fiscal_year_start_month -- Change this value to set  fiscal year start month
),
customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
fiscal_years AS (
    SELECT
        ca.customer_id,
        ca.first_purchase_date,
        CASE
            WHEN EXTRACT(MONTH FROM ca.first_purchase_date) >= p.fiscal_year_start_month THEN EXTRACT(YEAR FROM ca.first_purchase_date)
            ELSE EXTRACT(YEAR FROM ca.first_purchase_date) - 1
        END AS fiscal_year
    FROM customer_activity ca
    CROSS JOIN params p
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
)
SELECT
    fy.fiscal_year,
    fy.customer_id,
    cd.customername,
    cd.COMPANY,
    fy.first_purchase_date
FROM fiscal_years fy
JOIN customer_details cd ON fy.customer_id = cd.customer_id
ORDER BY fy.fiscal_year, fy.customer_id;
[0m18:37:32.680223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:37:33.204036 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b3-0000-e6c6-0008-ed5a00027af6
[0m18:37:33.205037 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 37 at position 39 unexpected ';'.
[0m18:37:33.238389 [debug] [Thread-1 (]: Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 39 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql
[0m18:37:33.241388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbcddb04-9d65-44ed-825c-99f320ec621d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AD8740E0>]}
[0m18:37:33.242391 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage_mart.newlogos ...................... [[31mERROR[0m in 0.62s]
[0m18:37:33.244391 [debug] [Thread-1 (]: Finished running node model.hotel_booking.newlogos
[0m18:37:33.244391 [debug] [Thread-4 (]: Marking all children of 'model.hotel_booking.newlogos' to be skipped because of status 'error'.  Reason: Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 39 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql.
[0m18:37:33.264012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:33.272806 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:37:33.272806 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:37:33.360252 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:37:33.361257 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:37:33.441874 [debug] [MainThread]: Connection 'model.hotel_booking.newlogos' was left open.
[0m18:37:33.441874 [debug] [MainThread]: On model.hotel_booking.newlogos: Close
[0m18:37:33.517747 [info ] [MainThread]: 
[0m18:37:33.518105 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m18:37:33.520107 [debug] [MainThread]: Command end result
[0m18:37:33.546093 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:37:33.547093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:37:33.557977 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:37:33.557977 [info ] [MainThread]: 
[0m18:37:33.557977 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:37:33.557977 [info ] [MainThread]: 
[0m18:37:33.557977 [error] [MainThread]:   Database Error in model newlogos (models\transform\newlogos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 39 unexpected ';'.
  compiled code at target\run\hotel_booking\models\transform\newlogos.sql
[0m18:37:33.557977 [info ] [MainThread]: 
[0m18:37:33.557977 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:37:33.557977 [debug] [MainThread]: Command `dbt build` failed at 18:37:33.557977 after 8.18 seconds
[0m18:37:33.557977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AD2C33E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AD81A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AD81AE10>]}
[0m18:37:33.557977 [debug] [MainThread]: Flushing usage events
[0m18:37:34.520209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:37:42.626906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7916B1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7903B7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7903B7530>]}


============================== 18:37:42.635568 | f4d50866-cdac-4858-8e15-0d67f943abfb ==============================
[0m18:37:42.635568 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:37:42.635568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m newlogos', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:37:43.313563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4d50866-cdac-4858-8e15-0d67f943abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7930511F0>]}
[0m18:37:43.377369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4d50866-cdac-4858-8e15-0d67f943abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792857170>]}
[0m18:37:43.377369 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:37:43.824837 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:37:44.030576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:44.031589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:44.062901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4d50866-cdac-4858-8e15-0d67f943abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E794437710>]}
[0m18:37:44.147714 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:37:44.164361 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:37:44.228671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4d50866-cdac-4858-8e15-0d67f943abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E794762DE0>]}
[0m18:37:44.228671 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:37:44.228671 [info ] [MainThread]: 
[0m18:37:44.228671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:44.228671 [info ] [MainThread]: 
[0m18:37:44.245399 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:44.247395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:37:44.395037 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:37:44.396046 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:37:44.396046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:44.886120 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.492 seconds
[0m18:37:44.896054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage_mart'
[0m18:37:44.899440 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage_mart"
[0m18:37:44.899440 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage_mart"} */
show objects in HOTEL_MGMT.stage_mart limit 10000;
[0m18:37:44.899440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:45.216477 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.316 seconds
[0m18:37:45.228669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOTEL_MGMT_stage_mart, now list_HOTEL_MGMT_stage)
[0m18:37:45.229678 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:37:45.229678 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:37:45.298331 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.068 seconds
[0m18:37:45.313270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d50866-cdac-4858-8e15-0d67f943abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E794E224B0>]}
[0m18:37:45.319557 [debug] [Thread-1 (]: Began running node model.hotel_booking.newlogos
[0m18:37:45.319557 [info ] [Thread-1 (]: 1 of 1 START sql table model stage_mart.newlogos ............................... [RUN]
[0m18:37:45.319557 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.newlogos'
[0m18:37:45.328887 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.newlogos
[0m18:37:45.330281 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.newlogos"
[0m18:37:45.330281 [debug] [Thread-1 (]: Began executing node model.hotel_booking.newlogos
[0m18:37:45.382480 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.newlogos"
[0m18:37:45.382480 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.newlogos"
[0m18:37:45.382480 [debug] [Thread-1 (]: On model.hotel_booking.newlogos: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.newlogos"} */
create or replace transient table HOTEL_MGMT.stage_mart.newlogos
         as
        (
WITH params AS (
    SELECT 1 AS fiscal_year_start_month -- Change this value to set  fiscal year start month
),
customer_activity AS (
    SELECT
        CUSTOMER_ID AS customer_id,
        MIN(PAYMENT_MONTH) AS first_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY CUSTOMER_ID
),
fiscal_years AS (
    SELECT
        ca.customer_id,
        ca.first_purchase_date,
        CASE
            WHEN EXTRACT(MONTH FROM ca.first_purchase_date) >= p.fiscal_year_start_month THEN EXTRACT(YEAR FROM ca.first_purchase_date)
            ELSE EXTRACT(YEAR FROM ca.first_purchase_date) - 1
        END AS fiscal_year
    FROM customer_activity ca
    CROSS JOIN params p
),
customer_details AS (
    SELECT *
    FROM HOTEL_MGMT.stage.stg_customers
)
SELECT
    fy.fiscal_year,
    fy.customer_id,
    cd.customername,
    cd.COMPANY,
    fy.first_purchase_date
FROM fiscal_years fy
JOIN customer_details cd ON fy.customer_id = cd.customer_id
ORDER BY fy.fiscal_year, fy.customer_id
        );
[0m18:37:45.382480 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:37:46.098117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m18:37:46.133491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d50866-cdac-4858-8e15-0d67f943abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78F9C6B40>]}
[0m18:37:46.133491 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage_mart.newlogos .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m18:37:46.133491 [debug] [Thread-1 (]: Finished running node model.hotel_booking.newlogos
[0m18:37:46.133491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:46.133491 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:37:46.137856 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:37:46.198012 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:37:46.198012 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:37:46.267805 [debug] [MainThread]: Connection 'model.hotel_booking.newlogos' was left open.
[0m18:37:46.271610 [debug] [MainThread]: On model.hotel_booking.newlogos: Close
[0m18:37:46.342200 [info ] [MainThread]: 
[0m18:37:46.342200 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m18:37:46.342200 [debug] [MainThread]: Command end result
[0m18:37:46.367643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:37:46.377745 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:37:46.386170 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:37:46.387677 [info ] [MainThread]: 
[0m18:37:46.387677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:37:46.387677 [info ] [MainThread]: 
[0m18:37:46.387677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:37:46.387677 [debug] [MainThread]: Command `dbt build` succeeded at 18:37:46.387677 after 3.95 seconds
[0m18:37:46.387677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7920C2BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7920C21B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7932942F0>]}
[0m18:37:46.387677 [debug] [MainThread]: Flushing usage events
[0m18:37:47.348129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:52.503629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288B8A99160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BC3E8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BC3E8C80>]}


============================== 18:38:52.503629 | 55275c08-10b2-49d6-820b-4edbf98ba891 ==============================
[0m18:38:52.503629 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:38:52.503629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build -m revenue_prod revenue_cust', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:38:53.274536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55275c08-10b2-49d6-820b-4edbf98ba891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288B9A97890>]}
[0m18:38:53.346692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55275c08-10b2-49d6-820b-4edbf98ba891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BD3DBE30>]}
[0m18:38:53.346692 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:38:53.837830 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:38:54.033670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:54.035673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:54.074971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55275c08-10b2-49d6-820b-4edbf98ba891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BE512C90>]}
[0m18:38:54.203900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:38:54.234945 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:38:54.403956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55275c08-10b2-49d6-820b-4edbf98ba891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BE6BFE30>]}
[0m18:38:54.404956 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:38:54.411955 [info ] [MainThread]: 
[0m18:38:54.417775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:54.418775 [info ] [MainThread]: 
[0m18:38:54.419777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:38:54.420287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:38:54.572232 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:38:54.573236 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:38:54.573236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:55.350235 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.777 seconds
[0m18:38:55.354721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage_mart'
[0m18:38:55.368942 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage_mart"
[0m18:38:55.369252 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage_mart"} */
show objects in HOTEL_MGMT.stage_mart limit 10000;
[0m18:38:55.369252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:55.667843 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.302 seconds
[0m18:38:55.667843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOTEL_MGMT_stage_mart, now list_HOTEL_MGMT_stage)
[0m18:38:55.692414 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:38:55.692414 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:38:55.774961 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.081 seconds
[0m18:38:55.779957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55275c08-10b2-49d6-820b-4edbf98ba891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BE45E870>]}
[0m18:38:55.785833 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_cust
[0m18:38:55.786869 [info ] [Thread-1 (]: 1 of 2 START sql table model stage_mart.revenue_cust ........................... [RUN]
[0m18:38:55.787835 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.revenue_cust'
[0m18:38:55.787835 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_cust
[0m18:38:55.800063 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_cust"
[0m18:38:55.801351 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_cust
[0m18:38:55.843289 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_cust"
[0m18:38:55.845292 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_cust"
[0m18:38:55.846289 [debug] [Thread-1 (]: On model.hotel_booking.revenue_cust: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_cust"} */
create or replace transient table HOTEL_MGMT.stage_mart.revenue_cust
         as
        (
WITH customer_revenue AS (
    SELECT
        customer_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY customer_id
),
ranked_customers AS (
    SELECT
        customer_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT 
    rc.customer_id,
    c.customername,
    rc.total_revenue,
    rc.revenue_rank
FROM ranked_customers rc
JOIN HOTEL_MGMT.stage.stg_customers c ON rc.customer_id = c.customer_id
ORDER BY rc.revenue_rank
        );
[0m18:38:55.846289 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:56.519949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m18:38:56.546950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55275c08-10b2-49d6-820b-4edbf98ba891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288B9A967E0>]}
[0m18:38:56.547949 [info ] [Thread-1 (]: 1 of 2 OK created sql table model stage_mart.revenue_cust ...................... [[32mSUCCESS 1[0m in 0.76s]
[0m18:38:56.548949 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_cust
[0m18:38:56.549950 [debug] [Thread-1 (]: Began running node model.hotel_booking.revenue_prod
[0m18:38:56.550949 [info ] [Thread-1 (]: 2 of 2 START sql table model stage_mart.revenue_prod ........................... [RUN]
[0m18:38:56.551948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.hotel_booking.revenue_cust, now model.hotel_booking.revenue_prod)
[0m18:38:56.551948 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.revenue_prod
[0m18:38:56.555947 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.revenue_prod"
[0m18:38:56.557947 [debug] [Thread-1 (]: Began executing node model.hotel_booking.revenue_prod
[0m18:38:56.560947 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.revenue_prod"
[0m18:38:56.564952 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.revenue_prod"
[0m18:38:56.564952 [debug] [Thread-1 (]: On model.hotel_booking.revenue_prod: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.revenue_prod"} */
create or replace transient table HOTEL_MGMT.stage_mart.revenue_prod
         as
        (
WITH product_revenue AS (
    SELECT
        product_id,
        SUM(revenue) AS total_revenue
    FROM HOTEL_MGMT.stage.stg_transactions
    GROUP BY product_id
),
ranked_products AS (
    SELECT
        product_id,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rp.product_id,
    p.product_family,
    rp.total_revenue,
    rp.revenue_rank
FROM ranked_products rp
JOIN HOTEL_MGMT.stage.stg_products p ON rp.product_id = p.product_id
ORDER BY rp.revenue_rank
        );
[0m18:38:57.159680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m18:38:57.161829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55275c08-10b2-49d6-820b-4edbf98ba891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BF113F80>]}
[0m18:38:57.162829 [info ] [Thread-1 (]: 2 of 2 OK created sql table model stage_mart.revenue_prod ...................... [[32mSUCCESS 1[0m in 0.61s]
[0m18:38:57.163830 [debug] [Thread-1 (]: Finished running node model.hotel_booking.revenue_prod
[0m18:38:57.165797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:57.165797 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:38:57.167292 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:38:57.265909 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:38:57.265909 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:38:57.342122 [debug] [MainThread]: Connection 'model.hotel_booking.revenue_prod' was left open.
[0m18:38:57.342122 [debug] [MainThread]: On model.hotel_booking.revenue_prod: Close
[0m18:38:57.411201 [info ] [MainThread]: 
[0m18:38:57.411201 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m18:38:57.413204 [debug] [MainThread]: Command end result
[0m18:38:57.495947 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:38:57.498943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:38:57.506464 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:38:57.506464 [info ] [MainThread]: 
[0m18:38:57.507466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:57.509514 [info ] [MainThread]: 
[0m18:38:57.510560 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:38:57.511523 [debug] [MainThread]: Command `dbt build` succeeded at 18:38:57.511523 after 5.24 seconds
[0m18:38:57.512556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BBD10C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BBCF23C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288BC1F4FB0>]}
[0m18:38:57.512556 [debug] [MainThread]: Flushing usage events
[0m18:38:58.441833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:20.647953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EB7B9A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EE93C980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EE357B60>]}


============================== 18:41:20.658024 | 8ab65740-15bc-49be-a6a9-b83ea689b7c4 ==============================
[0m18:41:20.658024 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:41:20.658024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m newchurn_cust', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:21.142535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ab65740-15bc-49be-a6a9-b83ea689b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EC2478C0>]}
[0m18:41:21.200044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ab65740-15bc-49be-a6a9-b83ea689b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EC1E1310>]}
[0m18:41:21.200044 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:41:21.643581 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:41:21.824915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:21.824915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:21.856832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ab65740-15bc-49be-a6a9-b83ea689b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EEA39820>]}
[0m18:41:21.936775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:41:21.936775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:41:21.995497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ab65740-15bc-49be-a6a9-b83ea689b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EEEBA060>]}
[0m18:41:21.996496 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:41:21.997497 [warn ] [MainThread]: The selection criterion 'newchurn_cust' does not match any enabled nodes
[0m18:41:21.998498 [warn ] [MainThread]: The selection criterion 'newchurn_cust' does not match any enabled nodes
[0m18:41:21.999499 [warn ] [MainThread]: The selection criterion 'newchurn_cust' does not match any enabled nodes
[0m18:41:22.000497 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:41:22.003735 [debug] [MainThread]: Command end result
[0m18:41:22.045498 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:41:22.047251 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:41:22.047251 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:41:22.047251 [debug] [MainThread]: Command `dbt build` succeeded at 18:41:22.047251 after 1.63 seconds
[0m18:41:22.047251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EEA00050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EE7C4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EE7C4EC0>]}
[0m18:41:22.047251 [debug] [MainThread]: Flushing usage events
[0m18:41:23.110458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:38.638970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296768CBC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029675B25340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029676318380>]}


============================== 18:41:38.646043 | 415786a8-a4c9-46a3-afbb-f619ee8512d5 ==============================
[0m18:41:38.646043 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:41:38.646043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m newchurn_cust', 'send_anonymous_usage_stats': 'True'}
[0m18:41:39.114761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '415786a8-a4c9-46a3-afbb-f619ee8512d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029677814E90>]}
[0m18:41:39.178305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '415786a8-a4c9-46a3-afbb-f619ee8512d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029675E71880>]}
[0m18:41:39.178305 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:41:39.601139 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:41:39.791631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:39.791631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:39.823223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '415786a8-a4c9-46a3-afbb-f619ee8512d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029678A80D10>]}
[0m18:41:39.903292 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:41:39.919944 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:41:39.961359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '415786a8-a4c9-46a3-afbb-f619ee8512d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029678C7F050>]}
[0m18:41:39.961359 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:41:39.961359 [warn ] [MainThread]: The selection criterion 'newchurn_cust' does not match any enabled nodes
[0m18:41:39.961359 [warn ] [MainThread]: The selection criterion 'newchurn_cust' does not match any enabled nodes
[0m18:41:39.961359 [warn ] [MainThread]: The selection criterion 'newchurn_cust' does not match any enabled nodes
[0m18:41:39.961359 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:41:39.975041 [debug] [MainThread]: Command end result
[0m18:41:40.014838 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:41:40.017836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:41:40.021802 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:41:40.021802 [debug] [MainThread]: Command `dbt build` succeeded at 18:41:40.021802 after 1.57 seconds
[0m18:41:40.021802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029676961460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029675F0A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029675F0A300>]}
[0m18:41:40.028591 [debug] [MainThread]: Flushing usage events
[0m18:41:41.029340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:57.013814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4DDD7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4DDD7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4DDD6150>]}


============================== 18:43:57.013814 | 230cdb35-1d15-46c0-a8de-4b912a57d8a6 ==============================
[0m18:43:57.013814 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:43:57.013814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -m newchurn_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:43:57.498860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '230cdb35-1d15-46c0-a8de-4b912a57d8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF50DB4110>]}
[0m18:43:57.562374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '230cdb35-1d15-46c0-a8de-4b912a57d8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF502F7170>]}
[0m18:43:57.562374 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:43:58.033757 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:43:58.208124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:58.208124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:58.250005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '230cdb35-1d15-46c0-a8de-4b912a57d8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF51EA86E0>]}
[0m18:43:58.345222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:43:58.345222 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:43:58.392794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '230cdb35-1d15-46c0-a8de-4b912a57d8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF52215A00>]}
[0m18:43:58.392794 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:43:58.392794 [warn ] [MainThread]: The selection criterion 'newchurn_cust' does not match any enabled nodes
[0m18:43:58.392794 [warn ] [MainThread]: The selection criterion 'newchurn_cust' does not match any enabled nodes
[0m18:43:58.392794 [warn ] [MainThread]: The selection criterion 'newchurn_cust' does not match any enabled nodes
[0m18:43:58.399785 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:43:58.403617 [debug] [MainThread]: Command end result
[0m18:43:58.440874 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:43:58.440874 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:43:58.452181 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:43:58.452181 [debug] [MainThread]: Command `dbt build` succeeded at 18:43:58.452181 after 1.71 seconds
[0m18:43:58.452181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4F520CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4FC615E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF50A64830>]}
[0m18:43:58.452181 [debug] [MainThread]: Flushing usage events
[0m18:43:59.427070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:59.880122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3CB5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3469BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3763B90>]}


============================== 18:44:59.880122 | d9fee8f5-811f-475a-9e45-09d897fd4f10 ==============================
[0m18:44:59.880122 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:44:59.880122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking\\logs', 'profiles_dir': 'C:\\Users\\PaluriManasa\\Desktop\\DE_MINI_PROJECT_DBT\\hotel_booking', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -m newcust_churn', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:45:00.412938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9fee8f5-811f-475a-9e45-09d897fd4f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3D5F770>]}
[0m18:45:00.492153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9fee8f5-811f-475a-9e45-09d897fd4f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA1A574A0>]}
[0m18:45:00.492153 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:45:00.977105 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:45:01.169589 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m18:45:01.169589 [debug] [MainThread]: Partial parsing: added file: hotel_booking://models\mart\newcust_churn.sql
[0m18:45:01.169589 [debug] [MainThread]: Partial parsing: deleted file: hotel_booking://models\mart\newchurn__cust.sql
[0m18:45:01.465817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9fee8f5-811f-475a-9e45-09d897fd4f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA5FC4C20>]}
[0m18:45:01.544830 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:45:01.551136 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:45:01.592556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9fee8f5-811f-475a-9e45-09d897fd4f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA5F6CC80>]}
[0m18:45:01.592556 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:45:01.605288 [info ] [MainThread]: 
[0m18:45:01.605288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:01.605288 [info ] [MainThread]: 
[0m18:45:01.605288 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:01.609596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT'
[0m18:45:01.739867 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT"
[0m18:45:01.739867 [debug] [ThreadPool]: On list_HOTEL_MGMT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT"} */
show terse schemas in database HOTEL_MGMT
    limit 10000
[0m18:45:01.740867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:02.536218 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.807 seconds
[0m18:45:02.552220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HOTEL_MGMT_stage_mart'
[0m18:45:02.552220 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage_mart"
[0m18:45:02.552220 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage_mart"} */
show objects in HOTEL_MGMT.stage_mart limit 10000;
[0m18:45:02.552220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:02.860835 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.308 seconds
[0m18:45:02.876504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HOTEL_MGMT_stage_mart, now list_HOTEL_MGMT_stage)
[0m18:45:02.876504 [debug] [ThreadPool]: Using snowflake connection "list_HOTEL_MGMT_stage"
[0m18:45:02.876504 [debug] [ThreadPool]: On list_HOTEL_MGMT_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "connection_name": "list_HOTEL_MGMT_stage"} */
show objects in HOTEL_MGMT.stage limit 10000;
[0m18:45:02.972923 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.105 seconds
[0m18:45:02.988736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9fee8f5-811f-475a-9e45-09d897fd4f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA5FAFF80>]}
[0m18:45:02.988736 [debug] [Thread-1 (]: Began running node model.hotel_booking.newcust_churn
[0m18:45:02.988736 [info ] [Thread-1 (]: 1 of 1 START sql table model stage_mart.newcust_churn .......................... [RUN]
[0m18:45:02.988736 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.hotel_booking.newcust_churn'
[0m18:45:02.988736 [debug] [Thread-1 (]: Began compiling node model.hotel_booking.newcust_churn
[0m18:45:03.014170 [debug] [Thread-1 (]: Writing injected SQL for node "model.hotel_booking.newcust_churn"
[0m18:45:03.017266 [debug] [Thread-1 (]: Began executing node model.hotel_booking.newcust_churn
[0m18:45:03.051055 [debug] [Thread-1 (]: Writing runtime sql for node "model.hotel_booking.newcust_churn"
[0m18:45:03.055055 [debug] [Thread-1 (]: Using snowflake connection "model.hotel_booking.newcust_churn"
[0m18:45:03.055055 [debug] [Thread-1 (]: On model.hotel_booking.newcust_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "hotel_booking", "target_name": "dev", "node_id": "model.hotel_booking.newcust_churn"} */
create or replace transient table HOTEL_MGMT.stage_mart.newcust_churn
         as
        (
WITH churn_new_customers AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM HOTEL_MGMT.stage.stg_transactions  
    WHERE revenue_type=1
),
aggregated_data AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_month THEN customer_id END) AS churned_customers
    FROM churn_new_customers
    GROUP BY payment_month
    ORDER BY payment_month
),
time_periods AS (
    SELECT
        payment_month,
        SUM(new_customers) OVER (ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS new_customers_lm,
        SUM(churned_customers) OVER (ORDER BY payment_month ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS churned_customers_lm,
        SUM(new_customers) OVER (ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS new_customers_l3m,
        SUM(churned_customers) OVER (ORDER BY payment_month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS churned_customers_l3m,
        SUM(new_customers) OVER (ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS new_customers_ltm,
        SUM(churned_customers) OVER (ORDER BY payment_month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS churned_customers_ltm
    FROM aggregated_data
)
SELECT * FROM time_periods
        );
[0m18:45:03.056056 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:45:03.899309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m18:45:03.932484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9fee8f5-811f-475a-9e45-09d897fd4f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA31744D0>]}
[0m18:45:03.932484 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage_mart.newcust_churn ..................... [[32mSUCCESS 1[0m in 0.94s]
[0m18:45:03.932484 [debug] [Thread-1 (]: Finished running node model.hotel_booking.newcust_churn
[0m18:45:03.932484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:03.932484 [debug] [MainThread]: Connection 'list_HOTEL_MGMT' was left open.
[0m18:45:03.932484 [debug] [MainThread]: On list_HOTEL_MGMT: Close
[0m18:45:04.411667 [debug] [MainThread]: Connection 'list_HOTEL_MGMT_stage' was left open.
[0m18:45:04.411667 [debug] [MainThread]: On list_HOTEL_MGMT_stage: Close
[0m18:45:04.505236 [debug] [MainThread]: Connection 'model.hotel_booking.newcust_churn' was left open.
[0m18:45:04.506372 [debug] [MainThread]: On model.hotel_booking.newcust_churn: Close
[0m18:45:04.576631 [info ] [MainThread]: 
[0m18:45:04.578092 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m18:45:04.580146 [debug] [MainThread]: Command end result
[0m18:45:04.612010 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\manifest.json
[0m18:45:04.614010 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\semantic_manifest.json
[0m18:45:04.622100 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriManasa\Desktop\DE_MINI_PROJECT_DBT\hotel_booking\target\run_results.json
[0m18:45:04.623068 [info ] [MainThread]: 
[0m18:45:04.624025 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:04.624025 [info ] [MainThread]: 
[0m18:45:04.624025 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:45:04.624025 [debug] [MainThread]: Command `dbt build` succeeded at 18:45:04.624025 after 4.96 seconds
[0m18:45:04.624025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3A438F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA30ED850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3858200>]}
[0m18:45:04.624025 [debug] [MainThread]: Flushing usage events
[0m18:45:05.601655 [debug] [MainThread]: An error was encountered while trying to flush usage events
